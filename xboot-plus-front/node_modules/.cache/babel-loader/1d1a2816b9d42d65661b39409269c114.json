{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\setting-manage\\oss.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\setting-manage\\oss.vue","mtime":1651629755230},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\babel.config.js","mtime":1651629754991},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1651770037115},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgc2VlU2VjcmV0U2V0LCBjaGVja09zc1NldCwgZ2V0T3NzU2V0LCBlZGl0T3NzU2V0IH0gZnJvbSAiQC9hcGkvaW5kZXgiOwppbXBvcnQgZGljdCBmcm9tICJAL3ZpZXdzL215LWNvbXBvbmVudHMveGJvb3QvZGljdCI7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAib3NzIiwKICBjb21wb25lbnRzOiB7CiAgICBkaWN0OiBkaWN0CiAgfSwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIC8vIOihqOWNleWKoOi9veeKtuaAgQogICAgICBjaGFuZ2VMb2FkaW5nOiBmYWxzZSwKICAgICAgc2F2ZUxvYWRpbmc6IGZhbHNlLAogICAgICBlcnJvck1zZzogIiIsCiAgICAgIGVycm9yTXNnMjogIiIsCiAgICAgIG9zczogewogICAgICAgIHNlcnZpY2VOYW1lOiAiIiwKICAgICAgICBhY2Nlc3NLZXk6ICIiLAogICAgICAgIHNlY3JldEtleTogIiIsCiAgICAgICAgZW5kcG9pbnQ6ICIiLAogICAgICAgIGJ1Y2tldDogIiIsCiAgICAgICAgYnVja2V0UmVnaW9uOiAiIiwKICAgICAgICB6b25lOiBudWxsCiAgICAgIH0sCiAgICAgIGNoYW5nZWRPc3NTSzogZmFsc2UsCiAgICAgIC8vIOaYr+WQpuS/ruaUuW9zc+eahHNlY3JlY3RLZXkKICAgICAgb3NzVmFsaWRhdGU6IHsKICAgICAgICAvLyDooajljZXpqozor4Hop4TliJkKICAgICAgICBzZXJ2aWNlTmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuivt+mAieaLqSIsCiAgICAgICAgICB0cmlnZ2VyOiAiY2hhbmdlIgogICAgICAgIH1dLAogICAgICAgIGFjY2Vzc0tleTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuS4jeiDveS4uuepuiIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XSwKICAgICAgICBzZWNyZXRLZXk6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICLkuI3og73kuLrnqboiLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0sCiAgICAgICAgZW5kcG9pbnQ6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIG1lc3NhZ2U6ICLkuI3og73kuLrnqboiLAogICAgICAgICAgdHJpZ2dlcjogImJsdXIiCiAgICAgICAgfV0sCiAgICAgICAgYnVja2V0OiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAi5LiN6IO95Li656m6IiwKICAgICAgICAgIHRyaWdnZXI6ICJibHVyIgogICAgICAgIH1dLAogICAgICAgIHpvbmU6IFt7CiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgIHR5cGU6ICJudW1iZXIiLAogICAgICAgICAgbWVzc2FnZTogIuS4jeiDveS4uuepuiIsCiAgICAgICAgICB0cmlnZ2VyOiAiY2hhbmdlIgogICAgICAgIH1dLAogICAgICAgIGJ1Y2tldFJlZ2lvbjogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuS4jeiDveS4uuepuiIsCiAgICAgICAgICB0cmlnZ2VyOiAiY2hhbmdlIgogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIGVuZHBvaW50UEg6ICLor7fovpPlhaXnqbrpl7Torr/pl67ln5/lkI0iCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgaW5pdDogZnVuY3Rpb24gaW5pdCgpIHsKICAgICAgdGhpcy5pbml0T3NzU2V0KCk7CiAgICB9LAogICAgaW5pdE9zc1NldDogZnVuY3Rpb24gaW5pdE9zc1NldCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIGNoZWNrT3NzU2V0KCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzICYmIHJlcy5yZXN1bHQpIHsKICAgICAgICAgIHZhciBvc3MgPSByZXMucmVzdWx0OwogICAgICAgICAgZ2V0T3NzU2V0KG9zcykudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgIGlmIChyZXMucmVzdWx0KSB7CiAgICAgICAgICAgICAgLy8g6L2s5o2ibnVsbOS4uiIiCiAgICAgICAgICAgICAgZm9yICh2YXIgYXR0ciBpbiByZXMucmVzdWx0KSB7CiAgICAgICAgICAgICAgICBpZiAocmVzLnJlc3VsdFthdHRyXSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIHJlcy5yZXN1bHRbYXR0cl0gPSAiIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIF90aGlzLm9zcyA9IHJlcy5yZXN1bHQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3RoaXMuY2hhbmdlZE9zc1NLID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgIF90aGlzLmNoYW5nZWRPc3NTSyA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjaGFuZ2VPc3M6IGZ1bmN0aW9uIGNoYW5nZU9zcyh2KSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy4kcmVmcy5vc3NGb3JtLnJlc2V0RmllbGRzKCk7CgogICAgICBpZiAodiA9PSAiQUxJX09TUyIpIHsKICAgICAgICB0aGlzLmVuZHBvaW50UEggPSAi6K+36L6T5YWlRW5kUG9pbnQo5Zyw5Z+f6IqC54K5KSDpnZ5CdWNrZXTln5/lkI0iOwogICAgICB9IGVsc2UgaWYgKHYgPT0gIlRFTkNFTlRfT1NTIikgewogICAgICAgIHRoaXMuZW5kcG9pbnRQSCA9ICLor7fovpPlhaXlrozmlbTor7fmsYLln5/lkI0iOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuZW5kcG9pbnRQSCA9ICLor7fovpPlhaXnqbrpl7Torr/pl67ln5/lkI0iOwogICAgICB9CgogICAgICB0aGlzLmNoYW5nZUxvYWRpbmcgPSB0cnVlOwogICAgICBnZXRPc3NTZXQodikudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMyLmNoYW5nZUxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHJlcy5yZXN1bHQpIHsKICAgICAgICAgIC8vIOi9rOaNom51bGzkuLoiIgogICAgICAgICAgZm9yICh2YXIgYXR0ciBpbiByZXMucmVzdWx0KSB7CiAgICAgICAgICAgIGlmIChyZXMucmVzdWx0W2F0dHJdID09IG51bGwpIHsKICAgICAgICAgICAgICByZXMucmVzdWx0W2F0dHJdID0gIiI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczIub3NzID0gcmVzLnJlc3VsdDsKICAgICAgICAgIF90aGlzMi5jaGFuZ2VkT3NzU0sgPSBmYWxzZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgX3RoaXMyLm9zcyA9IHsKICAgICAgICAgICAgc2VydmljZU5hbWU6IHYKICAgICAgICAgIH07CgogICAgICAgICAgaWYgKF90aGlzMi5vc3Muc2VydmljZU5hbWUgPT0gIkxPQ0FMX09TUyIpIHsKICAgICAgICAgICAgX3RoaXMyLm9zcy5odHRwID0gImh0dHA6Ly8iOwogICAgICAgICAgICBfdGhpczIub3NzLmVuZHBvaW50ID0gIjEyNy4wLjAuMTo5OTk5L3hib290L2ZpbGUvdmlldyI7CiAgICAgICAgICB9CgogICAgICAgICAgX3RoaXMyLmNoYW5nZWRPc3NTSyA9IHRydWU7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBzZWVTZWNyZXQ6IGZ1bmN0aW9uIHNlZVNlY3JldChuYW1lKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKCFuYW1lKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBzZWVTZWNyZXRTZXQobmFtZSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICBfdGhpczMub3NzLnNlY3JldEtleSA9IHJlcy5yZXN1bHQ7CiAgICAgICAgICBfdGhpczMuY2hhbmdlZE9zc1NLID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHNhdmVFZGl0T3NzOiBmdW5jdGlvbiBzYXZlRWRpdE9zcygpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICBpZiAodGhpcy5vc3Muc2VydmljZU5hbWUgPT0gIkxPQ0FMX09TUyIpIHsKICAgICAgICBpZiAoIXRoaXMub3NzLmh0dHApIHsKICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSAi6K+36YCJ5oupaHR0cOWNj+iuriI7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSAiIjsKICAgICAgICB9CgogICAgICAgIGlmICghdGhpcy5vc3MuZW5kcG9pbnQpIHsKICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSAi6K+36L6T5YWl5paH5Lu26aKE6KeI5o6l5Y+jIjsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lcnJvck1zZyA9ICIiOwogICAgICAgIH0KCiAgICAgICAgaWYgKCF0aGlzLm9zcy5maWxlUGF0aCkgewogICAgICAgICAgdGhpcy5lcnJvck1zZzIgPSAi6K+36L6T5YWl5a2Y5YKo56OB55uY6Lev5b6EIjsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5lcnJvck1zZzIgPSAiIjsKICAgICAgICB9CgogICAgICAgIGVkaXRPc3NTZXQodGhpcy5vc3MpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgX3RoaXM0LnNhdmVMb2FkaW5nID0gZmFsc2U7CgogICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgIF90aGlzNC4kTWVzc2FnZS5zdWNjZXNzKCLkv53lrZjmiJDlip8iKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRyZWZzLm9zc0Zvcm0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgICAgaWYgKCFfdGhpczQub3NzLmh0dHApIHsKICAgICAgICAgICAgICBfdGhpczQuZXJyb3JNc2cgPSAi6K+36YCJ5oupaHR0cOWNj+iuriI7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIF90aGlzNC5lcnJvck1zZyA9ICIiOwogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpczQuc2F2ZUxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICBfdGhpczQub3NzLmNoYW5nZWQgPSBfdGhpczQuY2hhbmdlZE9zc1NLOwogICAgICAgICAgICBlZGl0T3NzU2V0KF90aGlzNC5vc3MpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICAgIF90aGlzNC5zYXZlTG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIF90aGlzNC4kTWVzc2FnZS5zdWNjZXNzKCLkv53lrZjmiJDlip8iKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5pbml0KCk7CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8JA;AACA;AACA;EACAA,WADA;EAEAC;IACAC;EADA,CAFA;EAKAC,IALA,kBAKA;IACA;MACAC,cADA;MACA;MACAC,oBAFA;MAGAC,kBAHA;MAIAC,YAJA;MAKAC,aALA;MAMAC;QACAC,eADA;QAEAC,aAFA;QAGAC,aAHA;QAIAC,YAJA;QAKAC,UALA;QAMAC,gBANA;QAOAC;MAPA,CANA;MAeAC,mBAfA;MAeA;MACAC;QACA;QACAR;UAAAS;UAAAC;UAAAC;QAAA,EAFA;QAGAV;UAAAQ;UAAAC;UAAAC;QAAA,EAHA;QAIAT;UAAAO;UAAAC;UAAAC;QAAA,EAJA;QAKAR;UAAAM;UAAAC;UAAAC;QAAA,EALA;QAMAP;UAAAK;UAAAC;UAAAC;QAAA,EANA;QAOAL,OACA;UACAG,cADA;UAEAG,cAFA;UAGAF,eAHA;UAIAC;QAJA,CADA,CAPA;QAeAN,eACA;UAAAI;UAAAC;UAAAC;QAAA,CADA;MAfA,CAhBA;MAmCAE;IAnCA;EAqCA,CA3CA;EA4CAC;IACAC,IADA,kBACA;MACA;IACA,CAHA;IAIAC,UAJA,wBAIA;MAAA;;MACA;MACAC;QACA;UACA;UACAC;YACA;;YACA;cACA;cACA;gBACA;kBACAC;gBACA;cACA;;cACA;YACA,CARA,MAQA;cACA;YACA;UACA,CAbA;QAcA,CAhBA,MAgBA;UACA;UACA;QACA;MACA,CArBA;IAsBA,CA5BA;IA6BAC,SA7BA,qBA6BAC,CA7BA,EA6BA;MAAA;;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA,CAFA,MAEA;QACA;MACA;;MACA;MACAH;QACA;;QACA;UACA;UACA;YACA;cACAC;YACA;UACA;;UACA;UACA;QACA,CATA,MASA;UACA;YAAAnB;UAAA;;UACA;YACA;YACA;UACA;;UACA;QACA;MACA,CAnBA;IAoBA,CA3DA;IA4DAsB,SA5DA,qBA4DAhC,IA5DA,EA4DA;MAAA;;MACA;QACA;MACA;;MACAiC;QACA;UACA;UACA;QACA;MACA,CALA;IAMA,CAtEA;IAuEAC,WAvEA,yBAuEA;MAAA;;MACA;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;;QACA;UACA;UACA;QACA,CAHA,MAGA;UACA;QACA;;QACAC;UACA;;UACA;YACA;UACA;QACA,CALA;MAMA,CAzBA,MAyBA;QACA;UACA;YACA;cACA;cACA;YACA,CAHA,MAGA;cACA;YACA;;YACA;YACA;YACAA;cACA;;cACA;gBACA;cACA;YACA,CALA;UAMA;QACA,CAjBA;MAkBA;IACA;EArHA,CA5CA;EAmKAC,OAnKA,qBAmKA;IACA;EACA;AArKA","names":["name","components","dict","data","loading","changeLoading","saveLoading","errorMsg","errorMsg2","oss","serviceName","accessKey","secretKey","endpoint","bucket","bucketRegion","zone","changedOssSK","ossValidate","required","message","trigger","type","endpointPH","methods","init","initOssSet","checkOssSet","getOssSet","res","changeOss","v","seeSecret","seeSecretSet","saveEditOss","editOssSet","mounted"],"sourceRoot":"src/views/sys/setting-manage","sources":["oss.vue"],"sourcesContent":["<style lang=\"less\">\r\n</style>\r\n<template>\r\n  <div style=\"display: flex; position: relative\">\r\n    <Form\r\n      ref=\"ossForm\"\r\n      :model=\"oss\"\r\n      :label-width=\"110\"\r\n      label-position=\"left\"\r\n      :rules=\"ossValidate\"\r\n    >\r\n      <FormItem label=\"服务提供商\" prop=\"serviceName\">\r\n        <Select\r\n          v-model=\"oss.serviceName\"\r\n          @on-change=\"changeOss\"\r\n          placeholder=\"请选择\"\r\n          style=\"width: 230px\"\r\n        >\r\n          <Option value=\"LOCAL_OSS\">本地服务器</Option>\r\n          <Option value=\"MINIO_OSS\">MinIO</Option>\r\n          <Option value=\"QINIU_OSS\">七牛云</Option>\r\n          <Option value=\"ALI_OSS\">阿里云</Option>\r\n          <Option value=\"TENCENT_OSS\">腾讯云</Option>\r\n        </Select>\r\n      </FormItem>\r\n      <div v-if=\"oss.serviceName != 'LOCAL_OSS'\">\r\n        <FormItem label=\"accessKey\" prop=\"accessKey\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.accessKey\"\r\n            placeholder=\"请输入accessKey/secretId\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"secretKey\" prop=\"secretKey\">\r\n          <Tooltip placement=\"right\" content=\"无法编辑时请先点击查看图标\">\r\n            <Input\r\n              class=\"input-see\"\r\n              type=\"text\"\r\n              v-model=\"oss.secretKey\"\r\n              :disabled=\"changeLoading\"\r\n              :readonly=\"!changedOssSK\"\r\n              @on-click=\"seeSecret(oss.serviceName)\"\r\n              icon=\"ios-eye\"\r\n              placeholder=\"请输入secretKey\"\r\n              style=\"width: 380px\"\r\n            />\r\n          </Tooltip>\r\n        </FormItem>\r\n        <FormItem\r\n          v-if=\"oss.serviceName == 'QINIU_OSS'\"\r\n          label=\"zone存储区域\"\r\n          prop=\"zone\"\r\n        >\r\n          <Select\r\n            v-model=\"oss.zone\"\r\n            placeholder=\"请选择存储区域\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          >\r\n            <Option :value=\"-1\">自动判断</Option>\r\n            <Option :value=\"0\">华东</Option>\r\n            <Option :value=\"1\">华北</Option>\r\n            <Option :value=\"2\">华南</Option>\r\n            <Option :value=\"3\">北美</Option>\r\n            <Option :value=\"4\">东南亚</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"bucket空间\" prop=\"bucket\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.bucket\"\r\n            placeholder=\"请输入bucket空间名\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          v-if=\"oss.serviceName == 'TENCENT_OSS'\"\r\n          label=\"所属地域\"\r\n          prop=\"bucketRegion\"\r\n        >\r\n          <dict\r\n            dict=\"tencent_bucket_region\"\r\n            v-model=\"oss.bucketRegion\"\r\n            placeholder=\"请选择或输入搜索\"\r\n            filterable\r\n            :disabled=\"changeLoading\"\r\n            transfer\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"endpoint域名\" prop=\"endpoint\" :error=\"errorMsg\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.endpoint\"\r\n            :placeholder=\"endpointPH\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          >\r\n            <Select\r\n              v-model=\"oss.http\"\r\n              slot=\"prepend\"\r\n              style=\"width: 80px\"\r\n              prop=\"http\"\r\n            >\r\n              <Option value=\"http://\">http://</Option>\r\n              <Option value=\"https://\">https://</Option>\r\n            </Select>\r\n          </Input>\r\n        </FormItem>\r\n      </div>\r\n      <div v-else>\r\n        <FormItem label=\"存储磁盘路径\" prop=\"filePath\" :error=\"errorMsg2\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.filePath\"\r\n            placeholder=\"例如D:/upload\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"文件预览接口\" prop=\"endpoint\" :error=\"errorMsg\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.endpoint\"\r\n            placeholder=\"请输入文件预览接口\"\r\n            style=\"width: 380px\"\r\n          >\r\n            <Select\r\n              v-model=\"oss.http\"\r\n              slot=\"prepend\"\r\n              style=\"width: 80px\"\r\n              prop=\"http\"\r\n              :disabled=\"changeLoading\"\r\n            >\r\n              <Option value=\"http://\">http://</Option>\r\n              <Option value=\"https://\">https://</Option>\r\n            </Select>\r\n          </Input>\r\n        </FormItem>\r\n      </div>\r\n      <FormItem>\r\n        <Button\r\n          type=\"primary\"\r\n          style=\"width: 100px\"\r\n          :disabled=\"changeLoading\"\r\n          :loading=\"saveLoading\"\r\n          @click=\"saveEditOss\"\r\n          >保存并启用</Button\r\n        >\r\n      </FormItem>\r\n    </Form>\r\n    <Spin fix v-if=\"loading\"></Spin>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { seeSecretSet, checkOssSet, getOssSet, editOssSet } from \"@/api/index\";\r\nimport dict from \"@/views/my-components/xboot/dict\";\r\nexport default {\r\n  name: \"oss\",\r\n  components: {\r\n    dict,\r\n  },\r\n  data() {\r\n    return {\r\n      loading: false, // 表单加载状态\r\n      changeLoading: false,\r\n      saveLoading: false,\r\n      errorMsg: \"\",\r\n      errorMsg2: \"\",\r\n      oss: {\r\n        serviceName: \"\",\r\n        accessKey: \"\",\r\n        secretKey: \"\",\r\n        endpoint: \"\",\r\n        bucket: \"\",\r\n        bucketRegion: \"\",\r\n        zone: null,\r\n      },\r\n      changedOssSK: false, // 是否修改oss的secrectKey\r\n      ossValidate: {\r\n        // 表单验证规则\r\n        serviceName: [{ required: true, message: \"请选择\", trigger: \"change\" }],\r\n        accessKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        secretKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        endpoint: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        bucket: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        zone: [\r\n          {\r\n            required: true,\r\n            type: \"number\",\r\n            message: \"不能为空\",\r\n            trigger: \"change\",\r\n          },\r\n        ],\r\n        bucketRegion: [\r\n          { required: true, message: \"不能为空\", trigger: \"change\" },\r\n        ],\r\n      },\r\n      endpointPH: \"请输入空间访问域名\",\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.initOssSet();\r\n    },\r\n    initOssSet() {\r\n      this.loading = true;\r\n      checkOssSet().then((res) => {\r\n        if (res.success && res.result) {\r\n          let oss = res.result;\r\n          getOssSet(oss).then((res) => {\r\n            this.loading = false;\r\n            if (res.result) {\r\n              // 转换null为\"\"\r\n              for (let attr in res.result) {\r\n                if (res.result[attr] == null) {\r\n                  res.result[attr] = \"\";\r\n                }\r\n              }\r\n              this.oss = res.result;\r\n            } else {\r\n              this.changedOssSK = true;\r\n            }\r\n          });\r\n        } else {\r\n          this.loading = false;\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    changeOss(v) {\r\n      this.$refs.ossForm.resetFields();\r\n      if (v == \"ALI_OSS\") {\r\n        this.endpointPH = \"请输入EndPoint(地域节点) 非Bucket域名\";\r\n      } else if (v == \"TENCENT_OSS\") {\r\n        this.endpointPH = \"请输入完整请求域名\";\r\n      } else {\r\n        this.endpointPH = \"请输入空间访问域名\";\r\n      }\r\n      this.changeLoading = true;\r\n      getOssSet(v).then((res) => {\r\n        this.changeLoading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.oss = res.result;\r\n          this.changedOssSK = false;\r\n        } else {\r\n          this.oss = { serviceName: v };\r\n          if (this.oss.serviceName == \"LOCAL_OSS\") {\r\n            this.oss.http = \"http://\";\r\n            this.oss.endpoint = \"127.0.0.1:9999/xboot/file/view\";\r\n          }\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    seeSecret(name) {\r\n      if (!name) {\r\n        return;\r\n      }\r\n      seeSecretSet(name).then((res) => {\r\n        if (res.success) {\r\n          this.oss.secretKey = res.result;\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    saveEditOss() {\r\n      if (this.oss.serviceName == \"LOCAL_OSS\") {\r\n        if (!this.oss.http) {\r\n          this.errorMsg = \"请选择http协议\";\r\n          return;\r\n        } else {\r\n          this.errorMsg = \"\";\r\n        }\r\n        if (!this.oss.endpoint) {\r\n          this.errorMsg = \"请输入文件预览接口\";\r\n          return;\r\n        } else {\r\n          this.errorMsg = \"\";\r\n        }\r\n        if (!this.oss.filePath) {\r\n          this.errorMsg2 = \"请输入存储磁盘路径\";\r\n          return;\r\n        } else {\r\n          this.errorMsg2 = \"\";\r\n        }\r\n        editOssSet(this.oss).then((res) => {\r\n          this.saveLoading = false;\r\n          if (res.success) {\r\n            this.$Message.success(\"保存成功\");\r\n          }\r\n        });\r\n      } else {\r\n        this.$refs.ossForm.validate((valid) => {\r\n          if (valid) {\r\n            if (!this.oss.http) {\r\n              this.errorMsg = \"请选择http协议\";\r\n              return;\r\n            } else {\r\n              this.errorMsg = \"\";\r\n            }\r\n            this.saveLoading = true;\r\n            this.oss.changed = this.changedOssSK;\r\n            editOssSet(this.oss).then((res) => {\r\n              this.saveLoading = false;\r\n              if (res.success) {\r\n                this.$Message.success(\"保存成功\");\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n};\r\n</script>"]}]}