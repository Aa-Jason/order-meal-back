{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\own-space\\user.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\own-space\\user.vue","mtime":1651629755204},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\babel.config.js","mtime":1651629754991},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1651770037115},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:ZnVuY3Rpb24gX3R5cGVvZihvYmopIHsgIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mIjsgcmV0dXJuIF90eXBlb2YgPSAiZnVuY3Rpb24iID09IHR5cGVvZiBTeW1ib2wgJiYgInN5bWJvbCIgPT0gdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgImZ1bmN0aW9uIiA9PSB0eXBlb2YgU3ltYm9sICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/ICJzeW1ib2wiIDogdHlwZW9mIG9iajsgfSwgX3R5cGVvZihvYmopOyB9CgovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyB1c2VySW5mb0VkaXQgfSBmcm9tICJAL2FwaS9pbmRleCI7CmltcG9ydCB1cGxvYWRQaWNUaHVtYiBmcm9tICJAL3ZpZXdzL215LWNvbXBvbmVudHMveGJvb3QvdXBsb2FkLXBpYy10aHVtYiI7CmltcG9ydCBkaWN0IGZyb20gIkAvdmlld3MvbXktY29tcG9uZW50cy94Ym9vdC9kaWN0IjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIHVwbG9hZFBpY1RodW1iOiB1cGxvYWRQaWNUaHVtYiwKICAgIGRpY3Q6IGRpY3QKICB9LAogIG5hbWU6ICJ1c2VyIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbG9hZGluZzogZmFsc2UsCiAgICAgIGZvcm06IHsKICAgICAgICBhZGRyZXNzOiBbXQogICAgICB9LAogICAgICBlcnJvcjogIiIKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICB2YXIgdXNlckluZm8gPSB0aGlzLmdldFVzZXJJbmZvKCk7IC8vIOi9rOaNom51bGzkuLoiIgoKICAgICAgZm9yICh2YXIgYXR0ciBpbiB1c2VySW5mbykgewogICAgICAgIGlmICh1c2VySW5mb1thdHRyXSA9PSBudWxsKSB7CiAgICAgICAgICB1c2VySW5mb1thdHRyXSA9ICIiOwogICAgICAgIH0KICAgICAgfQoKICAgICAgdGhpcy5mb3JtID0gdXNlckluZm87CgogICAgICBpZiAodXNlckluZm8uYWRkcmVzcykgewogICAgICAgIGlmICh0eXBlb2YgdXNlckluZm8uYWRkcmVzcyA9PSAic3RyaW5nIikgewogICAgICAgICAgdGhpcy5mb3JtLmFkZHJlc3MgPSB1c2VySW5mby5hZGRyZXNzLnNwbGl0KCIsIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuZm9ybS5hZGRyZXNzID0gdXNlckluZm8uYWRkcmVzczsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5mb3JtLmFkZHJlc3MgPSBbXTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZm9ybS50eXBlID09IDApIHsKICAgICAgICB0aGlzLmZvcm0udHlwZVR4dCA9ICLmma7pgJrnlKjmiLciOwogICAgICB9IGVsc2UgaWYgKHRoaXMuZm9ybS50eXBlID09IDEpIHsKICAgICAgICB0aGlzLmZvcm0udHlwZVR4dCA9ICLnrqHnkIblkZgiOwogICAgICB9CiAgICB9LAogICAgY2hhbmdlQmlydGg6IGZ1bmN0aW9uIGNoYW5nZUJpcnRoKHYpIHsKICAgICAgdGhpcy5mb3JtLmJpcnRoID0gdjsKICAgIH0sCiAgICBzYXZlRWRpdDogZnVuY3Rpb24gc2F2ZUVkaXQoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBpZiAoIXRoaXMuZm9ybS5uaWNrbmFtZSkgewogICAgICAgIHRoaXMuZXJyb3IgPSAi6K+36L6T5YWl55So5oi35ZCNIjsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5lcnJvciA9ICIiOwogICAgICB9CgogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOwoKICAgICAgaWYgKF90eXBlb2YodGhpcy5mb3JtLmJpcnRoKSA9PSAib2JqZWN0IikgewogICAgICAgIHRoaXMuZm9ybS5iaXJ0aCA9IHRoaXMuZm9ybWF0KHRoaXMuZm9ybS5iaXJ0aCwgInl5eXktTU0tZGQiKTsKICAgICAgfQoKICAgICAgZGVsZXRlIHRoaXMuZm9ybS5yb2xlczsKICAgICAgdXNlckluZm9FZGl0KHRoaXMuZm9ybSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIF90aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoIuS/neWtmOaIkOWKnyIpOyAvLyDmm7TmlrDlpLTlg48KCgogICAgICAgICAgX3RoaXMuJHN0b3JlLmNvbW1pdCgic2V0Tmlja25hbWUiLCBfdGhpcy5mb3JtLm5pY2tuYW1lKTsKCiAgICAgICAgICBfdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRBdmF0YXIiLCBfdGhpcy5mb3JtLmF2YXRhcik7IC8vIOmcgOimgeabtOaWsOeUqOaIt+S/oeaBrwoKCiAgICAgICAgICBfdGhpcy4kZW1pdCgib24tc3VjY2VzcyIsIHRydWUpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5pbml0KCk7CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkEA;AACA;AACA;AACA;EACAA;IACAC,8BADA;IAEAC;EAFA,CADA;EAKAC,YALA;EAMAC,IANA,kBAMA;IACA;MACAC,cADA;MAEAC;QACAC;MADA,CAFA;MAKAC;IALA;EAOA,CAdA;EAeAC;IACAC,IADA,kBACA;MACA,kCADA,CAEA;;MACA;QACA;UACAC;QACA;MACA;;MACA;;MACA;QACA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA,CANA,MAMA;QACA;MACA;;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CAxBA;IAyBAC,WAzBA,uBAyBAC,CAzBA,EAyBA;MACA;IACA,CA3BA;IA4BAC,QA5BA,sBA4BA;MAAA;;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;MACA;;MACA;;MACA;QACA;MACA;;MACA;MACAC;QACA;;QACA;UACA,+BADA,CAEA;;;UACA;;UACA,oDAJA,CAKA;;;UACA;QACA;MACA,CAVA;IAWA;EAnDA,CAfA;EAoEAC,OApEA,qBAoEA;IACA;EACA;AAtEA","names":["components","uploadPicThumb","dict","name","data","loading","form","address","error","methods","init","userInfo","changeBirth","v","saveEdit","userInfoEdit","mounted"],"sourceRoot":"src/views/own-space","sources":["user.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <Form ref=\"form\" :model=\"form\" :label-width=\"90\" label-position=\"left\">\r\n      <FormItem label=\"登录账号：\" prop=\"username\">{{\r\n        form.username\r\n      }}</FormItem>\r\n      <FormItem label=\"用户头像：\">\r\n        <upload-pic-thumb\r\n          v-model=\"form.avatar\"\r\n          :multiple=\"false\"\r\n        ></upload-pic-thumb>\r\n      </FormItem>\r\n      <FormItem label=\"用户名：\" prop=\"nickname\" :error=\"error\">\r\n        <Input v-model=\"form.nickname\" style=\"width: 300px\" />\r\n      </FormItem>\r\n      <FormItem label=\"性别：\">\r\n        <dict dict=\"sex\" v-model=\"form.sex\" style=\"width: 300px\" />\r\n      </FormItem>\r\n      <FormItem label=\"生日：\">\r\n        <DatePicker\r\n          v-model=\"form.birth\"\r\n          @on-change=\"changeBirth\"\r\n          style=\"width: 300px\"\r\n          type=\"date\"\r\n        ></DatePicker>\r\n      </FormItem>\r\n      <FormItem label=\"所在省市：\">\r\n        <al-cascader\r\n          v-model=\"form.address\"\r\n          data-type=\"code\"\r\n          level=\"2\"\r\n          style=\"width: 300px\"\r\n        />\r\n      </FormItem>\r\n      <FormItem label=\"街道地址：\" prop=\"street\">\r\n        <Input v-model=\"form.street\" style=\"width: 300px\" />\r\n      </FormItem>\r\n      <FormItem label=\"个人简介：\" prop=\"description\">\r\n        <Input\r\n          v-model=\"form.description\"\r\n          type=\"textarea\"\r\n          style=\"width: 300px\"\r\n          :autosize=\"{ minRows: 3, maxRows: 5 }\"\r\n          placeholder=\"个人简介\"\r\n        ></Input>\r\n      </FormItem>\r\n      <FormItem label=\"所属部门：\">\r\n        <span>{{ form.departmentTitle }}</span>\r\n      </FormItem>\r\n      <FormItem label=\"用户类型：\">\r\n        <span>{{ form.typeTxt }}</span>\r\n      </FormItem>\r\n      <FormItem>\r\n        <Button\r\n          type=\"primary\"\r\n          style=\"width: 100px; margin-right: 5px\"\r\n          :loading=\"loading\"\r\n          @click=\"saveEdit\"\r\n          >保存</Button\r\n        >\r\n      </FormItem>\r\n    </Form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { userInfoEdit } from \"@/api/index\";\r\nimport uploadPicThumb from \"@/views/my-components/xboot/upload-pic-thumb\";\r\nimport dict from \"@/views/my-components/xboot/dict\";\r\nexport default {\r\n  components: {\r\n    uploadPicThumb,\r\n    dict,\r\n  },\r\n  name: \"user\",\r\n  data() {\r\n    return {\r\n      loading: false,\r\n      form: {\r\n        address: [],\r\n      },\r\n      error: \"\",\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      let userInfo = this.getUserInfo();\r\n      // 转换null为\"\"\r\n      for (let attr in userInfo) {\r\n        if (userInfo[attr] == null) {\r\n          userInfo[attr] = \"\";\r\n        }\r\n      }\r\n      this.form = userInfo;\r\n      if (userInfo.address) {\r\n        if (typeof userInfo.address == \"string\") {\r\n          this.form.address = userInfo.address.split(\",\");\r\n        } else {\r\n          this.form.address = userInfo.address;\r\n        }\r\n      } else {\r\n        this.form.address = [];\r\n      }\r\n      if (this.form.type == 0) {\r\n        this.form.typeTxt = \"普通用户\";\r\n      } else if (this.form.type == 1) {\r\n        this.form.typeTxt = \"管理员\";\r\n      }\r\n    },\r\n    changeBirth(v) {\r\n      this.form.birth = v;\r\n    },\r\n    saveEdit() {\r\n      if (!this.form.nickname) {\r\n        this.error = \"请输入用户名\";\r\n        return;\r\n      } else {\r\n        this.error = \"\";\r\n      }\r\n      this.loading = true;\r\n      if (typeof this.form.birth == \"object\") {\r\n        this.form.birth = this.format(this.form.birth, \"yyyy-MM-dd\");\r\n      }\r\n      delete this.form.roles;\r\n      userInfoEdit(this.form).then((res) => {\r\n        this.loading = false;\r\n        if (res.success) {\r\n          this.$Message.success(\"保存成功\");\r\n          // 更新头像\r\n          this.$store.commit(\"setNickname\", this.form.nickname);\r\n          this.$store.commit(\"setAvatar\", this.form.avatar);\r\n          // 需要更新用户信息\r\n          this.$emit(\"on-success\", true);\r\n        }\r\n      });\r\n    },\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n};\r\n</script>\r\n"]}]}