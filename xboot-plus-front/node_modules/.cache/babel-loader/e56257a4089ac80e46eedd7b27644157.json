{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\xboot-vue-template\\excel\\excel.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\xboot-vue-template\\excel\\excel.vue","mtime":1651629755324},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\babel.config.js","mtime":1651629754991},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1651770037115},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8g5qih54mI5a+85YWl5paH5Lu26KGo5pWw5o2uCmltcG9ydCB7IHVzZXJDb2x1bW5zLCB1c2VyRGF0YSB9IGZyb20gIkAvdmlld3Mvc3lzL3VzZXItbWFuYWdlL2ltcG9ydFRlbXBsYXRlIjsgLy8gZXhjZWzovazmjaLlt6XlhbfnsbsKCmltcG9ydCBleGNlbCBmcm9tICJAL2xpYnMvZXhjZWwiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogImV4Y2VsIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICByZXR1cm4gewogICAgICBvcGVuVGlwOiB0cnVlLAogICAgICAvLyDmmL7npLrmj5DnpLoKICAgICAgcmVhZGluZzogZmFsc2UsCiAgICAgIC8vIOivu+WPluS4rQogICAgICBoZWlnaHQ6IDUxMCwKICAgICAgLy8g6auY5bqmCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIC8vIOihqOWNleWKoOi9veeKtuaAgQogICAgICBpbXBvcnRMb2FkaW5nOiBmYWxzZSwKICAgICAgLy8g5a+85YWl5Yqg6L2954q25oCBCiAgICAgIGxvYWRpbmdFeHBvcnQ6IHRydWUsCiAgICAgIC8vIOWvvOWHuuWKoOi9veeKtuaAgQogICAgICBleHBvcnRNb2RhbFZpc2libGU6IGZhbHNlLAogICAgICAvLyDoh6rlrprkuYnlr7zlh7rmmL7npLoKICAgICAgaW1wb3J0TW9kYWxWaXNpYmxlOiBmYWxzZSwKICAgICAgLy8g5a+85YWl5pi+56S6CiAgICAgIHNlbGVjdExpc3Q6IFtdLAogICAgICAvLyDlpJrpgInmlbDmja4KICAgICAgc2VhcmNoRm9ybTogewogICAgICAgIHBhZ2VOdW1iZXI6IDEsCiAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgIHNvcnQ6ICJjcmVhdGVUaW1lIiwKICAgICAgICBvcmRlcjogImRlc2MiCiAgICAgIH0sCiAgICAgIGNvbHVtbnM6IFsvLyDooajlpLQKICAgICAgewogICAgICAgIHR5cGU6ICJzZWxlY3Rpb24iLAogICAgICAgIHdpZHRoOiA2MCwKICAgICAgICBhbGlnbjogImNlbnRlciIKICAgICAgfSwgewogICAgICAgIHR5cGU6ICJpbmRleCIsCiAgICAgICAgd2lkdGg6IDYwLAogICAgICAgIGFsaWduOiAiY2VudGVyIgogICAgICB9LCB7CiAgICAgICAgdGl0bGU6ICLlkI3np7AiLAogICAgICAgIGtleTogIm5hbWUiLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICB0aXRsZTogIuaJi+acuiIsCiAgICAgICAga2V5OiAibW9iaWxlIiwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgdGl0bGU6ICLliJvlu7rml7bpl7QiLAogICAgICAgIGtleTogImNyZWF0ZVRpbWUiLAogICAgICAgIHNvcnRhYmxlOiB0cnVlLAogICAgICAgIHNvcnRUeXBlOiAiZGVzYyIKICAgICAgfSwgewogICAgICAgIHRpdGxlOiAi5pu05paw5pe26Ze0IiwKICAgICAgICBrZXk6ICJ1cGRhdGVUaW1lIiwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgdGl0bGU6ICLmk43kvZwiLAogICAgICAgIGtleTogImFjdGlvbiIsCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIHdpZHRoOiAyMDAsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoaCwgcGFyYW1zKSB7CiAgICAgICAgICByZXR1cm4gaCgiZGl2IiwgW2goImEiLCB7CiAgICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uIGNsaWNrKCkgewogICAgICAgICAgICAgICAgX3RoaXMuJE1lc3NhZ2UuaW5mbygi54K55Ye75LqG57yW6L6RIik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCAi57yW6L6RIiksIGgoIkRpdmlkZXIiLCB7CiAgICAgICAgICAgIHByb3BzOiB7CiAgICAgICAgICAgICAgdHlwZTogInZlcnRpY2FsIgogICAgICAgICAgICB9CiAgICAgICAgICB9KSwgaCgiYSIsIHsKICAgICAgICAgICAgb246IHsKICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gY2xpY2soKSB7CiAgICAgICAgICAgICAgICBfdGhpcy4kTWVzc2FnZS5pbmZvKCLngrnlh7vkuobliKDpmaQiKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sICLliKDpmaQiKV0pOwogICAgICAgIH0KICAgICAgfV0sCiAgICAgIGV4cG9ydENvbHVtbnM6IFsvLyDlr7zlh7rliJcKICAgICAgewogICAgICAgIHRpdGxlOiAi5ZCN56ewIiwKICAgICAgICBrZXk6ICJuYW1lIiwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgdGl0bGU6ICLmiYvmnLoiLAogICAgICAgIGtleTogIm1vYmlsZSIsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfSwgewogICAgICAgIHRpdGxlOiAi5Yib5bu65pe26Ze0IiwKICAgICAgICBrZXk6ICJjcmVhdGVUaW1lIiwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICBzb3J0VHlwZTogImRlc2MiCiAgICAgIH0sIHsKICAgICAgICB0aXRsZTogIuabtOaWsOaXtumXtCIsCiAgICAgICAga2V5OiAidXBkYXRlVGltZSIsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfV0sCiAgICAgIGNob29zZUNvbHVtbnM6IFtdLAogICAgICBmaWxlbmFtZTogIuaVsOaNriIsCiAgICAgIGV4cG9ydFRpdGxlOiAi56Gu6K6k5a+85Ye6IiwKICAgICAgZXhwb3J0VHlwZTogIiIsCiAgICAgIGltcG9ydFRhYmxlRGF0YTogW10sCiAgICAgIGltcG9ydENvbHVtbnM6IFtdLAogICAgICB1cGxvYWRmaWxlOiB7CiAgICAgICAgbmFtZTogIiIKICAgICAgfSwKICAgICAgdGVtcENvbHVtbnM6IHVzZXJDb2x1bW5zLAogICAgICB0ZW1wRGF0YTogdXNlckRhdGEsCiAgICAgIGRhdGE6IFtdLAogICAgICBleHBvcnREYXRhOiBbXSwKICAgICAgdG90YWw6IDAKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsgLy8g5Yid5aeL5YyW5a+85Ye65YiX5pWw5o2uCgogICAgICB2YXIgYXJyYXkgPSBbXTsKICAgICAgdGhpcy5leHBvcnRDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAvLyDmjIflrprliJfpmZDliLbmnYPpmZAKICAgICAgICBpZiAoIV90aGlzMi5nZXRTdG9yZSgicm9sZXMiKS5pbmNsdWRlcygiUk9MRV9BRE1JTiIpICYmIGUua2V5ID09ICJtb2JpbGUiKSB7CiAgICAgICAgICBlLnRpdGxlID0gIlvml6DmnYPlr7zlh7pdICIgKyBlLnRpdGxlOwogICAgICAgICAgZS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGUuZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGFycmF5LnB1c2goZS50aXRsZSk7CiAgICAgIH0pOwogICAgICB0aGlzLmNob29zZUNvbHVtbnMgPSBhcnJheTsKICAgIH0sCiAgICBjaGFuZ2VQYWdlOiBmdW5jdGlvbiBjaGFuZ2VQYWdlKHYpIHsKICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VOdW1iZXIgPSB2OwogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICAgIHRoaXMuY2xlYXJTZWxlY3RBbGwoKTsKICAgIH0sCiAgICBjaGFuZ2VQYWdlU2l6ZTogZnVuY3Rpb24gY2hhbmdlUGFnZVNpemUodikgewogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZVNpemUgPSB2OwogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICB9LAogICAgc2VsZWN0RGF0ZVJhbmdlOiBmdW5jdGlvbiBzZWxlY3REYXRlUmFuZ2UodikgewogICAgICBpZiAodikgewogICAgICAgIHRoaXMuc2VhcmNoRm9ybS5zdGFydERhdGUgPSB2WzBdOwogICAgICAgIHRoaXMuc2VhcmNoRm9ybS5lbmREYXRlID0gdlsxXTsKICAgICAgfQogICAgfSwKICAgIGdldERhdGFMaXN0OiBmdW5jdGlvbiBnZXREYXRhTGlzdCgpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICBwYWdlTnVtYmVyOiB0aGlzLnBhZ2VOdW1iZXIsCiAgICAgICAgcGFnZVNpemU6IHRoaXMucGFnZVNpemUsCiAgICAgICAgc29ydDogdGhpcy5zb3J0Q29sdW1uLAogICAgICAgIG9yZGVyOiB0aGlzLnNvcnRUeXBlCiAgICAgIH07IC8vIOivt+axguWQjuerr+iOt+WPluihqOWNleaVsOaNriDor7foh6rooYzkv67mlLnmjqXlj6MKICAgICAgLy8gdGhpcy5nZXRSZXF1ZXN0KCLor7fmsYLot6/lvoQiLCBwYXJhbXMpLnRoZW4ocmVzID0+IHsKICAgICAgLy8gICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgLy8gICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgLy8gICAgIHRoaXMuZGF0YSA9IHJlcy5yZXN1bHQuY29udGVudDsKICAgICAgLy8gICAgIHRoaXMudG90YWwgPSByZXMucmVzdWx0LnRvdGFsRWxlbWVudHM7CiAgICAgIC8vICAgfQogICAgICAvLyB9KTsKICAgICAgLy8g5Lul5LiL5Li65qih5ouf5pWw5o2uCgogICAgICB0aGlzLmRhdGEgPSBbewogICAgICAgIGlkOiAiMSIsCiAgICAgICAgbmFtZTogIlhCb290IiwKICAgICAgICBtb2JpbGU6ICIxMjM0NTY3ODkwMSIsCiAgICAgICAgY3JlYXRlVGltZTogIjIwMTgtMDgtMDggMDA6MDg6MDAiLAogICAgICAgIHVwZGF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIgogICAgICB9LCB7CiAgICAgICAgaWQ6ICIyIiwKICAgICAgICBuYW1lOiAiRXhyaWNrIiwKICAgICAgICBtb2JpbGU6ICIxMjM0NTY3ODkwMSIsCiAgICAgICAgY3JlYXRlVGltZTogIjIwMTgtMDgtMDggMDA6MDg6MDAiLAogICAgICAgIHVwZGF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIgogICAgICB9XTsKICAgICAgdGhpcy50b3RhbCA9IHRoaXMuZGF0YS5sZW5ndGg7CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgfSwKICAgIGhhbmRsZVNlYXJjaDogZnVuY3Rpb24gaGFuZGxlU2VhcmNoKCkgewogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZU51bWJlciA9IDE7CiAgICAgIHRoaXMuc2VhcmNoRm9ybS5wYWdlU2l6ZSA9IDEwOwogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICB9LAogICAgaGFuZGxlUmVzZXQ6IGZ1bmN0aW9uIGhhbmRsZVJlc2V0KCkgewogICAgICB0aGlzLiRyZWZzLnNlYXJjaEZvcm0ucmVzZXRGaWVsZHMoKTsKICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VOdW1iZXIgPSAxOwogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZVNpemUgPSAxMDsgLy8g6YeN5paw5Yqg6L295pWw5o2uCgogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICB9LAogICAgY2hhbmdlU29ydDogZnVuY3Rpb24gY2hhbmdlU29ydChlKSB7CiAgICAgIHRoaXMuc2VhcmNoRm9ybS5zb3J0ID0gZS5rZXk7CiAgICAgIHRoaXMuc2VhcmNoRm9ybS5vcmRlciA9IGUub3JkZXI7CgogICAgICBpZiAoZS5vcmRlciA9PSAibm9ybWFsIikgewogICAgICAgIHRoaXMuc2VhcmNoRm9ybS5vcmRlciA9ICIiOwogICAgICB9CgogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICB9LAogICAgZXhwb3J0U2VsZWN0RGF0YTogZnVuY3Rpb24gZXhwb3J0U2VsZWN0RGF0YSgpIHsKICAgICAgaWYgKHRoaXMuc2VsZWN0TGlzdC5sZW5ndGggPD0gMCkgewogICAgICAgIHRoaXMuJE1lc3NhZ2Uud2FybmluZygi5oKo6L+Y5pyq6YCJ5oup6KaB5a+85Ye655qE5pWw5o2uIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmV4cG9ydFR5cGUgPSAicGFydCI7CiAgICAgIHRoaXMuZXhwb3J0TW9kYWxWaXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5leHBvcnRUaXRsZSA9ICLnoa7orqTlr7zlh7ogIiArIHRoaXMuc2VsZWN0TGlzdC5sZW5ndGggKyAiIOadoeaVsOaNriI7CiAgICB9LAogICAgZXhwb3J0QWxsOiBmdW5jdGlvbiBleHBvcnRBbGwoKSB7CiAgICAgIHRoaXMuZXhwb3J0VHlwZSA9ICJhbGwiOwogICAgICB0aGlzLmV4cG9ydE1vZGFsVmlzaWJsZSA9IHRydWU7CiAgICAgIHRoaXMuZXhwb3J0VGl0bGUgPSAi56Gu6K6k5a+85Ye65YWo6YOoICIgKyB0aGlzLnRvdGFsICsgIiDmnaHmlbDmja4iOyAvLyDor7fmsYLlkI7nq6/ojrflj5blhajpg6jmlbDmja4g6K+36Ieq6KGM5L+u5pS55o6l5Y+jCiAgICAgIC8vIHRoaXMuZ2V0UmVxdWVzdCgi6K+35rGC6Lev5b6EIiwgcGFyYW1zKS50aGVuKHJlcyA9PiB7CiAgICAgIC8vICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgIC8vICAgICB0aGlzLmV4cG9ydERhdGEgPSByZXMucmVzdWx0OwogICAgICAvLyAgIH0KICAgICAgLy8gfSk7CiAgICAgIC8vIOS7peS4i+S4uuaooeaLn+aVsOaNrgoKICAgICAgdGhpcy5leHBvcnREYXRhID0gW3sKICAgICAgICBpZDogIjEiLAogICAgICAgIG5hbWU6ICJYQm9vdCIsCiAgICAgICAgbW9iaWxlOiAiMTIzNDU2Nzg5MDEiLAogICAgICAgIGNyZWF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIiwKICAgICAgICB1cGRhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIKICAgICAgfSwgewogICAgICAgIGlkOiAiMiIsCiAgICAgICAgbmFtZTogIkV4cmljayIsCiAgICAgICAgbW9iaWxlOiAiMTIzNDU2Nzg5MDEiLAogICAgICAgIGNyZWF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIiwKICAgICAgICB1cGRhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIKICAgICAgfV07CiAgICB9LAogICAgZXhwb3J0Q3VzdG9tRGF0YTogZnVuY3Rpb24gZXhwb3J0Q3VzdG9tRGF0YSgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBpZiAodGhpcy5maWxlbmFtZSA9PSAiIikgewogICAgICAgIHRoaXMuZmlsZW5hbWUgPSAi55So5oi35pWw5o2uIjsKICAgICAgfSAvLyDliKTmlq3li77pgInlr7zlh7rliJcKCgogICAgICB2YXIgZXhwb3J0Q29sdW1ucyA9IFtdOwogICAgICB0aGlzLmV4cG9ydENvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgIF90aGlzMy5jaG9vc2VDb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGMpIHsKICAgICAgICAgIGlmIChlLnRpdGxlID09IGMgJiYgIWUuZGlzYWJsZWQpIHsKICAgICAgICAgICAgZXhwb3J0Q29sdW1ucy5wdXNoKGUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9KTsKICAgICAgdGhpcy5leHBvcnRNb2RhbFZpc2libGUgPSBmYWxzZTsKICAgICAgdmFyIHRpdGxlID0gW107CiAgICAgIHZhciBrZXkgPSBbXTsKICAgICAgZXhwb3J0Q29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgdGl0bGUucHVzaChlLnRpdGxlKTsKICAgICAgICBrZXkucHVzaChlLmtleSk7CiAgICAgIH0pOwogICAgICB2YXIgcGFyYW1zID0gewogICAgICAgIHRpdGxlOiB0aXRsZSwKICAgICAgICBrZXk6IGtleSwKICAgICAgICBkYXRhOiB0aGlzLmV4cG9ydERhdGEsCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgIGZpbGVuYW1lOiB0aGlzLmZpbGVuYW1lCiAgICAgIH07CiAgICAgIGV4Y2VsLmV4cG9ydF9hcnJheV90b19leGNlbChwYXJhbXMpOwogICAgfSwKICAgIGJlZm9yZVVwbG9hZEltcG9ydDogZnVuY3Rpb24gYmVmb3JlVXBsb2FkSW1wb3J0KGZpbGUpIHsKICAgICAgdGhpcy51cGxvYWRmaWxlID0gZmlsZTsKICAgICAgdmFyIGZpbGVFeHQgPSBmaWxlLm5hbWUuc3BsaXQoIi4iKS5wb3AoKS50b0xvY2FsZUxvd2VyQ2FzZSgpOwoKICAgICAgaWYgKGZpbGVFeHQgPT0gInhsc3giIHx8IGZpbGVFeHQgPT0gInhscyIpIHsKICAgICAgICB0aGlzLnJlYWRGaWxlKGZpbGUpOwogICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kTm90aWNlLndhcm5pbmcoewogICAgICAgICAgdGl0bGU6ICLmlofku7bnsbvlnovplJnor68iLAogICAgICAgICAgZGVzYzogIuaJgOmAieaWh+S7tuKAmCAiICsgZmlsZS5uYW1lICsgIiDigJnkuI3mmK9FWENFTOaWh+S7tu+8jOivt+mAieaLqeWQjue8gOS4ui54bHN45oiW6ICFLnhsc+eahEVYQ0VM5paH5Lu244CCIgogICAgICAgIH0pOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgLy8g6K+75Y+W5paH5Lu2CiAgICByZWFkRmlsZTogZnVuY3Rpb24gcmVhZEZpbGUoZmlsZSkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMucmVhZGluZyA9IHRydWU7CiAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOwogICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7CgogICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgX3RoaXM0LnJlYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgX3RoaXM0LiRNZXNzYWdlLmVycm9yKCLmlofku7bor7vlj5blh7rplJkiKTsKICAgICAgfTsKCiAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkgewogICAgICAgIHZhciBkYXRhID0gZS50YXJnZXQucmVzdWx0OwoKICAgICAgICB2YXIgX2V4Y2VsJHJlYWQgPSBleGNlbC5yZWFkKGRhdGEsICJhcnJheSIpLAogICAgICAgICAgICBoZWFkZXIgPSBfZXhjZWwkcmVhZC5oZWFkZXIsCiAgICAgICAgICAgIHJlc3VsdHMgPSBfZXhjZWwkcmVhZC5yZXN1bHRzOwoKICAgICAgICB2YXIgdGFibGVUaXRsZSA9IGhlYWRlci5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIHRpdGxlOiBpdGVtLAogICAgICAgICAgICBrZXk6IGl0ZW0sCiAgICAgICAgICAgIG1pbldpZHRoOiAxMzAsCiAgICAgICAgICAgIGFsaWduOiAiY2VudGVyIgogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICBfdGhpczQuaW1wb3J0VGFibGVEYXRhID0gcmVzdWx0czsKICAgICAgICBfdGhpczQuaW1wb3J0Q29sdW1ucyA9IHRhYmxlVGl0bGU7CiAgICAgICAgX3RoaXM0LnJlYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgX3RoaXM0LiRNZXNzYWdlLnN1Y2Nlc3MoIuivu+WPluaVsOaNruaIkOWKnyIpOwogICAgICB9OwogICAgfSwKICAgIGRvd25sb2FkVGVtcGxlOiBmdW5jdGlvbiBkb3dubG9hZFRlbXBsZSgpIHsKICAgICAgdmFyIHRpdGxlID0gW107CiAgICAgIHZhciBrZXkgPSBbXTsKICAgICAgdXNlckNvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgIHRpdGxlLnB1c2goZS50aXRsZSk7CiAgICAgICAga2V5LnB1c2goZS5rZXkpOwogICAgICB9KTsKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICB0aXRsZTogdGl0bGUsCiAgICAgICAga2V5OiBrZXksCiAgICAgICAgZGF0YTogdXNlckRhdGEsCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgIGZpbGVuYW1lOiAi5a+85YWl5pWw5o2u5qih54mIIgogICAgICB9OwogICAgICBleGNlbC5leHBvcnRfYXJyYXlfdG9fZXhjZWwocGFyYW1zKTsKICAgIH0sCiAgICBpbXBvcnREYXRhOiBmdW5jdGlvbiBpbXBvcnREYXRhKCkgewogICAgICB0aGlzLmltcG9ydExvYWRpbmcgPSB0cnVlOyAvLyDkvKDlhaXlr7zlhaXmlbDmja4g5ZCO56uv5o6l5pS2Ym9keeaVsOe7hOWIl+ihqOaJuemHj+WvvOWFpQogICAgICAvLyB0aGlzLmltcG9ydFJlcXVlc3QoIuivt+axgui3r+W+hCIsIHRoaXMuaW1wb3J0VGFibGVEYXRhKS50aGVuKHJlcyA9PiB7CiAgICAgIC8vICAgdGhpcy5pbXBvcnRMb2FkaW5nID0gZmFsc2U7CiAgICAgIC8vICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgIC8vICAgICB0aGlzLmltcG9ydE1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgICAvLyAgICAgdGhpcy5nZXREYXRhTGlzdCgpOwogICAgICAvLyAgICAgdGhpcy4kTW9kYWwuaW5mbyh7CiAgICAgIC8vICAgICAgIHRpdGxlOiAi5a+85YWl57uT5p6cIiwKICAgICAgLy8gICAgICAgY29udGVudDogcmVzLm1lc3NhZ2UKICAgICAgLy8gICAgIH0pOwogICAgICAvLyAgIH0KICAgICAgLy8gfSk7CiAgICAgIC8vIOaooeaLn+ivt+axguaIkOWKnwoKICAgICAgdGhpcy5pbXBvcnRMb2FkaW5nID0gZmFsc2U7CiAgICAgIHRoaXMuaW1wb3J0TW9kYWxWaXNpYmxlID0gZmFsc2U7CiAgICAgIHRoaXMuJE1vZGFsLmluZm8oewogICAgICAgIHRpdGxlOiAi5a+85YWl57uT5p6cIiwKICAgICAgICBjb250ZW50OiAi5a+85YWl5oiQ5Yqf77yM6L+Z5piv5YGH6YCa55+lIgogICAgICB9KTsKICAgICAgdGhpcy5nZXREYXRhTGlzdCgpOwogICAgfSwKICAgIHNob3dTZWxlY3Q6IGZ1bmN0aW9uIHNob3dTZWxlY3QoZSkgewogICAgICB0aGlzLmV4cG9ydERhdGEgPSBlOwogICAgICB0aGlzLnNlbGVjdExpc3QgPSBlOwogICAgfSwKICAgIGNsZWFyU2VsZWN0QWxsOiBmdW5jdGlvbiBjbGVhclNlbGVjdEFsbCgpIHsKICAgICAgdGhpcy4kcmVmcy50YWJsZS5zZWxlY3RBbGwoZmFsc2UpOwogICAgfSwKICAgIGNsZWFySW1wb3J0RGF0YTogZnVuY3Rpb24gY2xlYXJJbXBvcnREYXRhKCkgewogICAgICB0aGlzLmltcG9ydFRhYmxlRGF0YSA9IFtdOwogICAgICB0aGlzLmltcG9ydENvbHVtbnMgPSBbXTsKICAgICAgdGhpcy51cGxvYWRmaWxlID0ge307CiAgICB9CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgLy8g6K6h566X6auY5bqmCiAgICB0aGlzLmhlaWdodCA9IE51bWJlcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gMjMwKTsKICAgIHRoaXMuaW5pdCgpOwogIH0KfTs="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA,+E,CACA;;AACA;AACA;EACAA,aADA;EAEAC,IAFA,kBAEA;IAAA;;IACA;MACAC,aADA;MACA;MACAC,cAFA;MAEA;MACAC,WAHA;MAGA;MACAC,aAJA;MAIA;MACAC,oBALA;MAKA;MACAC,mBANA;MAMA;MACAC,yBAPA;MAOA;MACAC,yBARA;MAQA;MACAC,cATA;MASA;MACAC;QACAC,aADA;QAEAC,YAFA;QAGAC,kBAHA;QAIAC;MAJA,CAVA;MAgBAC,UACA;MACA;QACAC,iBADA;QAEAC,SAFA;QAGAC;MAHA,CAFA,EAOA;QACAF,aADA;QAEAC,SAFA;QAGAC;MAHA,CAPA,EAYA;QACAC,WADA;QAEAC,WAFA;QAGAC;MAHA,CAZA,EAiBA;QACAF,WADA;QAEAC,aAFA;QAGAC;MAHA,CAjBA,EAsBA;QACAF,aADA;QAEAC,iBAFA;QAGAC,cAHA;QAIAC;MAJA,CAtBA,EA4BA;QACAH,aADA;QAEAC,iBAFA;QAGAC;MAHA,CA5BA,EAiCA;QACAF,WADA;QAEAC,aAFA;QAGAF,eAHA;QAIAD,UAJA;QAKAM;UACA,iBACAC,EACA,GADA,EAEA;YACAC;cACAC;gBACA;cACA;YAHA;UADA,CAFA,EASA,IATA,CADA,EAYAF;YACAG;cACAX;YADA;UADA,EAZA,EAiBAQ,EACA,GADA,EAEA;YACAC;cACAC;gBACA;cACA;YAHA;UADA,CAFA,EASA,IATA,CAjBA;QA6BA;MAnCA,CAjCA,CAhBA;MAuFAE,gBACA;MACA;QACAT,WADA;QAEAC,WAFA;QAGAC;MAHA,CAFA,EAOA;QACAF,WADA;QAEAC,aAFA;QAGAC;MAHA,CAPA,EAYA;QACAF,aADA;QAEAC,iBAFA;QAGAC,cAHA;QAIAC;MAJA,CAZA,EAkBA;QACAH,aADA;QAEAC,iBAFA;QAGAC;MAHA,CAlBA,CAvFA;MA+GAQ,iBA/GA;MAgHAC,cAhHA;MAiHAC,mBAjHA;MAkHAC,cAlHA;MAmHAC,mBAnHA;MAoHAC,iBApHA;MAqHAC;QACApC;MADA,CArHA;MAwHAqC,wBAxHA;MAyHAC,kBAzHA;MA0HArC,QA1HA;MA2HAsC,cA3HA;MA4HAC;IA5HA;EA8HA,CAjIA;EAkIAC;IACAC,IADA,kBACA;MAAA;;MACA,mBADA,CAEA;;MACA;MACA;QACA;QACA,IACA,oDACAC,iBAFA,EAGA;UACAA;UACAA;QACA,CANA,MAMA;UACAA;QACA;;QACAC;MACA,CAZA;MAaA;IACA,CAnBA;IAoBAC,UApBA,sBAoBAC,CApBA,EAoBA;MACA;MACA;MACA;IACA,CAxBA;IAyBAC,cAzBA,0BAyBAD,CAzBA,EAyBA;MACA;MACA;IACA,CA5BA;IA6BAE,eA7BA,2BA6BAF,CA7BA,EA6BA;MACA;QACA;QACA;MACA;IACA,CAlCA;IAmCAG,WAnCA,yBAmCA;MACA;MACA;QACArC,2BADA;QAEAC,uBAFA;QAGAC,qBAHA;QAIAC;MAJA,EAFA,CAQA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA,aACA;QACAmC,OADA;QAEAlD,aAFA;QAGAmD,qBAHA;QAIAC,iCAJA;QAKAC;MALA,CADA,EAQA;QACAH,OADA;QAEAlD,cAFA;QAGAmD,qBAHA;QAIAC,iCAJA;QAKAC;MALA,CARA;MAgBA;MACA;IACA,CAtEA;IAuEAC,YAvEA,0BAuEA;MACA;MACA;MACA;IACA,CA3EA;IA4EAC,WA5EA,yBA4EA;MACA;MACA;MACA,8BAHA,CAIA;;MACA;IACA,CAlFA;IAmFAC,UAnFA,sBAmFAb,CAnFA,EAmFA;MACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CA1FA;IA2FAc,gBA3FA,8BA2FA;MACA;QACA;QACA;MACA;;MACA;MACA;MACA;IACA,CAnGA;IAoGAC,SApGA,uBAoGA;MACA;MACA;MACA,mDAHA,CAIA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA,mBACA;QACAR,OADA;QAEAlD,aAFA;QAGAmD,qBAHA;QAIAC,iCAJA;QAKAC;MALA,CADA,EAQA;QACAH,OADA;QAEAlD,cAFA;QAGAmD,qBAHA;QAIAC,iCAJA;QAKAC;MALA,CARA;IAgBA,CA/HA;IAgIAM,gBAhIA,8BAgIA;MAAA;;MACA;QACA;MACA,CAHA,CAIA;;;MACA;MACA;QACA;UACA;YACA9B;UACA;QACA,CAJA;MAKA,CANA;MAOA;MACA;MACA;MACAA;QACAT;QACAC;MACA,CAHA;MAIA;QACAD,YADA;QAEAC,QAFA;QAGApB,qBAHA;QAIA2D,eAJA;QAKA7B;MALA;MAOA8B;IACA,CA5JA;IA6JAC,kBA7JA,8BA6JAC,IA7JA,EA6JA;MACA;MACA;;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;UACA3C,eADA;UAEA4C,MACA,WACAD,SADA,GAEA;QALA;MAOA;;MACA;IACA,CA7KA;IA8KA;IACAE,QA/KA,oBA+KAF,IA/KA,EA+KA;MAAA;;MACA;MACA;MACAG;;MACAA;QACA;;QACA;MACA,CAHA;;MAIAA;QACA;;QACA;QAAA;QAAA;;QACA;UACA;YAAA9C;YAAAC;YAAA8C;YAAAhD;UAAA;QACA,CAFA;QAGA;QACA;QACA;;QACA;MACA,CAVA;IAWA,CAlMA;IAmMAiD,cAnMA,4BAmMA;MACA;MACA;MACAC;QACAjD;QACAC;MACA,CAHA;MAIA;QACAD,YADA;QAEAC,QAFA;QAGApB,cAHA;QAIA2D,eAJA;QAKA7B;MALA;MAOA8B;IACA,CAlNA;IAmNAS,UAnNA,wBAmNA;MACA,0BADA,CAEA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;;MACA;MACA;MACA;QACAlD,aADA;QAEAmD;MAFA;MAIA;IACA,CAzOA;IA0OAC,UA1OA,sBA0OA7B,CA1OA,EA0OA;MACA;MACA;IACA,CA7OA;IA8OA8B,cA9OA,4BA8OA;MACA;IACA,CAhPA;IAiPAC,eAjPA,6BAiPA;MACA;MACA;MACA;IACA;EArPA,CAlIA;EAyXAC,OAzXA,qBAyXA;IACA;IACA;IACA;EACA;AA7XA","names":["name","data","openTip","reading","height","loading","importLoading","loadingExport","exportModalVisible","importModalVisible","selectList","searchForm","pageNumber","pageSize","sort","order","columns","type","width","align","title","key","sortable","sortType","render","h","on","click","props","exportColumns","chooseColumns","filename","exportTitle","exportType","importTableData","importColumns","uploadfile","tempColumns","tempData","exportData","total","methods","init","e","array","changePage","v","changePageSize","selectDateRange","getDataList","id","mobile","createTime","updateTime","handleSearch","handleReset","changeSort","exportSelectData","exportAll","exportCustomData","autoWidth","excel","beforeUploadImport","file","desc","readFile","reader","minWidth","downloadTemple","userColumns","importData","content","showSelect","clearSelectAll","clearImportData","mounted"],"sourceRoot":"src/views/xboot-vue-template/excel","sources":["excel.vue"],"sourcesContent":["<style lang=\"less\">\r\n@import \"@/styles/table-common.less\";\r\n</style>\r\n<template>\r\n  <div class=\"search\">\r\n    <Card>\r\n      <Row class=\"operation\">\r\n        <Button @click=\"exportSelectData\" icon=\"md-cloud-upload\"\r\n          >导出所选数据</Button\r\n        >\r\n        <Button @click=\"exportAll\" icon=\"ios-cloud-upload\">导出全部数据</Button>\r\n        <Button @click=\"importModalVisible = true\" icon=\"ios-download\"\r\n          >导入数据</Button\r\n        >\r\n        <Button type=\"dashed\" @click=\"openTip = !openTip\">{{\r\n          openTip ? \"关闭提示\" : \"开启提示\"\r\n        }}</Button>\r\n      </Row>\r\n      <Alert show-icon v-show=\"openTip\">\r\n        已选择\r\n        <span class=\"select-count\">{{ selectList.length }}</span> 项\r\n        <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\r\n      </Alert>\r\n      <Table\r\n        :loading=\"loading\"\r\n        border\r\n        :columns=\"columns\"\r\n        :data=\"data\"\r\n        sortable=\"custom\"\r\n        @on-sort-change=\"changeSort\"\r\n        @on-selection-change=\"showSelect\"\r\n        ref=\"table\"\r\n      ></Table>\r\n      <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n        <Page\r\n          :current=\"searchForm.pageNumber\"\r\n          :total=\"total\"\r\n          :page-size=\"searchForm.pageSize\"\r\n          @on-change=\"changePage\"\r\n          @on-page-size-change=\"changePageSize\"\r\n          :page-size-opts=\"[10, 20, 50]\"\r\n          size=\"small\"\r\n          show-total\r\n          show-elevator\r\n          show-sizer\r\n        ></Page>\r\n      </Row>\r\n    </Card>\r\n\r\n    <!-- 自定义导出数据 -->\r\n    <Modal\r\n      v-model=\"exportModalVisible\"\r\n      :title=\"exportTitle\"\r\n      :loading=\"loadingExport\"\r\n      @on-ok=\"exportCustomData\"\r\n    >\r\n      <Form ref=\"exportForm\" :label-width=\"100\">\r\n        <FormItem label=\"导出文件名\">\r\n          <Input v-model=\"filename\" />\r\n        </FormItem>\r\n        <FormItem label=\"自定义导出列\">\r\n          <CheckboxGroup v-model=\"chooseColumns\">\r\n            <Checkbox\r\n              v-for=\"(item, i) in exportColumns\"\r\n              :label=\"item.title\"\r\n              :key=\"i\"\r\n              :value=\"item.checked\"\r\n              :disabled=\"item.disabled\"\r\n            ></Checkbox>\r\n          </CheckboxGroup>\r\n        </FormItem>\r\n      </Form>\r\n    </Modal>\r\n    <Drawer\r\n      title=\"导入数据\"\r\n      closable\r\n      v-model=\"importModalVisible\"\r\n      width=\"800\"\r\n      draggable\r\n    >\r\n      <div\r\n        style=\"\r\n          display: flex;\r\n          justify-content: space-between;\r\n          align-items: center;\r\n        \"\r\n      >\r\n        <Upload action :before-upload=\"beforeUploadImport\" accept=\".xls, .xlsx\">\r\n          <Button\r\n            :loading=\"reading\"\r\n            icon=\"ios-cloud-upload-outline\"\r\n            style=\"margin-right: 10px\"\r\n            >上传Excel文件</Button\r\n          >\r\n          <span v-if=\"uploadfile.name\"\r\n            >当前选择文件：{{ uploadfile.name }}</span\r\n          >\r\n        </Upload>\r\n        <Button @click=\"clearImportData\" icon=\"md-trash\">清空数据</Button>\r\n      </div>\r\n      <Alert type=\"warning\" show-icon\r\n        >导入前请下载查看导入模版数据文件查看所需字段及说明，确保数据格式正确，不得修改列英文名称</Alert\r\n      >\r\n      <Table\r\n        :columns=\"importColumns\"\r\n        border\r\n        :height=\"height\"\r\n        :data=\"importTableData\"\r\n        ref=\"importTable\"\r\n      ></Table>\r\n      <div class=\"drawer-footer\">\r\n        <Button @click=\"downloadTemple\" type=\"info\">下载导入模板</Button>\r\n        <div style=\"position: absolute; right: 15px; display: inline-block\">\r\n          <Button @click=\"importModalVisible = false\">关闭</Button>\r\n          <Button\r\n            :loading=\"importLoading\"\r\n            :disabled=\"importTableData.length <= 0\"\r\n            @click=\"importData\"\r\n            style=\"margin-left: 5px\"\r\n            type=\"primary\"\r\n          >\r\n            确认导入\r\n            <span v-if=\"importTableData.length > 0\"\r\n              >{{ importTableData.length }} 条数据</span\r\n            >\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Drawer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 模版导入文件表数据\r\nimport { userColumns, userData } from \"@/views/sys/user-manage/importTemplate\";\r\n// excel转换工具类\r\nimport excel from \"@/libs/excel\";\r\nexport default {\r\n  name: \"excel\",\r\n  data() {\r\n    return {\r\n      openTip: true, // 显示提示\r\n      reading: false, // 读取中\r\n      height: 510, // 高度\r\n      loading: true, // 表单加载状态\r\n      importLoading: false, // 导入加载状态\r\n      loadingExport: true, // 导出加载状态\r\n      exportModalVisible: false, // 自定义导出显示\r\n      importModalVisible: false, // 导入显示\r\n      selectList: [], // 多选数据\r\n      searchForm: {\r\n        pageNumber: 1,\r\n        pageSize: 10,\r\n        sort: \"createTime\",\r\n        order: \"desc\",\r\n      },\r\n      columns: [\r\n        // 表头\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          type: \"index\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          title: \"名称\",\r\n          key: \"name\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"手机\",\r\n          key: \"mobile\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          sortable: true,\r\n          sortType: \"desc\",\r\n        },\r\n        {\r\n          title: \"更新时间\",\r\n          key: \"updateTime\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          key: \"action\",\r\n          align: \"center\",\r\n          width: 200,\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.$Message.info(\"点击了编辑\");\r\n                    },\r\n                  },\r\n                },\r\n                \"编辑\"\r\n              ),\r\n              h(\"Divider\", {\r\n                props: {\r\n                  type: \"vertical\",\r\n                },\r\n              }),\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.$Message.info(\"点击了删除\");\r\n                    },\r\n                  },\r\n                },\r\n                \"删除\"\r\n              ),\r\n            ]);\r\n          },\r\n        },\r\n      ],\r\n      exportColumns: [\r\n        // 导出列\r\n        {\r\n          title: \"名称\",\r\n          key: \"name\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"手机\",\r\n          key: \"mobile\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          sortable: true,\r\n          sortType: \"desc\",\r\n        },\r\n        {\r\n          title: \"更新时间\",\r\n          key: \"updateTime\",\r\n          sortable: true,\r\n        },\r\n      ],\r\n      chooseColumns: [],\r\n      filename: \"数据\",\r\n      exportTitle: \"确认导出\",\r\n      exportType: \"\",\r\n      importTableData: [],\r\n      importColumns: [],\r\n      uploadfile: {\r\n        name: \"\",\r\n      },\r\n      tempColumns: userColumns,\r\n      tempData: userData,\r\n      data: [],\r\n      exportData: [],\r\n      total: 0,\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getDataList();\r\n      // 初始化导出列数据\r\n      let array = [];\r\n      this.exportColumns.forEach((e) => {\r\n        // 指定列限制权限\r\n        if (\r\n          !this.getStore(\"roles\").includes(\"ROLE_ADMIN\") &&\r\n          e.key == \"mobile\"\r\n        ) {\r\n          e.title = \"[无权导出] \" + e.title;\r\n          e.disabled = true;\r\n        } else {\r\n          e.disabled = false;\r\n        }\r\n        array.push(e.title);\r\n      });\r\n      this.chooseColumns = array;\r\n    },\r\n    changePage(v) {\r\n      this.searchForm.pageNumber = v;\r\n      this.getDataList();\r\n      this.clearSelectAll();\r\n    },\r\n    changePageSize(v) {\r\n      this.searchForm.pageSize = v;\r\n      this.getDataList();\r\n    },\r\n    selectDateRange(v) {\r\n      if (v) {\r\n        this.searchForm.startDate = v[0];\r\n        this.searchForm.endDate = v[1];\r\n      }\r\n    },\r\n    getDataList() {\r\n      this.loading = true;\r\n      let params = {\r\n        pageNumber: this.pageNumber,\r\n        pageSize: this.pageSize,\r\n        sort: this.sortColumn,\r\n        order: this.sortType,\r\n      };\r\n      // 请求后端获取表单数据 请自行修改接口\r\n      // this.getRequest(\"请求路径\", params).then(res => {\r\n      //   this.loading = false;\r\n      //   if (res.success) {\r\n      //     this.data = res.result.content;\r\n      //     this.total = res.result.totalElements;\r\n      //   }\r\n      // });\r\n      // 以下为模拟数据\r\n      this.data = [\r\n        {\r\n          id: \"1\",\r\n          name: \"XBoot\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n        {\r\n          id: \"2\",\r\n          name: \"Exrick\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n      ];\r\n      this.total = this.data.length;\r\n      this.loading = false;\r\n    },\r\n    handleSearch() {\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      this.getDataList();\r\n    },\r\n    handleReset() {\r\n      this.$refs.searchForm.resetFields();\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      // 重新加载数据\r\n      this.getDataList();\r\n    },\r\n    changeSort(e) {\r\n      this.searchForm.sort = e.key;\r\n      this.searchForm.order = e.order;\r\n      if (e.order == \"normal\") {\r\n        this.searchForm.order = \"\";\r\n      }\r\n      this.getDataList();\r\n    },\r\n    exportSelectData() {\r\n      if (this.selectList.length <= 0) {\r\n        this.$Message.warning(\"您还未选择要导出的数据\");\r\n        return;\r\n      }\r\n      this.exportType = \"part\";\r\n      this.exportModalVisible = true;\r\n      this.exportTitle = \"确认导出 \" + this.selectList.length + \" 条数据\";\r\n    },\r\n    exportAll() {\r\n      this.exportType = \"all\";\r\n      this.exportModalVisible = true;\r\n      this.exportTitle = \"确认导出全部 \" + this.total + \" 条数据\";\r\n      // 请求后端获取全部数据 请自行修改接口\r\n      // this.getRequest(\"请求路径\", params).then(res => {\r\n      //   if (res.success) {\r\n      //     this.exportData = res.result;\r\n      //   }\r\n      // });\r\n      // 以下为模拟数据\r\n      this.exportData = [\r\n        {\r\n          id: \"1\",\r\n          name: \"XBoot\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n        {\r\n          id: \"2\",\r\n          name: \"Exrick\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n      ];\r\n    },\r\n    exportCustomData() {\r\n      if (this.filename == \"\") {\r\n        this.filename = \"用户数据\";\r\n      }\r\n      // 判断勾选导出列\r\n      let exportColumns = [];\r\n      this.exportColumns.forEach((e) => {\r\n        this.chooseColumns.forEach((c) => {\r\n          if (e.title == c && !e.disabled) {\r\n            exportColumns.push(e);\r\n          }\r\n        });\r\n      });\r\n      this.exportModalVisible = false;\r\n      let title = [];\r\n      let key = [];\r\n      exportColumns.forEach((e) => {\r\n        title.push(e.title);\r\n        key.push(e.key);\r\n      });\r\n      const params = {\r\n        title: title,\r\n        key: key,\r\n        data: this.exportData,\r\n        autoWidth: true,\r\n        filename: this.filename,\r\n      };\r\n      excel.export_array_to_excel(params);\r\n    },\r\n    beforeUploadImport(file) {\r\n      this.uploadfile = file;\r\n      const fileExt = file.name.split(\".\").pop().toLocaleLowerCase();\r\n      if (fileExt == \"xlsx\" || fileExt == \"xls\") {\r\n        this.readFile(file);\r\n        this.file = file;\r\n      } else {\r\n        this.$Notice.warning({\r\n          title: \"文件类型错误\",\r\n          desc:\r\n            \"所选文件‘ \" +\r\n            file.name +\r\n            \" ’不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。\",\r\n        });\r\n      }\r\n      return false;\r\n    },\r\n    // 读取文件\r\n    readFile(file) {\r\n      this.reading = true;\r\n      const reader = new FileReader();\r\n      reader.readAsArrayBuffer(file);\r\n      reader.onerror = (e) => {\r\n        this.reading = false;\r\n        this.$Message.error(\"文件读取出错\");\r\n      };\r\n      reader.onload = (e) => {\r\n        const data = e.target.result;\r\n        const { header, results } = excel.read(data, \"array\");\r\n        const tableTitle = header.map((item) => {\r\n          return { title: item, key: item, minWidth: 130, align: \"center\" };\r\n        });\r\n        this.importTableData = results;\r\n        this.importColumns = tableTitle;\r\n        this.reading = false;\r\n        this.$Message.success(\"读取数据成功\");\r\n      };\r\n    },\r\n    downloadTemple() {\r\n      let title = [];\r\n      let key = [];\r\n      userColumns.forEach((e) => {\r\n        title.push(e.title);\r\n        key.push(e.key);\r\n      });\r\n      const params = {\r\n        title: title,\r\n        key: key,\r\n        data: userData,\r\n        autoWidth: true,\r\n        filename: \"导入数据模版\",\r\n      };\r\n      excel.export_array_to_excel(params);\r\n    },\r\n    importData() {\r\n      this.importLoading = true;\r\n      // 传入导入数据 后端接收body数组列表批量导入\r\n      // this.importRequest(\"请求路径\", this.importTableData).then(res => {\r\n      //   this.importLoading = false;\r\n      //   if (res.success) {\r\n      //     this.importModalVisible = false;\r\n      //     this.getDataList();\r\n      //     this.$Modal.info({\r\n      //       title: \"导入结果\",\r\n      //       content: res.message\r\n      //     });\r\n      //   }\r\n      // });\r\n      // 模拟请求成功\r\n      this.importLoading = false;\r\n      this.importModalVisible = false;\r\n      this.$Modal.info({\r\n        title: \"导入结果\",\r\n        content: \"导入成功，这是假通知\",\r\n      });\r\n      this.getDataList();\r\n    },\r\n    showSelect(e) {\r\n      this.exportData = e;\r\n      this.selectList = e;\r\n    },\r\n    clearSelectAll() {\r\n      this.$refs.table.selectAll(false);\r\n    },\r\n    clearImportData() {\r\n      this.importTableData = [];\r\n      this.importColumns = [];\r\n      this.uploadfile = {};\r\n    },\r\n  },\r\n  mounted() {\r\n    // 计算高度\r\n    this.height = Number(document.documentElement.clientHeight - 230);\r\n    this.init();\r\n  },\r\n};\r\n</script>"]}]}