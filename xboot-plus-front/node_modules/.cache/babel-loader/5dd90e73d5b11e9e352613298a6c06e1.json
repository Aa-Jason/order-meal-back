{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\role-manage\\roleManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\role-manage\\roleManage.vue","mtime":1651629755229},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\babel.config.js","mtime":1651629754991},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1651770037115},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgZ2V0Um9sZUxpc3QsIGdldEFsbFBlcm1pc3Npb25MaXN0LCBhZGRSb2xlLCBlZGl0Um9sZSwgZGVsZXRlUm9sZSwgc2V0RGVmYXVsdFJvbGUsIGVkaXRSb2xlUGVybSwgaW5pdERlcGFydG1lbnQsIGxvYWREZXBhcnRtZW50LCBlZGl0Um9sZURlcCB9IGZyb20gIkAvYXBpL2luZGV4IjsKaW1wb3J0IHV0aWwgZnJvbSAiQC9saWJzL3V0aWwuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogInJvbGUtbWFuYWdlIiwKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgdmFyIF90aGlzID0gdGhpczsKCiAgICByZXR1cm4gewogICAgICB0YWJsZVNpemU6ICJkZWZhdWx0IiwKICAgICAgbWF4SGVpZ2h0OiA1MTAsCiAgICAgIG9wZW5UaXA6IHRydWUsCiAgICAgIG9wZW5MZXZlbDogIjAiLAogICAgICBsb2FkaW5nOiB0cnVlLAogICAgICB0cmVlTG9hZGluZzogdHJ1ZSwKICAgICAgZGVwVHJlZUxvYWRpbmc6IHRydWUsCiAgICAgIHN1Ym1pdFBlcm1Mb2FkaW5nOiBmYWxzZSwKICAgICAgc3VibWl0RGVwTG9hZGluZzogZmFsc2UsCiAgICAgIHNlYXJjaEtleTogIiIsCiAgICAgIHNvcnRDb2x1bW46ICJjcmVhdGVUaW1lIiwKICAgICAgc29ydFR5cGU6ICJkZXNjIiwKICAgICAgbW9kYWxUeXBlOiAwLAogICAgICByb2xlTW9kYWxWaXNpYmxlOiBmYWxzZSwKICAgICAgcGVybU1vZGFsVmlzaWJsZTogZmFsc2UsCiAgICAgIGRlcE1vZGFsVmlzaWJsZTogZmFsc2UsCiAgICAgIG1vZGFsVGl0bGU6ICIiLAogICAgICBzZWFyY2hGb3JtOiB7CiAgICAgICAgLy8g5pCc57Si5qGG5Yid5aeL5YyW5a+56LGhCiAgICAgICAgcGFnZU51bWJlcjogMSwKICAgICAgICAvLyDlvZPliY3pobXmlbAKICAgICAgICBwYWdlU2l6ZTogMTAsCiAgICAgICAgLy8g6aG16Z2i5aSn5bCPCiAgICAgICAgc29ydDogImNyZWF0ZVRpbWUiLAogICAgICAgIC8vIOm7mOiupOaOkuW6j+Wtl+autQogICAgICAgIG9yZGVyOiAiZGVzYyIsCiAgICAgICAgLy8g6buY6K6k5o6S5bqP5pa55byPCiAgICAgICAga2V5OiAiIgogICAgICB9LAogICAgICByb2xlRm9ybTogewogICAgICAgIG5hbWU6ICIiLAogICAgICAgIGRlc2NyaXB0aW9uOiAiIgogICAgICB9LAogICAgICByb2xlRm9ybVZhbGlkYXRlOiB7CiAgICAgICAgbmFtZTogW3sKICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLAogICAgICAgICAgbWVzc2FnZTogIuinkuiJsuWQjeensOS4jeiDveS4uuepuiIsCiAgICAgICAgICB0cmlnZ2VyOiAiYmx1ciIKICAgICAgICB9XQogICAgICB9LAogICAgICBzdWJtaXRMb2FkaW5nOiBmYWxzZSwKICAgICAgc2VsZWN0TGlzdDogW10sCiAgICAgIGNvbHVtbnM6IFt7CiAgICAgICAgdHlwZTogInNlbGVjdGlvbiIsCiAgICAgICAgd2lkdGg6IDYwLAogICAgICAgIGFsaWduOiAiY2VudGVyIgogICAgICB9LCB7CiAgICAgICAgdHlwZTogImluZGV4IiwKICAgICAgICB3aWR0aDogNjAsCiAgICAgICAgYWxpZ246ICJjZW50ZXIiCiAgICAgIH0sIHsKICAgICAgICB0aXRsZTogIuinkuiJsuWQjeensCIsCiAgICAgICAga2V5OiAibmFtZSIsCiAgICAgICAgbWluV2lkdGg6IDE1MCwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgdGl0bGU6ICLlpIfms6giLAogICAgICAgIGtleTogImRlc2NyaXB0aW9uIiwKICAgICAgICBtaW5XaWR0aDogMTUwLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH0sIHsKICAgICAgICB0aXRsZTogIuWIm+W7uuaXtumXtCIsCiAgICAgICAga2V5OiAiY3JlYXRlVGltZSIsCiAgICAgICAgd2lkdGg6IDE3MCwKICAgICAgICBzb3J0YWJsZTogdHJ1ZSwKICAgICAgICBzb3J0VHlwZTogImRlc2MiCiAgICAgIH0sIHsKICAgICAgICB0aXRsZTogIuabtOaWsOaXtumXtCIsCiAgICAgICAga2V5OiAidXBkYXRlVGltZSIsCiAgICAgICAgd2lkdGg6IDE3MCwKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgdGl0bGU6ICLorr7nva7kuLrms6jlhoznlKjmiLfpu5jorqTop5LoibIiLAogICAgICAgIGtleTogImRlZmF1bHRSb2xlIiwKICAgICAgICBhbGlnbjogImNlbnRlciIsCiAgICAgICAgd2lkdGg6IDIwMCwKICAgICAgICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihoLCBwYXJhbXMpIHsKICAgICAgICAgIGlmIChwYXJhbXMucm93LmRlZmF1bHRSb2xlKSB7CiAgICAgICAgICAgIHJldHVybiBoKCJkaXYiLCBbaCgiQ2hlY2tib3giLCB7CiAgICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICAgIHZhbHVlOiB0cnVlCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBvbjogewogICAgICAgICAgICAgICAgIm9uLWNoYW5nZSI6IGZ1bmN0aW9uIG9uQ2hhbmdlKCkgewogICAgICAgICAgICAgICAgICBfdGhpcy5jYW5jZWxEZWZhdWx0KHBhcmFtcy5yb3cpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSldKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBoKCJkaXYiLCBbaCgiQ2hlY2tib3giLCB7CiAgICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICAgIHZhbHVlOiBmYWxzZQogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgb246IHsKICAgICAgICAgICAgICAgICJvbi1jaGFuZ2UiOiBmdW5jdGlvbiBvbkNoYW5nZSgpIHsKICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0RGVmYXVsdChwYXJhbXMucm93KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgdGl0bGU6ICLmk43kvZwiLAogICAgICAgIGtleTogImFjdGlvbiIsCiAgICAgICAgYWxpZ246ICJjZW50ZXIiLAogICAgICAgIGZpeGVkOiAicmlnaHQiLAogICAgICAgIHdpZHRoOiAyNzAsCiAgICAgICAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoaCwgcGFyYW1zKSB7CiAgICAgICAgICByZXR1cm4gaCgiZGl2IiwgW2goImEiLCB7CiAgICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uIGNsaWNrKCkgewogICAgICAgICAgICAgICAgX3RoaXMuZWRpdFBlcm0ocGFyYW1zLnJvdyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCAi6I+c5Y2V5p2D6ZmQIiksIGgoIkRpdmlkZXIiLCB7CiAgICAgICAgICAgIHByb3BzOiB7CiAgICAgICAgICAgICAgdHlwZTogInZlcnRpY2FsIgogICAgICAgICAgICB9CiAgICAgICAgICB9KSwgaCgiYSIsIHsKICAgICAgICAgICAgb246IHsKICAgICAgICAgICAgICBjbGljazogZnVuY3Rpb24gY2xpY2soKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5lZGl0RGVwKHBhcmFtcy5yb3cpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSwgIuaVsOaNruadg+mZkCIpLCBoKCJEaXZpZGVyIiwgewogICAgICAgICAgICBwcm9wczogewogICAgICAgICAgICAgIHR5cGU6ICJ2ZXJ0aWNhbCIKICAgICAgICAgICAgfQogICAgICAgICAgfSksIGgoImEiLCB7CiAgICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uIGNsaWNrKCkgewogICAgICAgICAgICAgICAgX3RoaXMuZWRpdChwYXJhbXMucm93KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sICLnvJbovpEiKSwgaCgiRGl2aWRlciIsIHsKICAgICAgICAgICAgcHJvcHM6IHsKICAgICAgICAgICAgICB0eXBlOiAidmVydGljYWwiCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pLCBoKCJhIiwgewogICAgICAgICAgICBvbjogewogICAgICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiBjbGljaygpIHsKICAgICAgICAgICAgICAgIF90aGlzLnJlbW92ZShwYXJhbXMucm93KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sICLliKDpmaQiKV0pOwogICAgICAgIH0KICAgICAgfV0sCiAgICAgIGRhdGE6IFtdLAogICAgICB0b3RhbDogMCwKICAgICAgcGVybURhdGE6IFtdLAogICAgICBlZGl0Um9sZVBlcm1JZDogIiIsCiAgICAgIHNlbGVjdEFsbEZsYWc6IGZhbHNlLAogICAgICBkZXBEYXRhOiBbXSwKICAgICAgZGF0YVR5cGU6IDAsCiAgICAgIGVkaXREZXBhcnRtZW50czogW10KICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0OiBmdW5jdGlvbiBpbml0KCkgewogICAgICB0aGlzLmdldERhdGFMaXN0KCk7IC8vIOiOt+WPluaJgOacieiPnOWNleadg+mZkOagkQoKICAgICAgdGhpcy5nZXRQZXJtTGlzdCgpOwogICAgfSwKICAgIHJlbmRlckNvbnRlbnQ6IGZ1bmN0aW9uIHJlbmRlckNvbnRlbnQoaCwgX3JlZikgewogICAgICB2YXIgcm9vdCA9IF9yZWYucm9vdCwKICAgICAgICAgIG5vZGUgPSBfcmVmLm5vZGUsCiAgICAgICAgICBkYXRhID0gX3JlZi5kYXRhOwogICAgICB2YXIgaWNvbiA9ICIiOwoKICAgICAgaWYgKGRhdGEubGV2ZWwgPT0gMCkgewogICAgICAgIGljb24gPSAiaW9zLW5hdmlnYXRlIjsKICAgICAgfSBlbHNlIGlmIChkYXRhLmxldmVsID09IDEpIHsKICAgICAgICBpY29uID0gIm1kLWxpc3QtYm94IjsKICAgICAgfSBlbHNlIGlmIChkYXRhLmxldmVsID09IDIpIHsKICAgICAgICBpY29uID0gIm1kLWxpc3QiOwogICAgICB9IGVsc2UgaWYgKGRhdGEubGV2ZWwgPT0gMykgewogICAgICAgIGljb24gPSAibWQtcmFkaW8tYnV0dG9uLW9uIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBpY29uID0gIm1kLXJhZGlvLWJ1dHRvbi1vZmYiOwogICAgICB9CgogICAgICByZXR1cm4gaCgic3BhbiIsIHsKICAgICAgICBzdHlsZTogewogICAgICAgICAgZGlzcGxheTogImlubGluZS1ibG9jayIsCiAgICAgICAgICBjdXJzb3I6ICJwb2ludGVyIgogICAgICAgIH0sCiAgICAgICAgb246IHsKICAgICAgICAgIGNsaWNrOiBmdW5jdGlvbiBjbGljaygpIHsKICAgICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09IC0xKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CgogICAgICAgICAgICBkYXRhLmNoZWNrZWQgPSAhZGF0YS5jaGVja2VkOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwgW2goInNwYW4iLCBbaCgiSWNvbiIsIHsKICAgICAgICBwcm9wczogewogICAgICAgICAgdHlwZTogaWNvbiwKICAgICAgICAgIHNpemU6ICIxNiIKICAgICAgICB9LAogICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAibWFyZ2luLXJpZ2h0IjogIjhweCIsCiAgICAgICAgICAibWFyZ2luLWJvdHRvbSI6ICIzcHgiCiAgICAgICAgfQogICAgICB9KSwgaCgic3BhbiIsIGRhdGEudGl0bGUpXSldKTsKICAgIH0sCiAgICBjaGFuZ2VQYWdlOiBmdW5jdGlvbiBjaGFuZ2VQYWdlKHYpIHsKICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VOdW1iZXIgPSB2OwogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICAgIHRoaXMuY2xlYXJTZWxlY3RBbGwoKTsKICAgIH0sCiAgICBjaGFuZ2VQYWdlU2l6ZTogZnVuY3Rpb24gY2hhbmdlUGFnZVNpemUodikgewogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZVNpemUgPSB2OwogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICB9LAogICAgY2hhbmdlU29ydDogZnVuY3Rpb24gY2hhbmdlU29ydChlKSB7CiAgICAgIHRoaXMuc2VhcmNoRm9ybS5zb3J0ID0gZS5rZXk7CiAgICAgIHRoaXMuc2VhcmNoRm9ybS5vcmRlciA9IGUub3JkZXI7CgogICAgICBpZiAoZS5vcmRlciA9PSAibm9ybWFsIikgewogICAgICAgIHRoaXMuc2VhcmNoRm9ybS5vcmRlciA9ICIiOwogICAgICB9CgogICAgICB0aGlzLmdldERhdGFMaXN0KCk7CiAgICB9LAogICAgY2hhbmdlVGFibGVTaXplOiBmdW5jdGlvbiBjaGFuZ2VUYWJsZVNpemUodikgewogICAgICB0aGlzLnRhYmxlU2l6ZSA9IHY7CiAgICB9LAogICAgZXhwb3J0RGF0YTogZnVuY3Rpb24gZXhwb3J0RGF0YSgpIHsKICAgICAgdGhpcy4kcmVmcy50YWJsZS5leHBvcnRDc3YoewogICAgICAgIGZpbGVuYW1lOiAi5pWw5o2uIgogICAgICB9KTsKICAgIH0sCiAgICBnZXREYXRhTGlzdDogZnVuY3Rpb24gZ2V0RGF0YUxpc3QoKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgZ2V0Um9sZUxpc3QodGhpcy5zZWFyY2hGb3JtKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczIubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIF90aGlzMi5kYXRhID0gcmVzLnJlc3VsdC5jb250ZW50OwogICAgICAgICAgX3RoaXMyLnRvdGFsID0gcmVzLnJlc3VsdC50b3RhbEVsZW1lbnRzOwoKICAgICAgICAgIGlmIChfdGhpczIuZGF0YS5sZW5ndGggPT0gMCAmJiBfdGhpczIuc2VhcmNoRm9ybS5wYWdlTnVtYmVyID4gMSkgewogICAgICAgICAgICBfdGhpczIuc2VhcmNoRm9ybS5wYWdlTnVtYmVyIC09IDE7CgogICAgICAgICAgICBfdGhpczIuZ2V0RGF0YUxpc3QoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldFBlcm1MaXN0OiBmdW5jdGlvbiBnZXRQZXJtTGlzdCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICB0aGlzLnRyZWVMb2FkaW5nID0gdHJ1ZTsKICAgICAgZ2V0QWxsUGVybWlzc2lvbkxpc3QoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIF90aGlzMy5kZWxldGVEaXNhYmxlTm9kZShyZXMucmVzdWx0KTsKCiAgICAgICAgICBfdGhpczMucGVybURhdGEgPSByZXMucmVzdWx0OwogICAgICAgICAgX3RoaXMzLnRyZWVMb2FkaW5nID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBfdGhpczMudHJlZUxvYWRpbmcgPSBmYWxzZTsKICAgICAgfSk7CiAgICB9LAogICAgLy8g6YCS5b2S5qCH6K6w56aB55So6IqC54K5CiAgICBkZWxldGVEaXNhYmxlTm9kZTogZnVuY3Rpb24gZGVsZXRlRGlzYWJsZU5vZGUocGVybURhdGEpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICBwZXJtRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgaWYgKGUuc3RhdHVzID09IC0xKSB7CiAgICAgICAgICBlLnRpdGxlID0gIlvlt7LnpoHnlKhdICIgKyBlLnRpdGxlOwogICAgICAgICAgZS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBpZiAoZS5jaGlsZHJlbiAmJiBlLmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoYXQuZGVsZXRlRGlzYWJsZU5vZGUoZS5jaGlsZHJlbik7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBjYW5jZWxSb2xlOiBmdW5jdGlvbiBjYW5jZWxSb2xlKCkgewogICAgICB0aGlzLnJvbGVNb2RhbFZpc2libGUgPSBmYWxzZTsKICAgIH0sCiAgICBzdWJtaXRSb2xlOiBmdW5jdGlvbiBzdWJtaXRSb2xlKCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHRoaXMuJHJlZnMucm9sZUZvcm0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICBpZiAoX3RoaXM0Lm1vZGFsVHlwZSA9PSAwKSB7CiAgICAgICAgICAgIC8vIOa3u+WKoAogICAgICAgICAgICBfdGhpczQuc3VibWl0TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgIGFkZFJvbGUoX3RoaXM0LnJvbGVGb3JtKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgICAgICBfdGhpczQuc3VibWl0TG9hZGluZyA9IGZhbHNlOwoKICAgICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgIF90aGlzNC4kTWVzc2FnZS5zdWNjZXNzKCLmk43kvZzmiJDlip8iKTsKCiAgICAgICAgICAgICAgICBfdGhpczQuZ2V0RGF0YUxpc3QoKTsKCiAgICAgICAgICAgICAgICBfdGhpczQucm9sZU1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczQuc3VibWl0TG9hZGluZyA9IHRydWU7CiAgICAgICAgICAgIGVkaXRSb2xlKF90aGlzNC5yb2xlRm9ybSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICAgICAgX3RoaXM0LnN1Ym1pdExvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICBfdGhpczQuJE1lc3NhZ2Uuc3VjY2Vzcygi5pON5L2c5oiQ5YqfIik7CgogICAgICAgICAgICAgICAgX3RoaXM0LmdldERhdGFMaXN0KCk7CgogICAgICAgICAgICAgICAgX3RoaXM0LnJvbGVNb2RhbFZpc2libGUgPSBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgYWRkUm9sZTogZnVuY3Rpb24gYWRkUm9sZSgpIHsKICAgICAgdGhpcy5tb2RhbFR5cGUgPSAwOwogICAgICB0aGlzLm1vZGFsVGl0bGUgPSAi5re75Yqg6KeS6ImyIjsKICAgICAgdGhpcy4kcmVmcy5yb2xlRm9ybS5yZXNldEZpZWxkcygpOwogICAgICBkZWxldGUgdGhpcy5yb2xlRm9ybS5pZDsKICAgICAgdGhpcy5yb2xlTW9kYWxWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICBlZGl0OiBmdW5jdGlvbiBlZGl0KHYpIHsKICAgICAgdGhpcy5tb2RhbFR5cGUgPSAxOwogICAgICB0aGlzLm1vZGFsVGl0bGUgPSAi57yW6L6R6KeS6ImyIjsKICAgICAgdGhpcy4kcmVmcy5yb2xlRm9ybS5yZXNldEZpZWxkcygpOyAvLyDovazmjaJudWxs5Li6IiIKCiAgICAgIGZvciAodmFyIGF0dHIgaW4gdikgewogICAgICAgIGlmICh2W2F0dHJdID09IG51bGwpIHsKICAgICAgICAgIHZbYXR0cl0gPSAiIjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHZhciBzdHIgPSBKU09OLnN0cmluZ2lmeSh2KTsKICAgICAgdmFyIHJvbGVJbmZvID0gSlNPTi5wYXJzZShzdHIpOwogICAgICB0aGlzLnJvbGVGb3JtID0gcm9sZUluZm87CiAgICAgIHRoaXMucm9sZU1vZGFsVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUodikgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHRoaXMuJE1vZGFsLmNvbmZpcm0oewogICAgICAgIHRpdGxlOiAi56Gu6K6k5Yig6ZmkIiwKICAgICAgICBjb250ZW50OiAi5oKo56Gu6K6k6KaB5Yig6Zmk6KeS6ImyICIgKyB2Lm5hbWUgKyAiID8iLAogICAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgICAgb25PazogZnVuY3Rpb24gb25PaygpIHsKICAgICAgICAgIGRlbGV0ZVJvbGUoewogICAgICAgICAgICBpZHM6IHYuaWQKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBfdGhpczUuJE1vZGFsLnJlbW92ZSgpOwoKICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgX3RoaXM1LmNsZWFyU2VsZWN0QWxsKCk7CgogICAgICAgICAgICAgIF90aGlzNS4kTWVzc2FnZS5zdWNjZXNzKCLliKDpmaTmiJDlip8iKTsKCiAgICAgICAgICAgICAgX3RoaXM1LmdldERhdGFMaXN0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgc2V0RGVmYXVsdDogZnVuY3Rpb24gc2V0RGVmYXVsdCh2KSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICBpZDogdi5pZCwKICAgICAgICBpc0RlZmF1bHQ6IHRydWUKICAgICAgfTsKICAgICAgc2V0RGVmYXVsdFJvbGUocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczYubG9hZGluZyA9IGZhbHNlOwoKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIF90aGlzNi4kTWVzc2FnZS5zdWNjZXNzKCLmk43kvZzmiJDlip8iKTsKCiAgICAgICAgICBfdGhpczYuZ2V0RGF0YUxpc3QoKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGNhbmNlbERlZmF1bHQ6IGZ1bmN0aW9uIGNhbmNlbERlZmF1bHQodikgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgaWQ6IHYuaWQsCiAgICAgICAgaXNEZWZhdWx0OiBmYWxzZQogICAgICB9OwogICAgICBzZXREZWZhdWx0Um9sZShwYXJhbXMpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzNy5sb2FkaW5nID0gZmFsc2U7CgogICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgX3RoaXM3LiRNZXNzYWdlLnN1Y2Nlc3MoIuaTjeS9nOaIkOWKnyIpOwoKICAgICAgICAgIF90aGlzNy5nZXREYXRhTGlzdCgpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2xlYXJTZWxlY3RBbGw6IGZ1bmN0aW9uIGNsZWFyU2VsZWN0QWxsKCkgewogICAgICB0aGlzLiRyZWZzLnRhYmxlLnNlbGVjdEFsbChmYWxzZSk7CiAgICB9LAogICAgY2hhbmdlU2VsZWN0OiBmdW5jdGlvbiBjaGFuZ2VTZWxlY3QoZSkgewogICAgICB0aGlzLnNlbGVjdExpc3QgPSBlOwogICAgfSwKICAgIGRlbEFsbDogZnVuY3Rpb24gZGVsQWxsKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIGlmICh0aGlzLnNlbGVjdExpc3QubGVuZ3RoIDw9IDApIHsKICAgICAgICB0aGlzLiRNZXNzYWdlLndhcm5pbmcoIuaCqOi/mOacqumAieaLqeimgeWIoOmZpOeahOaVsOaNriIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy4kTW9kYWwuY29uZmlybSh7CiAgICAgICAgdGl0bGU6ICLnoa7orqTliKDpmaQiLAogICAgICAgIGNvbnRlbnQ6ICLmgqjnoa7orqTopoHliKDpmaTmiYDpgInnmoQgIiArIHRoaXMuc2VsZWN0TGlzdC5sZW5ndGggKyAiIOadoeaVsOaNrj8iLAogICAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgICAgb25PazogZnVuY3Rpb24gb25PaygpIHsKICAgICAgICAgIHZhciBpZHMgPSAiIjsKCiAgICAgICAgICBfdGhpczguc2VsZWN0TGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgIGlkcyArPSBlLmlkICsgIiwiOwogICAgICAgICAgfSk7CgogICAgICAgICAgaWRzID0gaWRzLnN1YnN0cmluZygwLCBpZHMubGVuZ3RoIC0gMSk7CiAgICAgICAgICBkZWxldGVSb2xlKHsKICAgICAgICAgICAgaWRzOiBpZHMKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgICBfdGhpczguJE1vZGFsLnJlbW92ZSgpOwoKICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgX3RoaXM4LiRNZXNzYWdlLnN1Y2Nlc3MoIuWIoOmZpOaIkOWKnyIpOwoKICAgICAgICAgICAgICBfdGhpczguY2xlYXJTZWxlY3RBbGwoKTsKCiAgICAgICAgICAgICAgX3RoaXM4LmdldERhdGFMaXN0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZWRpdFBlcm06IGZ1bmN0aW9uIGVkaXRQZXJtKHYpIHsKICAgICAgdGhpcy5lZGl0Um9sZVBlcm1JZCA9IHYuaWQ7CiAgICAgIHRoaXMubW9kYWxUaXRsZSA9ICLliIbphY0gIiArIHYubmFtZSArICIg55qE6I+c5Y2V5p2D6ZmQIjsgLy8g5Yy56YWN5Yu+6YCJCgogICAgICB2YXIgcm9sZVBlcm1zID0gdi5wZXJtaXNzaW9uczsKCiAgICAgIGlmICh0aGlzLnRyZWVMb2FkaW5nKSB7CiAgICAgICAgdGhpcy4kTWVzc2FnZS53YXJuaW5nKCLoj5zljZXmnYPpmZDmlbDmja7liqDovb3kuK3vvIzor7fnqI3lkI7ngrnlh7vmn6XnnIsiKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8g6YCS5b2S5Yik5pat5a2Q6IqC54K5CgoKICAgICAgdGhpcy5jaGVja1Blcm1UcmVlKHRoaXMucGVybURhdGEsIHJvbGVQZXJtcyk7CiAgICAgIHRoaXMucGVybU1vZGFsVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgLy8g6YCS5b2S5Yik5pat5a2Q6IqC54K5CiAgICBjaGVja1Blcm1UcmVlOiBmdW5jdGlvbiBjaGVja1Blcm1UcmVlKHBlcm1EYXRhLCByb2xlUGVybXMpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICBwZXJtRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChwKSB7CiAgICAgICAgaWYgKHRoYXQuaGFzUGVybShwLCByb2xlUGVybXMpICYmIHAuc3RhdHVzICE9IC0xKSB7CiAgICAgICAgICBwLmNoZWNrZWQgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBwLmNoZWNrZWQgPSBmYWxzZTsKICAgICAgICB9CgogICAgICAgIGlmIChwLmNoaWxkcmVuICYmIHAuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhhdC5jaGVja1Blcm1UcmVlKHAuY2hpbGRyZW4sIHJvbGVQZXJtcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyDliKTmlq3op5LoibLmi6XmnInnmoTmnYPpmZDoioLngrnli77pgIkKICAgIGhhc1Blcm06IGZ1bmN0aW9uIGhhc1Blcm0ocCwgcm9sZVBlcm1zKSB7CiAgICAgIHZhciBmbGFnID0gZmFsc2U7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJvbGVQZXJtcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChwLmlkID09IHJvbGVQZXJtc1tpXS5wZXJtaXNzaW9uSWQpIHsKICAgICAgICAgIGZsYWcgPSB0cnVlOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoZmxhZykgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CgogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgLy8g5YWo6YCJ5Y+N6YCJCiAgICBzZWxlY3RUcmVlQWxsOiBmdW5jdGlvbiBzZWxlY3RUcmVlQWxsKCkgewogICAgICB0aGlzLnNlbGVjdEFsbEZsYWcgPSAhdGhpcy5zZWxlY3RBbGxGbGFnOwogICAgICB2YXIgc2VsZWN0ID0gdGhpcy5zZWxlY3RBbGxGbGFnOwogICAgICB0aGlzLnNlbGVjdGVkVHJlZUFsbCh0aGlzLnBlcm1EYXRhLCBzZWxlY3QpOwogICAgfSwKICAgIC8vIOmAkuW9kuWFqOmAieiKgueCuQogICAgc2VsZWN0ZWRUcmVlQWxsOiBmdW5jdGlvbiBzZWxlY3RlZFRyZWVBbGwocGVybURhdGEsIHNlbGVjdCkgewogICAgICB2YXIgdGhhdCA9IHRoaXM7CiAgICAgIHBlcm1EYXRhLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBlLmNoZWNrZWQgPSBzZWxlY3Q7CgogICAgICAgIGlmIChlLmNoaWxkcmVuICYmIGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhhdC5zZWxlY3RlZFRyZWVBbGwoZS5jaGlsZHJlbiwgc2VsZWN0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHN1Ym1pdFBlcm1FZGl0OiBmdW5jdGlvbiBzdWJtaXRQZXJtRWRpdCgpIHsKICAgICAgdmFyIF90aGlzOSA9IHRoaXM7CgogICAgICB0aGlzLnN1Ym1pdFBlcm1Mb2FkaW5nID0gdHJ1ZTsKICAgICAgdmFyIHBlcm1JZHMgPSAiIjsKICAgICAgdmFyIHNlbGVjdGVkTm9kZXMgPSB0aGlzLiRyZWZzLnRyZWUuZ2V0Q2hlY2tlZE5vZGVzKCk7CiAgICAgIHNlbGVjdGVkTm9kZXMuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgIHBlcm1JZHMgKz0gZS5pZCArICIsIjsKICAgICAgfSk7CiAgICAgIHBlcm1JZHMgPSBwZXJtSWRzLnN1YnN0cmluZygwLCBwZXJtSWRzLmxlbmd0aCAtIDEpOwogICAgICBlZGl0Um9sZVBlcm0oewogICAgICAgIHJvbGVJZDogdGhpcy5lZGl0Um9sZVBlcm1JZCwKICAgICAgICBwZXJtSWRzOiBwZXJtSWRzCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzOS5zdWJtaXRQZXJtTG9hZGluZyA9IGZhbHNlOwoKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIF90aGlzOS4kTWVzc2FnZS5zdWNjZXNzKCLmk43kvZzmiJDlip8iKTsgLy8g5qCH6K6w6YeN5paw6I635Y+W6I+c5Y2V5pWw5o2uCgoKICAgICAgICAgIF90aGlzOS4kc3RvcmUuY29tbWl0KCJzZXRBZGRlZCIsIGZhbHNlKTsKCiAgICAgICAgICB1dGlsLmluaXRSb3V0ZXIoX3RoaXM5KTsKCiAgICAgICAgICBfdGhpczkuZ2V0RGF0YUxpc3QoKTsKCiAgICAgICAgICBfdGhpczkucGVybU1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2FuY2VsUGVybUVkaXQ6IGZ1bmN0aW9uIGNhbmNlbFBlcm1FZGl0KCkgewogICAgICB0aGlzLnBlcm1Nb2RhbFZpc2libGUgPSBmYWxzZTsKICAgIH0sCiAgICBsb2FkRGF0YTogZnVuY3Rpb24gbG9hZERhdGEoaXRlbSwgY2FsbGJhY2spIHsKICAgICAgbG9hZERlcGFydG1lbnQoaXRlbS5pZCwgewogICAgICAgIG9wZW5EYXRhRmlsdGVyOiBmYWxzZQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLnN1Y2Nlc3MpIHsKICAgICAgICAgIHJlcy5yZXN1bHQuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBlLnNlbGVjdGVkID0gZmFsc2U7CgogICAgICAgICAgICBpZiAoZS5pc1BhcmVudCkgewogICAgICAgICAgICAgIGUubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAgIGUuY2hpbGRyZW4gPSBbXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGUuc3RhdHVzID09IC0xKSB7CiAgICAgICAgICAgICAgZS50aXRsZSA9ICJb5bey56aB55SoXSAiICsgZS50aXRsZTsKICAgICAgICAgICAgICBlLmRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBjYWxsYmFjayhyZXMucmVzdWx0KTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGVkaXREZXA6IGZ1bmN0aW9uIGVkaXREZXAodikgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICB0aGlzLmRhdGFUeXBlID0gMDsKICAgICAgdGhpcy5lZGl0Um9sZVBlcm1JZCA9IHYuaWQ7CiAgICAgIHRoaXMubW9kYWxUaXRsZSA9ICLliIbphY0gIiArIHYubmFtZSArICIg55qE5pWw5o2u5p2D6ZmQIjsKCiAgICAgIGlmICh2LmRhdGFUeXBlKSB7CiAgICAgICAgdGhpcy5kYXRhVHlwZSA9IHYuZGF0YVR5cGU7CiAgICAgIH0gLy8g5Yy56YWN5Yu+6YCJCgoKICAgICAgdmFyIHJvbGVEZXBJZHMgPSB2LmRlcGFydG1lbnRzOwogICAgICB0aGlzLmVkaXREZXBhcnRtZW50cyA9IHJvbGVEZXBJZHM7CiAgICAgIHRoaXMuZGVwVHJlZUxvYWRpbmcgPSB0cnVlOwogICAgICBpbml0RGVwYXJ0bWVudCh7CiAgICAgICAgb3BlbkRhdGFGaWx0ZXI6IGZhbHNlCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzMTAuZGVwVHJlZUxvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICByZXMucmVzdWx0LmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgZS5zZWxlY3RlZCA9IGZhbHNlOwoKICAgICAgICAgICAgaWYgKGUuaXNQYXJlbnQpIHsKICAgICAgICAgICAgICBlLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICBlLmNoaWxkcmVuID0gW107CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmIChlLnN0YXR1cyA9PSAtMSkgewogICAgICAgICAgICAgIGUudGl0bGUgPSAiW+W3suemgeeUqF0gIiArIGUudGl0bGU7CiAgICAgICAgICAgICAgZS5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgX3RoaXMxMC5kZXBEYXRhID0gcmVzLnJlc3VsdDsgLy8g5Yik5pat5a2Q6IqC54K5CgogICAgICAgICAgX3RoaXMxMC5jaGVja0RlcFRyZWUoX3RoaXMxMC5kZXBEYXRhLCByb2xlRGVwSWRzKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICB0aGlzLmRlcE1vZGFsVmlzaWJsZSA9IHRydWU7CiAgICB9LAogICAgZXhwYW5kQ2hlY2tEZXA6IGZ1bmN0aW9uIGV4cGFuZENoZWNrRGVwKHYpIHsKICAgICAgLy8g5Yik5pat5bGV5byA5a2Q6IqC54K5CiAgICAgIHRoaXMuY2hlY2tEZXBUcmVlKHYuY2hpbGRyZW4sIHRoaXMuZWRpdERlcGFydG1lbnRzKTsKICAgIH0sCiAgICAvLyDliKTmlq3lrZDoioLngrkKICAgIGNoZWNrRGVwVHJlZTogZnVuY3Rpb24gY2hlY2tEZXBUcmVlKGRlcERhdGEsIHJvbGVEZXBJZHMpIHsKICAgICAgdmFyIHRoYXQgPSB0aGlzOwogICAgICBkZXBEYXRhLmZvckVhY2goZnVuY3Rpb24gKHApIHsKICAgICAgICBpZiAodGhhdC5oYXNEZXBQZXJtKHAsIHJvbGVEZXBJZHMpKSB7CiAgICAgICAgICBwLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcC5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgLy8g5Yik5pat6KeS6Imy5oul5pyJ55qE5p2D6ZmQ6IqC54K55Yu+6YCJCiAgICBoYXNEZXBQZXJtOiBmdW5jdGlvbiBoYXNEZXBQZXJtKHAsIHJvbGVEZXBJZHMpIHsKICAgICAgdmFyIGZsYWcgPSBmYWxzZTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm9sZURlcElkcy5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChwLmlkID09IHJvbGVEZXBJZHNbaV0uZGVwYXJ0bWVudElkKSB7CiAgICAgICAgICBmbGFnID0gdHJ1ZTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKGZsYWcpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQoKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIHN1Ym1pdERlcEVkaXQ6IGZ1bmN0aW9uIHN1Ym1pdERlcEVkaXQoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHZhciBkZXBJZHMgPSAiIjsKCiAgICAgIGlmICh0aGlzLmRhdGFUeXBlID09IDEpIHsKICAgICAgICB2YXIgc2VsZWN0ZWROb2RlcyA9IHRoaXMuJHJlZnMuZGVwVHJlZS5nZXRTZWxlY3RlZE5vZGVzKCk7CiAgICAgICAgc2VsZWN0ZWROb2Rlcy5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBkZXBJZHMgKz0gZS5pZCArICIsIjsKICAgICAgICB9KTsKICAgICAgICBkZXBJZHMgPSBkZXBJZHMuc3Vic3RyaW5nKDAsIGRlcElkcy5sZW5ndGggLSAxKTsKICAgICAgfQoKICAgICAgdGhpcy5zdWJtaXREZXBMb2FkaW5nID0gdHJ1ZTsKICAgICAgZWRpdFJvbGVEZXAoewogICAgICAgIHJvbGVJZDogdGhpcy5lZGl0Um9sZVBlcm1JZCwKICAgICAgICBkYXRhVHlwZTogdGhpcy5kYXRhVHlwZSwKICAgICAgICBkZXBJZHM6IGRlcElkcwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczExLnN1Ym1pdERlcExvYWRpbmcgPSBmYWxzZTsKCiAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7CiAgICAgICAgICBfdGhpczExLiRNZXNzYWdlLnN1Y2Nlc3MoIuaTjeS9nOaIkOWKnyIpOwoKICAgICAgICAgIF90aGlzMTEuZ2V0RGF0YUxpc3QoKTsKCiAgICAgICAgICBfdGhpczExLmRlcE1vZGFsVmlzaWJsZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgY2hhbmdlT3BlbjogZnVuY3Rpb24gY2hhbmdlT3Blbih2KSB7CiAgICAgIGlmICh2ID09ICIwIikgewogICAgICAgIHRoaXMucGVybURhdGEuZm9yRWFjaChmdW5jdGlvbiAoZSkgewogICAgICAgICAgZS5leHBhbmQgPSB0cnVlOwoKICAgICAgICAgIGlmIChlLmNoaWxkcmVuICYmIGUuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICBlLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGMpIHsKICAgICAgICAgICAgICBjLmV4cGFuZCA9IHRydWU7CgogICAgICAgICAgICAgIGlmIChjLmNoaWxkcmVuICYmIGMuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgYy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7CiAgICAgICAgICAgICAgICAgIGIuZXhwYW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodiA9PSAiMSIpIHsKICAgICAgICB0aGlzLnBlcm1EYXRhLmZvckVhY2goZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGUuZXhwYW5kID0gZmFsc2U7CgogICAgICAgICAgaWYgKGUuY2hpbGRyZW4gJiYgZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoYykgewogICAgICAgICAgICAgIGMuZXhwYW5kID0gZmFsc2U7CgogICAgICAgICAgICAgIGlmIChjLmNoaWxkcmVuICYmIGMuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgYy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7CiAgICAgICAgICAgICAgICAgIGIuZXhwYW5kID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHYgPT0gIjIiKSB7CiAgICAgICAgdGhpcy5wZXJtRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBlLmV4cGFuZCA9IHRydWU7CgogICAgICAgICAgaWYgKGUuY2hpbGRyZW4gJiYgZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoYykgewogICAgICAgICAgICAgIGMuZXhwYW5kID0gZmFsc2U7CgogICAgICAgICAgICAgIGlmIChjLmNoaWxkcmVuICYmIGMuY2hpbGRyZW4ubGVuZ3RoID4gMCkgewogICAgICAgICAgICAgICAgYy5jaGlsZHJlbi5mb3JFYWNoKGZ1bmN0aW9uIChiKSB7CiAgICAgICAgICAgICAgICAgIGIuZXhwYW5kID0gZmFsc2U7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKHYgPT0gIjMiKSB7CiAgICAgICAgdGhpcy5wZXJtRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBlLmV4cGFuZCA9IHRydWU7CgogICAgICAgICAgaWYgKGUuY2hpbGRyZW4gJiYgZS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIGUuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbiAoYykgewogICAgICAgICAgICAgIGMuZXhwYW5kID0gdHJ1ZTsKCiAgICAgICAgICAgICAgaWYgKGMuY2hpbGRyZW4gJiYgYy5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgICAgICBjLmNoaWxkcmVuLmZvckVhY2goZnVuY3Rpb24gKGIpIHsKICAgICAgICAgICAgICAgICAgYi5leHBhbmQgPSBmYWxzZTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLm1heEhlaWdodCA9IE51bWJlcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gMTIxKSArICJweCI7CiAgICB0aGlzLmluaXQoKTsKICB9Cn07"},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkOA,SACAA,WADA,EAEAC,oBAFA,EAGAC,OAHA,EAIAC,QAJA,EAKAC,UALA,EAMAC,cANA,EAOAC,YAPA,EAQAC,cARA,EASAC,cATA,EAUAC,WAVA,QAWA,aAXA;AAYA;AACA;EACAC,mBADA;EAEAC,IAFA,kBAEA;IAAA;;IACA;MACAC,oBADA;MAEAC,cAFA;MAGAC,aAHA;MAIAC,cAJA;MAKAC,aALA;MAMAC,iBANA;MAOAC,oBAPA;MAQAC,wBARA;MASAC,uBATA;MAUAC,aAVA;MAWAC,wBAXA;MAYAC,gBAZA;MAaAC,YAbA;MAcAC,uBAdA;MAeAC,uBAfA;MAgBAC,sBAhBA;MAiBAC,cAjBA;MAkBAC;QACA;QACAC,aAFA;QAEA;QACAC,YAHA;QAGA;QACAC,kBAJA;QAIA;QACAC,aALA;QAKA;QACAC;MANA,CAlBA;MA0BAC;QACAzB,QADA;QAEA0B;MAFA,CA1BA;MA8BAC;QACA3B,OACA;UAAA4B;UAAAC;UAAAC;QAAA,CADA;MADA,CA9BA;MAmCAC,oBAnCA;MAoCAC,cApCA;MAqCAC,UACA;QACAC,iBADA;QAEAC,SAFA;QAGAC;MAHA,CADA,EAMA;QACAF,aADA;QAEAC,SAFA;QAGAC;MAHA,CANA,EAWA;QACAC,aADA;QAEAb,WAFA;QAGAc,aAHA;QAIAC;MAJA,CAXA,EAiBA;QACAF,WADA;QAEAb,kBAFA;QAGAc,aAHA;QAIAC;MAJA,CAjBA,EAuBA;QACAF,aADA;QAEAb,iBAFA;QAGAW,UAHA;QAIAI,cAJA;QAKA1B;MALA,CAvBA,EA8BA;QACAwB,aADA;QAEAb,iBAFA;QAGAW,UAHA;QAIAI;MAJA,CA9BA,EAoCA;QACAF,oBADA;QAEAb,kBAFA;QAGAY,eAHA;QAIAD,UAJA;QAKAK;UACA;YACA,iBACAC;cACAC;gBACAC;cADA,CADA;cAIAC;gBACA;kBACA;gBACA;cAHA;YAJA,EADA;UAYA,CAbA,MAaA;YACA,iBACAH;cACAC;gBACAC;cADA,CADA;cAIAC;gBACA;kBACA;gBACA;cAHA;YAJA,EADA;UAYA;QACA;MAjCA,CApCA,EAuEA;QACAP,WADA;QAEAb,aAFA;QAGAY,eAHA;QAIAS,cAJA;QAKAV,UALA;QAMAK;UACA,iBACAC,EACA,GADA,EAEA;YACAG;cACAE;gBACA;cACA;YAHA;UADA,CAFA,EASA,MATA,CADA,EAYAL;YACAC;cACAR;YADA;UADA,EAZA,EAiBAO,EACA,GADA,EAEA;YACAG;cACAE;gBACA;cACA;YAHA;UADA,CAFA,EASA,MATA,CAjBA,EA4BAL;YACAC;cACAR;YADA;UADA,EA5BA,EAiCAO,EACA,GADA,EAEA;YACAG;cACAE;gBACA;cACA;YAHA;UADA,CAFA,EASA,IATA,CAjCA,EA4CAL;YACAC;cACAR;YADA;UADA,EA5CA,EAiDAO,EACA,GADA,EAEA;YACAG;cACAE;gBACA;cACA;YAHA;UADA,CAFA,EASA,IATA,CAjDA;QA6DA;MApEA,CAvEA,CArCA;MAmLA7C,QAnLA;MAoLA8C,QApLA;MAqLAC,YArLA;MAsLAC,kBAtLA;MAuLAC,oBAvLA;MAwLAC,WAxLA;MAyLAC,WAzLA;MA0LAC;IA1LA;EA4LA,CA/LA;EAgMAC;IACAC,IADA,kBACA;MACA,mBADA,CAEA;;MACA;IACA,CALA;IAMAC,aANA,yBAMAf,CANA,QAMA;MAAA;MAAA;MAAA;MACA;;MACA;QACAgB;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA,CAFA,MAEA;QACAA;MACA;;MACA,SACA,MADA,EAEA;QACAC;UACAC,uBADA;UAEAC;QAFA,CADA;QAKAhB;UACAE;YACA;cACA;YACA;;YACA7C;UACA;QANA;MALA,CAFA,EAgBA,CACAwC,WACAA;QACAC;UACAR,UADA;UAEA2B;QAFA,CADA;QAKAH;UACA,qBADA;UAEA;QAFA;MALA,EADA,EAWAjB,qBAXA,EADA,CAhBA;IAgCA,CAnDA;IAoDAqB,UApDA,sBAoDAC,CApDA,EAoDA;MACA;MACA;MACA;IACA,CAxDA;IAyDAC,cAzDA,0BAyDAD,CAzDA,EAyDA;MACA;MACA;IACA,CA5DA;IA6DAE,UA7DA,sBA6DAC,CA7DA,EA6DA;MACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CApEA;IAqEAC,eArEA,2BAqEAJ,CArEA,EAqEA;MACA;IACA,CAvEA;IAwEAK,UAxEA,wBAwEA;MACA;QACAC;MADA;IAGA,CA5EA;IA6EAC,WA7EA,yBA6EA;MAAA;;MACA;MACAhF;QACA;;QACA;UACA;UACA;;UACA;YACA;;YACA;UACA;QACA;MACA,CAVA;IAWA,CA1FA;IA2FAiF,WA3FA,yBA2FA;MAAA;;MACA;MACAhF;QACA;UACA;;UACA;UACA;QACA;;QACA;MACA,CAPA;IAQA,CArGA;IAsGA;IACAiF,iBAvGA,6BAuGAxB,QAvGA,EAuGA;MACA;MACAA;QACA;UACAkB;UACAA;QACA;;QACA;UACAO;QACA;MACA,CARA;IASA,CAlHA;IAmHAC,UAnHA,wBAmHA;MACA;IACA,CArHA;IAsHAC,UAtHA,wBAsHA;MAAA;;MACA;QACA;UACA;YACA;YACA;YACAnF;cACA;;cACA;gBACA;;gBACA;;gBACA;cACA;YACA,CAPA;UAQA,CAXA,MAWA;YACA;YACAC;cACA;;cACA;gBACA;;gBACA;;gBACA;cACA;YACA,CAPA;UAQA;QACA;MACA,CAzBA;IA0BA,CAjJA;IAkJAD,OAlJA,qBAkJA;MACA;MACA;MACA;MACA;MACA;IACA,CAxJA;IAyJAoF,IAzJA,gBAyJAb,CAzJA,EAyJA;MACA;MACA;MACA,kCAHA,CAIA;;MACA;QACA;UACAA;QACA;MACA;;MACA;MACA;MACA;MACA;IACA,CAvKA;IAwKAc,MAxKA,kBAwKAd,CAxKA,EAwKA;MAAA;;MACA;QACA1B,aADA;QAEAyC,oCAFA;QAGAxE,aAHA;QAIAyE;UACArF;YAAAsF;UAAA;YACA;;YACA;cACA;;cACA;;cACA;YACA;UACA,CAPA;QAQA;MAbA;IAeA,CAxLA;IAyLAC,UAzLA,sBAyLAlB,CAzLA,EAyLA;MAAA;;MACA;MACA;QACAmB,QADA;QAEAC;MAFA;MAIAxF;QACA;;QACA;UACA;;UACA;QACA;MACA,CANA;IAOA,CAtMA;IAuMAyF,aAvMA,yBAuMArB,CAvMA,EAuMA;MAAA;;MACA;MACA;QACAmB,QADA;QAEAC;MAFA;MAIAxF;QACA;;QACA;UACA;;UACA;QACA;MACA,CANA;IAOA,CApNA;IAqNA0F,cArNA,4BAqNA;MACA;IACA,CAvNA;IAwNAC,YAxNA,wBAwNApB,CAxNA,EAwNA;MACA;IACA,CA1NA;IA2NAqB,MA3NA,oBA2NA;MAAA;;MACA;QACA;QACA;MACA;;MACA;QACAlD,aADA;QAEAyC,wDAFA;QAGAxE,aAHA;QAIAyE;UACA;;UACA;YACAC;UACA,CAFA;;UAGAA;UACAtF;YAAAsF;UAAA;YACA;;YACA;cACA;;cACA;;cACA;YACA;UACA,CAPA;QAQA;MAlBA;IAoBA,CApPA;IAqPAQ,QArPA,oBAqPAzB,CArPA,EAqPA;MACA;MACA,4CAFA,CAGA;;MACA;;MACA;QACA;QACA;MACA,CARA,CASA;;;MACA;MACA;IACA,CAjQA;IAkQA;IACA0B,aAnQA,yBAmQAzC,QAnQA,EAmQA0C,SAnQA,EAmQA;MACA;MACA1C;QACA;UACA2C;QACA,CAFA,MAEA;UACAA;QACA;;QACA;UACAlB;QACA;MACA,CATA;IAUA,CA/QA;IAgRA;IACAmB,OAjRA,mBAiRAD,CAjRA,EAiRAD,SAjRA,EAiRA;MACA;;MACA;QACA;UACAG;UACA;QACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CA7RA;IA8RA;IACAC,aA/RA,2BA+RA;MACA;MACA;MACA;IACA,CAnSA;IAoSA;IACAC,eArSA,2BAqSA/C,QArSA,EAqSAgD,MArSA,EAqSA;MACA;MACAhD;QACAkB;;QACA;UACAO;QACA;MACA,CALA;IAMA,CA7SA;IA8SAwB,cA9SA,4BA8SA;MAAA;;MACA;MACA;MACA;MACAC;QACAC;MACA,CAFA;MAGAA;MACAvG;QACAwG,2BADA;QAEAD;MAFA,GAGAE,IAHA,CAGA;QACA;;QACA;UACA,gCADA,CAEA;;;UACA;;UACAC;;UACA;;UACA;QACA;MACA,CAbA;IAcA,CApUA;IAqUAC,cArUA,4BAqUA;MACA;IACA,CAvUA;IAwUAC,QAxUA,oBAwUAC,IAxUA,EAwUAC,QAxUA,EAwUA;MACA5G;QAAA6G;MAAA;QACA;UACAC;YACA1C;;YACA;cACAA;cACAA;YACA;;YACA;cACAA;cACAA;YACA;UACA,CAVA;UAWAwC;QACA;MACA,CAfA;IAgBA,CAzVA;IA0VAG,OA1VA,mBA0VA9C,CA1VA,EA0VA;MAAA;;MACA;MACA;MACA;;MACA;QACA;MACA,CANA,CAOA;;;MACA;MACA;MACA;MACAlE;QAAA8G;MAAA;QACA;;QACA;UACAC;YACA1C;;YACA;cACAA;cACAA;YACA;;YACA;cACAA;cACAA;YACA;UACA,CAVA;UAWA,6BAZA,CAaA;;UACA;QACA;MACA,CAlBA;MAmBA;IACA,CAzXA;IA0XA4C,cA1XA,0BA0XA/C,CA1XA,EA0XA;MACA;MACA;IACA,CA7XA;IA8XA;IACAgD,YA/XA,wBA+XA5D,OA/XA,EA+XA6D,UA/XA,EA+XA;MACA;MACA7D;QACA;UACAwC;QACA,CAFA,MAEA;UACAA;QACA;MACA,CANA;IAOA,CAxYA;IAyYA;IACAsB,UA1YA,sBA0YAtB,CA1YA,EA0YAqB,UA1YA,EA0YA;MACA;;MACA;QACA;UACAnB;UACA;QACA;MACA;;MACA;QACA;MACA;;MACA;IACA,CAtZA;IAuZAqB,aAvZA,2BAuZA;MAAA;;MACA;;MACA;QACA;QACAhB;UACAiB;QACA,CAFA;QAGAA;MACA;;MACA;MACApH;QACAqG,2BADA;QAEAhD,uBAFA;QAGA+D;MAHA,GAIAd,IAJA,CAIA;QACA;;QACA;UACA;;UACA;;UACA;QACA;MACA,CAXA;IAYA,CA7aA;IA8aAe,UA9aA,sBA8aArD,CA9aA,EA8aA;MACA;QACA;UACAG;;UACA;YACAA;cACAmD;;cACA;gBACAA;kBACAC;gBACA,CAFA;cAGA;YACA,CAPA;UAQA;QACA,CAZA;MAaA,CAdA,MAcA;QACA;UACApD;;UACA;YACAA;cACAmD;;cACA;gBACAA;kBACAC;gBACA,CAFA;cAGA;YACA,CAPA;UAQA;QACA,CAZA;MAaA,CAdA,MAcA;QACA;UACApD;;UACA;YACAA;cACAmD;;cACA;gBACAA;kBACAC;gBACA,CAFA;cAGA;YACA,CAPA;UAQA;QACA,CAZA;MAaA,CAdA,MAcA;QACA;UACApD;;UACA;YACAA;cACAmD;;cACA;gBACAA;kBACAC;gBACA,CAFA;cAGA;YACA,CAPA;UAQA;QACA,CAZA;MAaA;IACA;EAxeA,CAhMA;EA0qBAC,OA1qBA,qBA0qBA;IACA;IACA;EACA;AA7qBA","names":["getRoleList","getAllPermissionList","addRole","editRole","deleteRole","setDefaultRole","editRolePerm","initDepartment","loadDepartment","editRoleDep","name","data","tableSize","maxHeight","openTip","openLevel","loading","treeLoading","depTreeLoading","submitPermLoading","submitDepLoading","searchKey","sortColumn","sortType","modalType","roleModalVisible","permModalVisible","depModalVisible","modalTitle","searchForm","pageNumber","pageSize","sort","order","key","roleForm","description","roleFormValidate","required","message","trigger","submitLoading","selectList","columns","type","width","align","title","minWidth","sortable","render","h","props","value","on","fixed","click","total","permData","editRolePermId","selectAllFlag","depData","dataType","editDepartments","methods","init","renderContent","icon","style","display","cursor","size","changePage","v","changePageSize","changeSort","e","changeTableSize","exportData","filename","getDataList","getPermList","deleteDisableNode","that","cancelRole","submitRole","edit","remove","content","onOk","ids","setDefault","id","isDefault","cancelDefault","clearSelectAll","changeSelect","delAll","editPerm","checkPermTree","rolePerms","p","hasPerm","flag","selectTreeAll","selectedTreeAll","select","submitPermEdit","selectedNodes","permIds","roleId","then","util","cancelPermEdit","loadData","item","callback","openDataFilter","res","editDep","expandCheckDep","checkDepTree","roleDepIds","hasDepPerm","submitDepEdit","depIds","changeOpen","c","b","mounted"],"sourceRoot":"src/views/sys/role-manage","sources":["roleManage.vue"],"sourcesContent":["<style lang=\"less\">\r\n@import \"@/styles/table-common.less\";\r\n@import \"@/styles/drawer-common.less\";\r\n@import \"./roleManage.less\";\r\n</style>\r\n<template>\r\n  <div class=\"search\">\r\n    <Card>\r\n      <Row align=\"middle\" justify=\"space-between\" class=\"operation\">\r\n        <div>\r\n          <Button @click=\"addRole\" type=\"primary\" icon=\"md-add\"\r\n            >添加角色</Button\r\n          >\r\n          <Button @click=\"delAll\" icon=\"md-trash\">批量删除</Button>\r\n          <Input\r\n            v-model=\"searchForm.key\"\r\n            suffix=\"ios-search\"\r\n            @on-change=\"getDataList\"\r\n            placeholder=\"输入关键词搜索\"\r\n            clearable\r\n            style=\"width: 250px\"\r\n          />\r\n        </div>\r\n        <div class=\"icons\">\r\n          <Tooltip content=\"刷新\" placement=\"top\" transfer>\r\n            <Icon\r\n              type=\"md-refresh\"\r\n              size=\"18\"\r\n              class=\"item\"\r\n              @click=\"init\"\r\n            />\r\n          </Tooltip>\r\n          <Tooltip\r\n            :content=\"openTip ? '关闭提示' : '开启提示'\"\r\n            placement=\"top\"\r\n            transfer\r\n          >\r\n            <Icon\r\n              type=\"md-bulb\"\r\n              size=\"18\"\r\n              class=\"item tip\"\r\n              @click=\"openTip = !openTip\"\r\n            />\r\n          </Tooltip>\r\n          <Tooltip content=\"表格密度\" placement=\"top\" transfer>\r\n            <Dropdown @on-click=\"changeTableSize\" trigger=\"click\">\r\n              <Icon type=\"md-list\" size=\"18\" class=\"item\" />\r\n              <DropdownMenu slot=\"list\">\r\n                <DropdownItem :selected=\"tableSize == 'default'\" name=\"default\"\r\n                  >默认</DropdownItem\r\n                >\r\n                <DropdownItem :selected=\"tableSize == 'large'\" name=\"large\"\r\n                  >宽松</DropdownItem\r\n                >\r\n                <DropdownItem :selected=\"tableSize == 'small'\" name=\"small\"\r\n                  >紧密</DropdownItem\r\n                >\r\n              </DropdownMenu>\r\n            </Dropdown>\r\n          </Tooltip>\r\n          <Tooltip content=\"导出数据\" placement=\"top\" transfer>\r\n            <Icon\r\n              type=\"md-download\"\r\n              size=\"18\"\r\n              class=\"item\"\r\n              @click=\"exportData\"\r\n            />\r\n          </Tooltip>\r\n        </div>\r\n      </Row>\r\n      <Alert show-icon v-show=\"openTip\">\r\n        已选择\r\n        <span class=\"select-count\">{{ selectList.length }}</span> 项\r\n        <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\r\n      </Alert>\r\n      <Table\r\n        :loading=\"loading\"\r\n        border\r\n        :columns=\"columns\"\r\n        :data=\"data\"\r\n        :size=\"tableSize\"\r\n        ref=\"table\"\r\n        sortable=\"custom\"\r\n        @on-sort-change=\"changeSort\"\r\n        @on-selection-change=\"changeSelect\"\r\n      ></Table>\r\n      <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n        <Page\r\n          :current=\"searchForm.pageNumber\"\r\n          :total=\"total\"\r\n          :page-size=\"searchForm.pageSize\"\r\n          @on-change=\"changePage\"\r\n          @on-page-size-change=\"changePageSize\"\r\n          :page-size-opts=\"[10, 20, 50]\"\r\n          size=\"small\"\r\n          show-total\r\n          show-elevator\r\n          show-sizer\r\n        ></Page>\r\n      </Row>\r\n    </Card>\r\n\r\n    <!-- 编辑 -->\r\n    <Modal\r\n      :title=\"modalTitle\"\r\n      v-model=\"roleModalVisible\"\r\n      :mask-closable=\"false\"\r\n      :width=\"500\"\r\n    >\r\n      <Form\r\n        ref=\"roleForm\"\r\n        :model=\"roleForm\"\r\n        :label-width=\"80\"\r\n        :rules=\"roleFormValidate\"\r\n      >\r\n        <FormItem label=\"角色名称\" prop=\"name\">\r\n          <Input\r\n            v-model=\"roleForm.name\"\r\n            placeholder=\"按照Spring Security约定建议以‘ROLE_’开头\"\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"备注\" prop=\"description\">\r\n          <Input v-model=\"roleForm.description\" />\r\n        </FormItem>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"cancelRole\">取消</Button>\r\n        <Button type=\"primary\" :loading=\"submitLoading\" @click=\"submitRole\"\r\n          >提交</Button\r\n        >\r\n      </div>\r\n    </Modal>\r\n\r\n    <!-- 菜单权限 -->\r\n    <Drawer\r\n      :title=\"modalTitle\"\r\n      v-model=\"permModalVisible\"\r\n      :mask-closable=\"false\"\r\n      :width=\"500\"\r\n      draggable\r\n    >\r\n      <div :style=\"{ maxHeight: maxHeight }\" class=\"drawer-content\">\r\n        <div style=\"position: relative\">\r\n          <Tree\r\n            ref=\"tree\"\r\n            :data=\"permData\"\r\n            show-checkbox\r\n            :render=\"renderContent\"\r\n            :check-strictly=\"true\"\r\n          ></Tree>\r\n          <Spin size=\"large\" fix v-if=\"treeLoading\"></Spin>\r\n        </div>\r\n      </div>\r\n      <div class=\"drawer-footer br\">\r\n        <Button\r\n          type=\"primary\"\r\n          :loading=\"submitPermLoading\"\r\n          @click=\"submitPermEdit\"\r\n          >提交</Button\r\n        >\r\n        <Button @click=\"selectTreeAll\">全选/反选</Button>\r\n        <Select\r\n          v-model=\"openLevel\"\r\n          @on-change=\"changeOpen\"\r\n          style=\"width: 110px\"\r\n          transfer\r\n        >\r\n          <Option value=\"0\">展开所有</Option>\r\n          <Option value=\"1\">收合所有</Option>\r\n          <Option value=\"2\">仅展开一级</Option>\r\n          <Option value=\"3\">仅展开两级</Option>\r\n        </Select>\r\n        <Button type=\"text\" @click=\"cancelPermEdit\">取消</Button>\r\n      </div>\r\n    </Drawer>\r\n\r\n    <!-- 数据权限 -->\r\n    <Modal\r\n      :title=\"modalTitle\"\r\n      v-model=\"depModalVisible\"\r\n      :mask-closable=\"false\"\r\n      :width=\"500\"\r\n    >\r\n      <div class=\"depModal\">\r\n        <Alert show-icon\r\n          >默认可查看全部数据，自定义数据范围时请勾选下方数据</Alert\r\n        >\r\n        <Form :label-width=\"85\">\r\n          <FormItem label=\"数据范围\">\r\n            <Select v-model=\"dataType\" transfer>\r\n              <Option :value=\"0\">全部数据权限</Option>\r\n              <Option :value=\"1\">自定义数据权限</Option>\r\n              <Option :value=\"2\">本部门及以下数据权限</Option>\r\n              <Option :value=\"3\">本部门数据权限</Option>\r\n              <Option :value=\"4\">仅自己数据权限</Option>\r\n            </Select>\r\n          </FormItem>\r\n        </Form>\r\n        <div v-show=\"dataType == 1\" style=\"margin-top: 15px\">\r\n          <div style=\"position: relative\">\r\n            <Tree\r\n              ref=\"depTree\"\r\n              :data=\"depData\"\r\n              :load-data=\"loadData\"\r\n              @on-toggle-expand=\"expandCheckDep\"\r\n              multiple\r\n              style=\"margin-top: 15px\"\r\n            ></Tree>\r\n            <Spin size=\"large\" fix v-if=\"depTreeLoading\"></Spin>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"depModalVisible = false\">取消</Button>\r\n        <Button\r\n          type=\"primary\"\r\n          :loading=\"submitDepLoading\"\r\n          @click=\"submitDepEdit\"\r\n          >提交</Button\r\n        >\r\n      </div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport {\r\n  getRoleList,\r\n  getAllPermissionList,\r\n  addRole,\r\n  editRole,\r\n  deleteRole,\r\n  setDefaultRole,\r\n  editRolePerm,\r\n  initDepartment,\r\n  loadDepartment,\r\n  editRoleDep,\r\n} from \"@/api/index\";\r\nimport util from \"@/libs/util.js\";\r\nexport default {\r\n  name: \"role-manage\",\r\n  data() {\r\n    return {\r\n      tableSize: \"default\",\r\n      maxHeight: 510,\r\n      openTip: true,\r\n      openLevel: \"0\",\r\n      loading: true,\r\n      treeLoading: true,\r\n      depTreeLoading: true,\r\n      submitPermLoading: false,\r\n      submitDepLoading: false,\r\n      searchKey: \"\",\r\n      sortColumn: \"createTime\",\r\n      sortType: \"desc\",\r\n      modalType: 0,\r\n      roleModalVisible: false,\r\n      permModalVisible: false,\r\n      depModalVisible: false,\r\n      modalTitle: \"\",\r\n      searchForm: {\r\n        // 搜索框初始化对象\r\n        pageNumber: 1, // 当前页数\r\n        pageSize: 10, // 页面大小\r\n        sort: \"createTime\", // 默认排序字段\r\n        order: \"desc\", // 默认排序方式\r\n        key: \"\",\r\n      },\r\n      roleForm: {\r\n        name: \"\",\r\n        description: \"\",\r\n      },\r\n      roleFormValidate: {\r\n        name: [\r\n          { required: true, message: \"角色名称不能为空\", trigger: \"blur\" },\r\n        ],\r\n      },\r\n      submitLoading: false,\r\n      selectList: [],\r\n      columns: [\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          type: \"index\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          title: \"角色名称\",\r\n          key: \"name\",\r\n          minWidth: 150,\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"备注\",\r\n          key: \"description\",\r\n          minWidth: 150,\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          width: 170,\r\n          sortable: true,\r\n          sortType: \"desc\",\r\n        },\r\n        {\r\n          title: \"更新时间\",\r\n          key: \"updateTime\",\r\n          width: 170,\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"设置为注册用户默认角色\",\r\n          key: \"defaultRole\",\r\n          align: \"center\",\r\n          width: 200,\r\n          render: (h, params) => {\r\n            if (params.row.defaultRole) {\r\n              return h(\"div\", [\r\n                h(\"Checkbox\", {\r\n                  props: {\r\n                    value: true,\r\n                  },\r\n                  on: {\r\n                    \"on-change\": () => {\r\n                      this.cancelDefault(params.row);\r\n                    },\r\n                  },\r\n                }),\r\n              ]);\r\n            } else {\r\n              return h(\"div\", [\r\n                h(\"Checkbox\", {\r\n                  props: {\r\n                    value: false,\r\n                  },\r\n                  on: {\r\n                    \"on-change\": () => {\r\n                      this.setDefault(params.row);\r\n                    },\r\n                  },\r\n                }),\r\n              ]);\r\n            }\r\n          },\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          key: \"action\",\r\n          align: \"center\",\r\n          fixed: \"right\",\r\n          width: 270,\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.editPerm(params.row);\r\n                    },\r\n                  },\r\n                },\r\n                \"菜单权限\"\r\n              ),\r\n              h(\"Divider\", {\r\n                props: {\r\n                  type: \"vertical\",\r\n                },\r\n              }),\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.editDep(params.row);\r\n                    },\r\n                  },\r\n                },\r\n                \"数据权限\"\r\n              ),\r\n              h(\"Divider\", {\r\n                props: {\r\n                  type: \"vertical\",\r\n                },\r\n              }),\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.edit(params.row);\r\n                    },\r\n                  },\r\n                },\r\n                \"编辑\"\r\n              ),\r\n              h(\"Divider\", {\r\n                props: {\r\n                  type: \"vertical\",\r\n                },\r\n              }),\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.remove(params.row);\r\n                    },\r\n                  },\r\n                },\r\n                \"删除\"\r\n              ),\r\n            ]);\r\n          },\r\n        },\r\n      ],\r\n      data: [],\r\n      total: 0,\r\n      permData: [],\r\n      editRolePermId: \"\",\r\n      selectAllFlag: false,\r\n      depData: [],\r\n      dataType: 0,\r\n      editDepartments: [],\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getDataList();\r\n      // 获取所有菜单权限树\r\n      this.getPermList();\r\n    },\r\n    renderContent(h, { root, node, data }) {\r\n      let icon = \"\";\r\n      if (data.level == 0) {\r\n        icon = \"ios-navigate\";\r\n      } else if (data.level == 1) {\r\n        icon = \"md-list-box\";\r\n      } else if (data.level == 2) {\r\n        icon = \"md-list\";\r\n      } else if (data.level == 3) {\r\n        icon = \"md-radio-button-on\";\r\n      } else {\r\n        icon = \"md-radio-button-off\";\r\n      }\r\n      return h(\r\n        \"span\",\r\n        {\r\n          style: {\r\n            display: \"inline-block\",\r\n            cursor: \"pointer\",\r\n          },\r\n          on: {\r\n            click: () => {\r\n              if (data.status == -1) {\r\n                return;\r\n              }\r\n              data.checked = !data.checked;\r\n            },\r\n          },\r\n        },\r\n        [\r\n          h(\"span\", [\r\n            h(\"Icon\", {\r\n              props: {\r\n                type: icon,\r\n                size: \"16\",\r\n              },\r\n              style: {\r\n                \"margin-right\": \"8px\",\r\n                \"margin-bottom\": \"3px\",\r\n              },\r\n            }),\r\n            h(\"span\", data.title),\r\n          ]),\r\n        ]\r\n      );\r\n    },\r\n    changePage(v) {\r\n      this.searchForm.pageNumber = v;\r\n      this.getDataList();\r\n      this.clearSelectAll();\r\n    },\r\n    changePageSize(v) {\r\n      this.searchForm.pageSize = v;\r\n      this.getDataList();\r\n    },\r\n    changeSort(e) {\r\n      this.searchForm.sort = e.key;\r\n      this.searchForm.order = e.order;\r\n      if (e.order == \"normal\") {\r\n        this.searchForm.order = \"\";\r\n      }\r\n      this.getDataList();\r\n    },\r\n    changeTableSize(v) {\r\n      this.tableSize = v;\r\n    },\r\n    exportData() {\r\n      this.$refs.table.exportCsv({\r\n        filename: \"数据\",\r\n      });\r\n    },\r\n    getDataList() {\r\n      this.loading = true;\r\n      getRoleList(this.searchForm).then((res) => {\r\n        this.loading = false;\r\n        if (res.success) {\r\n          this.data = res.result.content;\r\n          this.total = res.result.totalElements;\r\n          if (this.data.length == 0 && this.searchForm.pageNumber > 1) {\r\n            this.searchForm.pageNumber -= 1;\r\n            this.getDataList();\r\n          }\r\n        }\r\n      });\r\n    },\r\n    getPermList() {\r\n      this.treeLoading = true;\r\n      getAllPermissionList().then((res) => {\r\n        if (res.success) {\r\n          this.deleteDisableNode(res.result);\r\n          this.permData = res.result;\r\n          this.treeLoading = false;\r\n        }\r\n        this.treeLoading = false;\r\n      });\r\n    },\r\n    // 递归标记禁用节点\r\n    deleteDisableNode(permData) {\r\n      let that = this;\r\n      permData.forEach(function (e) {\r\n        if (e.status == -1) {\r\n          e.title = \"[已禁用] \" + e.title;\r\n          e.disabled = true;\r\n        }\r\n        if (e.children && e.children.length > 0) {\r\n          that.deleteDisableNode(e.children);\r\n        }\r\n      });\r\n    },\r\n    cancelRole() {\r\n      this.roleModalVisible = false;\r\n    },\r\n    submitRole() {\r\n      this.$refs.roleForm.validate((valid) => {\r\n        if (valid) {\r\n          if (this.modalType == 0) {\r\n            // 添加\r\n            this.submitLoading = true;\r\n            addRole(this.roleForm).then((res) => {\r\n              this.submitLoading = false;\r\n              if (res.success) {\r\n                this.$Message.success(\"操作成功\");\r\n                this.getDataList();\r\n                this.roleModalVisible = false;\r\n              }\r\n            });\r\n          } else {\r\n            this.submitLoading = true;\r\n            editRole(this.roleForm).then((res) => {\r\n              this.submitLoading = false;\r\n              if (res.success) {\r\n                this.$Message.success(\"操作成功\");\r\n                this.getDataList();\r\n                this.roleModalVisible = false;\r\n              }\r\n            });\r\n          }\r\n        }\r\n      });\r\n    },\r\n    addRole() {\r\n      this.modalType = 0;\r\n      this.modalTitle = \"添加角色\";\r\n      this.$refs.roleForm.resetFields();\r\n      delete this.roleForm.id;\r\n      this.roleModalVisible = true;\r\n    },\r\n    edit(v) {\r\n      this.modalType = 1;\r\n      this.modalTitle = \"编辑角色\";\r\n      this.$refs.roleForm.resetFields();\r\n      // 转换null为\"\"\r\n      for (let attr in v) {\r\n        if (v[attr] == null) {\r\n          v[attr] = \"\";\r\n        }\r\n      }\r\n      let str = JSON.stringify(v);\r\n      let roleInfo = JSON.parse(str);\r\n      this.roleForm = roleInfo;\r\n      this.roleModalVisible = true;\r\n    },\r\n    remove(v) {\r\n      this.$Modal.confirm({\r\n        title: \"确认删除\",\r\n        content: \"您确认要删除角色 \" + v.name + \" ?\",\r\n        loading: true,\r\n        onOk: () => {\r\n          deleteRole({ ids: v.id }).then((res) => {\r\n            this.$Modal.remove();\r\n            if (res.success) {\r\n              this.clearSelectAll();\r\n              this.$Message.success(\"删除成功\");\r\n              this.getDataList();\r\n            }\r\n          });\r\n        },\r\n      });\r\n    },\r\n    setDefault(v) {\r\n      this.loading = true;\r\n      let params = {\r\n        id: v.id,\r\n        isDefault: true,\r\n      };\r\n      setDefaultRole(params).then((res) => {\r\n        this.loading = false;\r\n        if (res.success) {\r\n          this.$Message.success(\"操作成功\");\r\n          this.getDataList();\r\n        }\r\n      });\r\n    },\r\n    cancelDefault(v) {\r\n      this.loading = true;\r\n      let params = {\r\n        id: v.id,\r\n        isDefault: false,\r\n      };\r\n      setDefaultRole(params).then((res) => {\r\n        this.loading = false;\r\n        if (res.success) {\r\n          this.$Message.success(\"操作成功\");\r\n          this.getDataList();\r\n        }\r\n      });\r\n    },\r\n    clearSelectAll() {\r\n      this.$refs.table.selectAll(false);\r\n    },\r\n    changeSelect(e) {\r\n      this.selectList = e;\r\n    },\r\n    delAll() {\r\n      if (this.selectList.length <= 0) {\r\n        this.$Message.warning(\"您还未选择要删除的数据\");\r\n        return;\r\n      }\r\n      this.$Modal.confirm({\r\n        title: \"确认删除\",\r\n        content: \"您确认要删除所选的 \" + this.selectList.length + \" 条数据?\",\r\n        loading: true,\r\n        onOk: () => {\r\n          let ids = \"\";\r\n          this.selectList.forEach(function (e) {\r\n            ids += e.id + \",\";\r\n          });\r\n          ids = ids.substring(0, ids.length - 1);\r\n          deleteRole({ ids: ids }).then((res) => {\r\n            this.$Modal.remove();\r\n            if (res.success) {\r\n              this.$Message.success(\"删除成功\");\r\n              this.clearSelectAll();\r\n              this.getDataList();\r\n            }\r\n          });\r\n        },\r\n      });\r\n    },\r\n    editPerm(v) {\r\n      this.editRolePermId = v.id;\r\n      this.modalTitle = \"分配 \" + v.name + \" 的菜单权限\";\r\n      // 匹配勾选\r\n      let rolePerms = v.permissions;\r\n      if (this.treeLoading) {\r\n        this.$Message.warning(\"菜单权限数据加载中，请稍后点击查看\");\r\n        return;\r\n      }\r\n      // 递归判断子节点\r\n      this.checkPermTree(this.permData, rolePerms);\r\n      this.permModalVisible = true;\r\n    },\r\n    // 递归判断子节点\r\n    checkPermTree(permData, rolePerms) {\r\n      let that = this;\r\n      permData.forEach(function (p) {\r\n        if (that.hasPerm(p, rolePerms) && p.status != -1) {\r\n          p.checked = true;\r\n        } else {\r\n          p.checked = false;\r\n        }\r\n        if (p.children && p.children.length > 0) {\r\n          that.checkPermTree(p.children, rolePerms);\r\n        }\r\n      });\r\n    },\r\n    // 判断角色拥有的权限节点勾选\r\n    hasPerm(p, rolePerms) {\r\n      let flag = false;\r\n      for (let i = 0; i < rolePerms.length; i++) {\r\n        if (p.id == rolePerms[i].permissionId) {\r\n          flag = true;\r\n          break;\r\n        }\r\n      }\r\n      if (flag) {\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    // 全选反选\r\n    selectTreeAll() {\r\n      this.selectAllFlag = !this.selectAllFlag;\r\n      let select = this.selectAllFlag;\r\n      this.selectedTreeAll(this.permData, select);\r\n    },\r\n    // 递归全选节点\r\n    selectedTreeAll(permData, select) {\r\n      let that = this;\r\n      permData.forEach(function (e) {\r\n        e.checked = select;\r\n        if (e.children && e.children.length > 0) {\r\n          that.selectedTreeAll(e.children, select);\r\n        }\r\n      });\r\n    },\r\n    submitPermEdit() {\r\n      this.submitPermLoading = true;\r\n      let permIds = \"\";\r\n      let selectedNodes = this.$refs.tree.getCheckedNodes();\r\n      selectedNodes.forEach(function (e) {\r\n        permIds += e.id + \",\";\r\n      });\r\n      permIds = permIds.substring(0, permIds.length - 1);\r\n      editRolePerm({\r\n        roleId: this.editRolePermId,\r\n        permIds: permIds,\r\n      }).then((res) => {\r\n        this.submitPermLoading = false;\r\n        if (res.success) {\r\n          this.$Message.success(\"操作成功\");\r\n          // 标记重新获取菜单数据\r\n          this.$store.commit(\"setAdded\", false);\r\n          util.initRouter(this);\r\n          this.getDataList();\r\n          this.permModalVisible = false;\r\n        }\r\n      });\r\n    },\r\n    cancelPermEdit() {\r\n      this.permModalVisible = false;\r\n    },\r\n    loadData(item, callback) {\r\n      loadDepartment(item.id, { openDataFilter: false }).then((res) => {\r\n        if (res.success) {\r\n          res.result.forEach(function (e) {\r\n            e.selected = false;\r\n            if (e.isParent) {\r\n              e.loading = false;\r\n              e.children = [];\r\n            }\r\n            if (e.status == -1) {\r\n              e.title = \"[已禁用] \" + e.title;\r\n              e.disabled = true;\r\n            }\r\n          });\r\n          callback(res.result);\r\n        }\r\n      });\r\n    },\r\n    editDep(v) {\r\n      this.dataType = 0;\r\n      this.editRolePermId = v.id;\r\n      this.modalTitle = \"分配 \" + v.name + \" 的数据权限\";\r\n      if (v.dataType) {\r\n        this.dataType = v.dataType;\r\n      }\r\n      // 匹配勾选\r\n      let roleDepIds = v.departments;\r\n      this.editDepartments = roleDepIds;\r\n      this.depTreeLoading = true;\r\n      initDepartment({ openDataFilter: false }).then((res) => {\r\n        this.depTreeLoading = false;\r\n        if (res.success) {\r\n          res.result.forEach(function (e) {\r\n            e.selected = false;\r\n            if (e.isParent) {\r\n              e.loading = false;\r\n              e.children = [];\r\n            }\r\n            if (e.status == -1) {\r\n              e.title = \"[已禁用] \" + e.title;\r\n              e.disabled = true;\r\n            }\r\n          });\r\n          this.depData = res.result;\r\n          // 判断子节点\r\n          this.checkDepTree(this.depData, roleDepIds);\r\n        }\r\n      });\r\n      this.depModalVisible = true;\r\n    },\r\n    expandCheckDep(v) {\r\n      // 判断展开子节点\r\n      this.checkDepTree(v.children, this.editDepartments);\r\n    },\r\n    // 判断子节点\r\n    checkDepTree(depData, roleDepIds) {\r\n      let that = this;\r\n      depData.forEach(function (p) {\r\n        if (that.hasDepPerm(p, roleDepIds)) {\r\n          p.selected = true;\r\n        } else {\r\n          p.selected = false;\r\n        }\r\n      });\r\n    },\r\n    // 判断角色拥有的权限节点勾选\r\n    hasDepPerm(p, roleDepIds) {\r\n      let flag = false;\r\n      for (let i = 0; i < roleDepIds.length; i++) {\r\n        if (p.id == roleDepIds[i].departmentId) {\r\n          flag = true;\r\n          break;\r\n        }\r\n      }\r\n      if (flag) {\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n    submitDepEdit() {\r\n      let depIds = \"\";\r\n      if (this.dataType == 1) {\r\n        let selectedNodes = this.$refs.depTree.getSelectedNodes();\r\n        selectedNodes.forEach(function (e) {\r\n          depIds += e.id + \",\";\r\n        });\r\n        depIds = depIds.substring(0, depIds.length - 1);\r\n      }\r\n      this.submitDepLoading = true;\r\n      editRoleDep({\r\n        roleId: this.editRolePermId,\r\n        dataType: this.dataType,\r\n        depIds: depIds,\r\n      }).then((res) => {\r\n        this.submitDepLoading = false;\r\n        if (res.success) {\r\n          this.$Message.success(\"操作成功\");\r\n          this.getDataList();\r\n          this.depModalVisible = false;\r\n        }\r\n      });\r\n    },\r\n    changeOpen(v) {\r\n      if (v == \"0\") {\r\n        this.permData.forEach((e) => {\r\n          e.expand = true;\r\n          if (e.children && e.children.length > 0) {\r\n            e.children.forEach((c) => {\r\n              c.expand = true;\r\n              if (c.children && c.children.length > 0) {\r\n                c.children.forEach(function (b) {\r\n                  b.expand = true;\r\n                });\r\n              }\r\n            });\r\n          }\r\n        });\r\n      } else if (v == \"1\") {\r\n        this.permData.forEach((e) => {\r\n          e.expand = false;\r\n          if (e.children && e.children.length > 0) {\r\n            e.children.forEach((c) => {\r\n              c.expand = false;\r\n              if (c.children && c.children.length > 0) {\r\n                c.children.forEach(function (b) {\r\n                  b.expand = false;\r\n                });\r\n              }\r\n            });\r\n          }\r\n        });\r\n      } else if (v == \"2\") {\r\n        this.permData.forEach((e) => {\r\n          e.expand = true;\r\n          if (e.children && e.children.length > 0) {\r\n            e.children.forEach((c) => {\r\n              c.expand = false;\r\n              if (c.children && c.children.length > 0) {\r\n                c.children.forEach(function (b) {\r\n                  b.expand = false;\r\n                });\r\n              }\r\n            });\r\n          }\r\n        });\r\n      } else if (v == \"3\") {\r\n        this.permData.forEach((e) => {\r\n          e.expand = true;\r\n          if (e.children && e.children.length > 0) {\r\n            e.children.forEach((c) => {\r\n              c.expand = true;\r\n              if (c.children && c.children.length > 0) {\r\n                c.children.forEach(function (b) {\r\n                  b.expand = false;\r\n                });\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.maxHeight = Number(document.documentElement.clientHeight - 121) + \"px\";\r\n    this.init();\r\n  },\r\n};\r\n</script>"]}]}