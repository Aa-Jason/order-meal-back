{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\Main.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\Main.vue","mtime":1651629755122},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1651770028580},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1651770027142},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\postcss-loader\\src\\index.js","mtime":1651770027415},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":1651770042155},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICIuL21haW4ubGVzcyI7DQo="},{"version":3,"sources":["Main.vue"],"names":[],"mappings":";AACA","file":"Main.vue","sourceRoot":"src/views","sourcesContent":["<style lang=\"less\">\r\n@import \"./main.less\";\r\n</style>\r\n\r\n<template>\r\n  <div class=\"main\" :class=\"{ 'main-hide-text': shrink }\">\r\n    <!-- 左侧菜单 -->\r\n    <div\r\n      :class=\"`sidebar-menu-content side-bar-menu-theme-${menuTheme}`\"\r\n      :style=\"{\r\n        width: shrink ? '60px' : menuWidth + 'px',\r\n        overflow: shrink ? 'visible' : 'auto',\r\n      }\"\r\n    >\r\n      <shrinkable-menu\r\n        :shrink=\"shrink\"\r\n        @on-change=\"handleSubmenuChange\"\r\n        :theme=\"menuTheme\"\r\n        :before-push=\"beforePush\"\r\n        :menu-list=\"menuList\"\r\n      >\r\n        <div slot=\"top\" class=\"logo-content\" v-if=\"showLogo || fixNav\">\r\n          <img\r\n            v-show=\"\r\n              !shrink && (menuTheme != 'light' || mainTheme == 'darkMode')\r\n            \"\r\n            src=\"@/assets/logo-white.png\"\r\n          />\r\n          <img\r\n            v-show=\"!shrink && menuTheme == 'light' && mainTheme != 'darkMode'\"\r\n            src=\"@/assets/logo-black.png\"\r\n          />\r\n          <img v-show=\"shrink\" src=\"@/assets/logo-min.png\" key=\"min-logo\" />\r\n        </div>\r\n      </shrinkable-menu>\r\n    </div>\r\n    <!-- 右上顶部导航条 -->\r\n    <div\r\n      :class=\"`main-header-content fix-nav-${fixNav}`\"\r\n      :style=\"{\r\n        paddingLeft: navPaddingLeft,\r\n      }\"\r\n    >\r\n      <div :class=\"`main-header header-theme-${navTheme}`\">\r\n        <div class=\"header-left\">\r\n          <!-- 固定图标 -->\r\n          <div v-if=\"fixNav && showLogo\" style=\"width: 220px\" class=\"fix-logo\">\r\n            <img\r\n              src=\"@/assets/logo-black.png\"\r\n              v-if=\"navTheme == 'light' && mainTheme != 'darkMode'\"\r\n            />\r\n            <img src=\"@/assets/logo-white.png\" key=\"max-logo\" v-else />\r\n          </div>\r\n          <!-- 收缩图标 -->\r\n          <div\r\n            class=\"header-navicon-content header-action\"\r\n            @click=\"toggleClick\"\r\n            v-if=\"showFold\"\r\n          >\r\n            <Icon\r\n              custom=\"iconfont icon-menu-unfold\"\r\n              size=\"20\"\r\n              v-show=\"this.shrink\"\r\n            />\r\n            <Icon\r\n              custom=\"iconfont icon-menu-fold\"\r\n              size=\"20\"\r\n              v-show=\"!this.shrink\"\r\n            />\r\n          </div>\r\n          <div class=\"header-middle-content\">\r\n            <!-- 顶部菜单 -->\r\n            <div v-if=\"navType == 1\">\r\n              <navMenu\r\n                :theme=\"navTheme\"\r\n                :currNav=\"currNav\"\r\n                :navList=\"navList\"\r\n                @on-click=\"selectNav\"\r\n                :sliceNum=\"currSliceNum\"\r\n                :showIcon=\"showNavMenuIcon\"\r\n              />\r\n            </div>\r\n            <!-- 下拉菜单 -->\r\n            <div v-if=\"navType == 2\">\r\n              <navApp\r\n                currType=\"tabs\"\r\n                placement=\"bottom-start\"\r\n                :currNavTitle=\"currNavTitle\"\r\n                :currNav=\"currNav\"\r\n                :navList=\"navList\"\r\n                :type=\"navShowType\"\r\n                :theme=\"navTheme\"\r\n                @on-click=\"selectNav\"\r\n              />\r\n            </div>\r\n            <!-- 面包导航 -->\r\n            <div class=\"main-breadcrumb\" v-if=\"navType == 3\">\r\n              <breadcrumb-nav :theme=\"navTheme\" :currentPath=\"currentPath\" />\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!-- 顶部右侧按钮 -->\r\n        <div class=\"header-right-content\">\r\n          <search :theme=\"navTheme\" :type=\"searchType\" v-if=\"showSearch\" />\r\n          <navApp\r\n            :currNav=\"currNav\"\r\n            :navList=\"navList\"\r\n            :type=\"navShowType\"\r\n            @on-click=\"selectNav\"\r\n            v-if=\"navType == 3\"\r\n          />\r\n          <full-screen v-model=\"isFullScreen\" @on-change=\"fullscreenChange\" />\r\n          <language />\r\n          <message-tip />\r\n          <user />\r\n          <theme />\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <!-- Tags 标签 -->\r\n    <div\r\n      class=\"nav-tags\"\r\n      :style=\"{\r\n        paddingLeft: shrink ? '60px' : menuWidth + 'px',\r\n      }\"\r\n    >\r\n      <tags-page-opened :pageTagsList=\"pageTagsList\" v-if=\"showTags\" />\r\n    </div>\r\n    <!-- 页面部分 -->\r\n    <div\r\n      class=\"single-page-content\"\r\n      :style=\"{\r\n        left: shrink ? '60px' : menuWidth + 'px',\r\n        top: showTags ? '100px' : '60px',\r\n      }\"\r\n    >\r\n      <div class=\"single-page\">\r\n        <keep-alive :include=\"cachePage\">\r\n          <router-view />\r\n        </keep-alive>\r\n      </div>\r\n      <!-- 页面页脚 -->\r\n      <div class=\"main-page-footer-content\" v-if=\"showFooter\">\r\n        <Footer class=\"main-page-footer\" />\r\n      </div>\r\n    </div>\r\n    <!-- 全局加载动画 -->\r\n    <circleLoading class=\"loading-position\" v-show=\"loading\" />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport shrinkableMenu from \"./main-components/shrinkable-menu/shrinkable-menu.vue\";\r\nimport tagsPageOpened from \"./main-components/tags-page-opened.vue\";\r\nimport breadcrumbNav from \"./main-components/breadcrumb-nav.vue\";\r\nimport navMenu from \"./main-components/navMenu.vue\";\r\nimport navApp from \"./main-components/navApp.vue\";\r\nimport search from \"./main-components/search.vue\";\r\nimport fullScreen from \"./main-components/fullscreen.vue\";\r\nimport language from \"./main-components/language.vue\";\r\nimport messageTip from \"./main-components/message-tip.vue\";\r\nimport user from \"./main-components/user.vue\";\r\nimport Footer from \"./main-components/footer.vue\";\r\nimport theme from \"./main-components/theme.vue\";\r\nimport circleLoading from \"@/views/my-components/xboot/circle-loading.vue\";\r\nimport watermark from \"watermark-dom\";\r\n\r\nimport util from \"@/libs/util.js\";\r\n\r\nexport default {\r\n  components: {\r\n    shrinkableMenu,\r\n    tagsPageOpened,\r\n    breadcrumbNav,\r\n    navMenu,\r\n    navApp,\r\n    search,\r\n    fullScreen,\r\n    language,\r\n    messageTip,\r\n    user,\r\n    Footer,\r\n    theme,\r\n    circleLoading,\r\n  },\r\n  data() {\r\n    return {\r\n      navPaddingLeft: this.menuWidth,\r\n      searchType: \"input\",\r\n      shrink: false,\r\n      currSliceNum: this.sliceNum,\r\n      currNav: \"\",\r\n      isFullScreen: false,\r\n    };\r\n  },\r\n  computed: {\r\n    // 主题\r\n    mainTheme() {\r\n      return this.$store.state.theme.theme.mainTheme;\r\n    },\r\n    menuTheme() {\r\n      return this.$store.state.theme.theme.menuTheme;\r\n    },\r\n    navTheme() {\r\n      return this.$store.state.theme.theme.navTheme;\r\n    },\r\n    menuWidth() {\r\n      return this.$store.state.theme.theme.menuWidth;\r\n    },\r\n    fixNav() {\r\n      return this.$store.state.theme.theme.fixNav;\r\n    },\r\n    navType() {\r\n      return this.$store.state.theme.theme.navType;\r\n    },\r\n    sliceNum() {\r\n      return this.$store.state.theme.theme.sliceNum;\r\n    },\r\n    showTags() {\r\n      return this.$store.state.theme.theme.showTags;\r\n    },\r\n    showNavMenuIcon() {\r\n      return this.$store.state.theme.theme.showNavMenuIcon;\r\n    },\r\n    navShowType() {\r\n      return this.$store.state.theme.theme.navShowType;\r\n    },\r\n    showFold() {\r\n      return this.$store.state.theme.theme.showFold;\r\n    },\r\n    showLogo() {\r\n      return this.$store.state.theme.theme.showLogo;\r\n    },\r\n    showSearch() {\r\n      return this.$store.state.theme.theme.showSearch;\r\n    },\r\n    showFooter() {\r\n      return this.$store.state.theme.theme.showFooter;\r\n    },\r\n    weakMode() {\r\n      return this.$store.state.theme.theme.weakMode;\r\n    },\r\n    // 应用\r\n    loading() {\r\n      return this.$store.state.app.loading;\r\n    },\r\n    navList() {\r\n      return this.$store.state.app.navList;\r\n    },\r\n    currNavTitle() {\r\n      return this.$store.state.app.currNavTitle;\r\n    },\r\n    menuList() {\r\n      return this.$store.state.app.menuList;\r\n    },\r\n    pageTagsList() {\r\n      return this.$store.state.app.pageOpenedList; // 打开的页面的页面对象\r\n    },\r\n    currentPath() {\r\n      return this.$store.state.app.currentPath; // 当前面包屑数组\r\n    },\r\n    cachePage() {\r\n      return this.$store.state.app.cachePage;\r\n    },\r\n    lang() {\r\n      return this.$store.state.app.lang;\r\n    },\r\n    watermarkConfig() {\r\n      return this.$store.state.theme.theme.watermarkConfig;\r\n    },\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.changeFixNav();\r\n      // 水印\r\n      this.initWatermark();\r\n      // 菜单\r\n      let pathArr = util.setCurrentPath(this, this.$route.name);\r\n      this.checkTag(this.$route.name);\r\n    },\r\n    getCurrNav() {\r\n      // 读取选中顶部菜单名\r\n      let currNav = this.getStore(\"currNav\");\r\n      if (currNav) {\r\n        this.currNav = currNav;\r\n      } else {\r\n        // 默认第一个\r\n        if (this.navList && this.navList.length > 0) {\r\n          this.currNav = this.navList[0].name;\r\n        }\r\n      }\r\n    },\r\n    selectNav(name) {\r\n      let flag = false;\r\n      this.navList.forEach((e) => {\r\n        if (e.name == name && e.isMenu == false) {\r\n          flag = true;\r\n          if (e.description == \"direct\") {\r\n            window.location.href = e.url;\r\n          } else if (e.description == \"window\") {\r\n            window.open(e.url);\r\n          } else if (e.description == \"route\") {\r\n            this.$router.push({\r\n              name: e.url,\r\n            });\r\n          }\r\n        }\r\n      });\r\n      if (flag) {\r\n        // 第三方站外链接 不作其他操作\r\n        return;\r\n      }\r\n      // 缓存当前顶部菜单名\r\n      this.currNav = name;\r\n      this.setStore(\"currNav\", name);\r\n      this.$store.commit(\"setCurrNav\", name);\r\n      // 点击顶部菜单 回到首页\r\n      if (this.$route.name != \"home_index\") {\r\n        this.$router.push({\r\n          name: \"home_index\",\r\n        });\r\n      }\r\n      util.initRouter(this);\r\n    },\r\n    toggleClick() {\r\n      this.shrink = !this.shrink;\r\n      this.changeFixNav();\r\n    },\r\n    changeFixNav() {\r\n      if (this.fixNav) {\r\n        this.navPaddingLeft = \"0px\";\r\n      } else {\r\n        this.navPaddingLeft = this.shrink ? \"60px\" : this.menuWidth + \"px\";\r\n      }\r\n    },\r\n    checkTag(name) {\r\n      let openpageHasTag = this.pageTagsList.some((item) => {\r\n        if (item.name == name) {\r\n          return true;\r\n        }\r\n      });\r\n      if (!openpageHasTag) {\r\n        //  解决关闭当前标签后再点击回退按钮会退到当前页时没有标签的问题\r\n        util.openNewPage(\r\n          this,\r\n          name,\r\n          this.$route.params || {},\r\n          this.$route.query || {}\r\n        );\r\n      }\r\n    },\r\n    handleSubmenuChange(val) {\r\n      // console.log(val)\r\n    },\r\n    beforePush(name) {\r\n      // console.log(name)\r\n      return true;\r\n    },\r\n    fullscreenChange(isFullScreen) {\r\n      // console.log(isFullScreen);\r\n    },\r\n    resize() {\r\n      let currWidth = document.body.clientWidth;\r\n\r\n      if (currWidth <= 1400 && currWidth > 1200) {\r\n        this.currSliceNum = 3;\r\n      } else if (currWidth <= 1200 && currWidth > 900) {\r\n        this.currSliceNum = 2;\r\n        this.shrink = true;\r\n      } else if (currWidth <= 900) {\r\n        this.currSliceNum = 1;\r\n        this.shrink = true;\r\n      } else {\r\n        this.currSliceNum = this.sliceNum;\r\n        this.shrink = false;\r\n      }\r\n\r\n      if (currWidth < 1325 && currWidth > 1200) {\r\n        this.searchType = \"icon\";\r\n      } else if (currWidth < 1000 && currWidth > 900) {\r\n        this.searchType = \"icon\";\r\n      } else if (currWidth < 835) {\r\n        this.searchType = \"icon\";\r\n      } else {\r\n        this.searchType = \"input\";\r\n      }\r\n      this.changeFixNav();\r\n    },\r\n    initWatermark() {\r\n      let str = JSON.stringify(this.watermarkConfig);\r\n      let config = JSON.parse(str);\r\n      if (config && config.open) {\r\n        let type = config.type,\r\n          user = this.getUserInfo();\r\n        if (type == 0) {\r\n          if (user) {\r\n            config.watermark_txt = user.username;\r\n          }\r\n        } else if (type == 1) {\r\n          if (user) {\r\n            config.watermark_txt = user.mobile;\r\n          }\r\n        } else {\r\n          config.watermark_txt = config.custom_txt;\r\n        }\r\n        config.watermark_fontsize += \"px\";\r\n        if (config.watermark_txt) {\r\n          watermark.load(config);\r\n        }\r\n      }\r\n    },\r\n  },\r\n  watch: {\r\n    $route(to, from) {\r\n      this.$store.commit(\"setCurrentPageName\", to.name);\r\n      let pathArr = util.setCurrentPath(this, to.name);\r\n      this.checkTag(to.name);\r\n    },\r\n    lang() {\r\n      // 切换语言时刷新面包屑\r\n      util.setCurrentPath(this, this.$route.name);\r\n      // 切换语言时更新下拉菜单语言\r\n      for (let item of this.navList) {\r\n        if (item.name == this.currNav) {\r\n          this.$store.commit(\"setCurrNavTitle\", util.handleTitle(this, item));\r\n          break;\r\n        }\r\n      }\r\n    },\r\n    fixNav() {\r\n      this.changeFixNav();\r\n    },\r\n    menuWidth() {\r\n      this.changeFixNav();\r\n    },\r\n    navList() {\r\n      setTimeout(() => {\r\n        this.getCurrNav();\r\n      }, 100);\r\n    },\r\n    sliceNum() {\r\n      this.resize();\r\n    },\r\n  },\r\n  created() {\r\n    // 显示打开的页面的列表\r\n    this.$store.commit(\"setOpenedList\");\r\n    this.init();\r\n    this.resize();\r\n    window.addEventListener(\"resize\", () => {\r\n      this.resize();\r\n    });\r\n    if (this.navList && this.navList.length > 0) {\r\n      this.getCurrNav();\r\n    }\r\n  },\r\n};\r\n</script>\r\n"]}]}