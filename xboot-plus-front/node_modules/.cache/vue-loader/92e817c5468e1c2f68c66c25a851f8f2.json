{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\xboot-vue-template\\excel\\excel.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\xboot-vue-template\\excel\\excel.vue","mtime":1651629755324},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1651770037115},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyDmqKHniYjlr7zlhaXmlofku7booajmlbDmja4NCmltcG9ydCB7IHVzZXJDb2x1bW5zLCB1c2VyRGF0YSB9IGZyb20gIkAvdmlld3Mvc3lzL3VzZXItbWFuYWdlL2ltcG9ydFRlbXBsYXRlIjsNCi8vIGV4Y2Vs6L2s5o2i5bel5YW357G7DQppbXBvcnQgZXhjZWwgZnJvbSAiQC9saWJzL2V4Y2VsIjsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogImV4Y2VsIiwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgb3BlblRpcDogdHJ1ZSwgLy8g5pi+56S65o+Q56S6DQogICAgICByZWFkaW5nOiBmYWxzZSwgLy8g6K+75Y+W5LitDQogICAgICBoZWlnaHQ6IDUxMCwgLy8g6auY5bqmDQogICAgICBsb2FkaW5nOiB0cnVlLCAvLyDooajljZXliqDovb3nirbmgIENCiAgICAgIGltcG9ydExvYWRpbmc6IGZhbHNlLCAvLyDlr7zlhaXliqDovb3nirbmgIENCiAgICAgIGxvYWRpbmdFeHBvcnQ6IHRydWUsIC8vIOWvvOWHuuWKoOi9veeKtuaAgQ0KICAgICAgZXhwb3J0TW9kYWxWaXNpYmxlOiBmYWxzZSwgLy8g6Ieq5a6a5LmJ5a+85Ye65pi+56S6DQogICAgICBpbXBvcnRNb2RhbFZpc2libGU6IGZhbHNlLCAvLyDlr7zlhaXmmL7npLoNCiAgICAgIHNlbGVjdExpc3Q6IFtdLCAvLyDlpJrpgInmlbDmja4NCiAgICAgIHNlYXJjaEZvcm06IHsNCiAgICAgICAgcGFnZU51bWJlcjogMSwNCiAgICAgICAgcGFnZVNpemU6IDEwLA0KICAgICAgICBzb3J0OiAiY3JlYXRlVGltZSIsDQogICAgICAgIG9yZGVyOiAiZGVzYyIsDQogICAgICB9LA0KICAgICAgY29sdW1uczogWw0KICAgICAgICAvLyDooajlpLQNCiAgICAgICAgew0KICAgICAgICAgIHR5cGU6ICJzZWxlY3Rpb24iLA0KICAgICAgICAgIHdpZHRoOiA2MCwNCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0eXBlOiAiaW5kZXgiLA0KICAgICAgICAgIHdpZHRoOiA2MCwNCiAgICAgICAgICBhbGlnbjogImNlbnRlciIsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0aXRsZTogIuWQjeensCIsDQogICAgICAgICAga2V5OiAibmFtZSIsDQogICAgICAgICAgc29ydGFibGU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0aXRsZTogIuaJi+acuiIsDQogICAgICAgICAga2V5OiAibW9iaWxlIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHRpdGxlOiAi5Yib5bu65pe26Ze0IiwNCiAgICAgICAgICBrZXk6ICJjcmVhdGVUaW1lIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSwNCiAgICAgICAgICBzb3J0VHlwZTogImRlc2MiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGl0bGU6ICLmm7TmlrDml7bpl7QiLA0KICAgICAgICAgIGtleTogInVwZGF0ZVRpbWUiLA0KICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGl0bGU6ICLmk43kvZwiLA0KICAgICAgICAgIGtleTogImFjdGlvbiIsDQogICAgICAgICAgYWxpZ246ICJjZW50ZXIiLA0KICAgICAgICAgIHdpZHRoOiAyMDAsDQogICAgICAgICAgcmVuZGVyOiAoaCwgcGFyYW1zKSA9PiB7DQogICAgICAgICAgICByZXR1cm4gaCgiZGl2IiwgWw0KICAgICAgICAgICAgICBoKA0KICAgICAgICAgICAgICAgICJhIiwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICBvbjogew0KICAgICAgICAgICAgICAgICAgICBjbGljazogKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJE1lc3NhZ2UuaW5mbygi54K55Ye75LqG57yW6L6RIik7DQogICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgIue8lui+kSINCiAgICAgICAgICAgICAgKSwNCiAgICAgICAgICAgICAgaCgiRGl2aWRlciIsIHsNCiAgICAgICAgICAgICAgICBwcm9wczogew0KICAgICAgICAgICAgICAgICAgdHlwZTogInZlcnRpY2FsIiwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICB9KSwNCiAgICAgICAgICAgICAgaCgNCiAgICAgICAgICAgICAgICAiYSIsDQogICAgICAgICAgICAgICAgew0KICAgICAgICAgICAgICAgICAgb246IHsNCiAgICAgICAgICAgICAgICAgICAgY2xpY2s6ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRNZXNzYWdlLmluZm8oIueCueWHu+S6huWIoOmZpCIpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICLliKDpmaQiDQogICAgICAgICAgICAgICksDQogICAgICAgICAgICBdKTsNCiAgICAgICAgICB9LA0KICAgICAgICB9LA0KICAgICAgXSwNCiAgICAgIGV4cG9ydENvbHVtbnM6IFsNCiAgICAgICAgLy8g5a+85Ye65YiXDQogICAgICAgIHsNCiAgICAgICAgICB0aXRsZTogIuWQjeensCIsDQogICAgICAgICAga2V5OiAibmFtZSIsDQogICAgICAgICAgc29ydGFibGU6IHRydWUsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0aXRsZTogIuaJi+acuiIsDQogICAgICAgICAga2V5OiAibW9iaWxlIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHRpdGxlOiAi5Yib5bu65pe26Ze0IiwNCiAgICAgICAgICBrZXk6ICJjcmVhdGVUaW1lIiwNCiAgICAgICAgICBzb3J0YWJsZTogdHJ1ZSwNCiAgICAgICAgICBzb3J0VHlwZTogImRlc2MiLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdGl0bGU6ICLmm7TmlrDml7bpl7QiLA0KICAgICAgICAgIGtleTogInVwZGF0ZVRpbWUiLA0KICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLA0KICAgICAgICB9LA0KICAgICAgXSwNCiAgICAgIGNob29zZUNvbHVtbnM6IFtdLA0KICAgICAgZmlsZW5hbWU6ICLmlbDmja4iLA0KICAgICAgZXhwb3J0VGl0bGU6ICLnoa7orqTlr7zlh7oiLA0KICAgICAgZXhwb3J0VHlwZTogIiIsDQogICAgICBpbXBvcnRUYWJsZURhdGE6IFtdLA0KICAgICAgaW1wb3J0Q29sdW1uczogW10sDQogICAgICB1cGxvYWRmaWxlOiB7DQogICAgICAgIG5hbWU6ICIiLA0KICAgICAgfSwNCiAgICAgIHRlbXBDb2x1bW5zOiB1c2VyQ29sdW1ucywNCiAgICAgIHRlbXBEYXRhOiB1c2VyRGF0YSwNCiAgICAgIGRhdGE6IFtdLA0KICAgICAgZXhwb3J0RGF0YTogW10sDQogICAgICB0b3RhbDogMCwNCiAgICB9Ow0KICB9LA0KICBtZXRob2RzOiB7DQogICAgaW5pdCgpIHsNCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsNCiAgICAgIC8vIOWIneWni+WMluWvvOWHuuWIl+aVsOaNrg0KICAgICAgbGV0IGFycmF5ID0gW107DQogICAgICB0aGlzLmV4cG9ydENvbHVtbnMuZm9yRWFjaCgoZSkgPT4gew0KICAgICAgICAvLyDmjIflrprliJfpmZDliLbmnYPpmZANCiAgICAgICAgaWYgKA0KICAgICAgICAgICF0aGlzLmdldFN0b3JlKCJyb2xlcyIpLmluY2x1ZGVzKCJST0xFX0FETUlOIikgJiYNCiAgICAgICAgICBlLmtleSA9PSAibW9iaWxlIg0KICAgICAgICApIHsNCiAgICAgICAgICBlLnRpdGxlID0gIlvml6DmnYPlr7zlh7pdICIgKyBlLnRpdGxlOw0KICAgICAgICAgIGUuZGlzYWJsZWQgPSB0cnVlOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIGUuZGlzYWJsZWQgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgICAgICBhcnJheS5wdXNoKGUudGl0bGUpOw0KICAgICAgfSk7DQogICAgICB0aGlzLmNob29zZUNvbHVtbnMgPSBhcnJheTsNCiAgICB9LA0KICAgIGNoYW5nZVBhZ2Uodikgew0KICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VOdW1iZXIgPSB2Ow0KICAgICAgdGhpcy5nZXREYXRhTGlzdCgpOw0KICAgICAgdGhpcy5jbGVhclNlbGVjdEFsbCgpOw0KICAgIH0sDQogICAgY2hhbmdlUGFnZVNpemUodikgew0KICAgICAgdGhpcy5zZWFyY2hGb3JtLnBhZ2VTaXplID0gdjsNCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsNCiAgICB9LA0KICAgIHNlbGVjdERhdGVSYW5nZSh2KSB7DQogICAgICBpZiAodikgew0KICAgICAgICB0aGlzLnNlYXJjaEZvcm0uc3RhcnREYXRlID0gdlswXTsNCiAgICAgICAgdGhpcy5zZWFyY2hGb3JtLmVuZERhdGUgPSB2WzFdOw0KICAgICAgfQ0KICAgIH0sDQogICAgZ2V0RGF0YUxpc3QoKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgbGV0IHBhcmFtcyA9IHsNCiAgICAgICAgcGFnZU51bWJlcjogdGhpcy5wYWdlTnVtYmVyLA0KICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZSwNCiAgICAgICAgc29ydDogdGhpcy5zb3J0Q29sdW1uLA0KICAgICAgICBvcmRlcjogdGhpcy5zb3J0VHlwZSwNCiAgICAgIH07DQogICAgICAvLyDor7fmsYLlkI7nq6/ojrflj5booajljZXmlbDmja4g6K+36Ieq6KGM5L+u5pS55o6l5Y+jDQogICAgICAvLyB0aGlzLmdldFJlcXVlc3QoIuivt+axgui3r+W+hCIsIHBhcmFtcykudGhlbihyZXMgPT4gew0KICAgICAgLy8gICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgIC8vICAgaWYgKHJlcy5zdWNjZXNzKSB7DQogICAgICAvLyAgICAgdGhpcy5kYXRhID0gcmVzLnJlc3VsdC5jb250ZW50Ow0KICAgICAgLy8gICAgIHRoaXMudG90YWwgPSByZXMucmVzdWx0LnRvdGFsRWxlbWVudHM7DQogICAgICAvLyAgIH0NCiAgICAgIC8vIH0pOw0KICAgICAgLy8g5Lul5LiL5Li65qih5ouf5pWw5o2uDQogICAgICB0aGlzLmRhdGEgPSBbDQogICAgICAgIHsNCiAgICAgICAgICBpZDogIjEiLA0KICAgICAgICAgIG5hbWU6ICJYQm9vdCIsDQogICAgICAgICAgbW9iaWxlOiAiMTIzNDU2Nzg5MDEiLA0KICAgICAgICAgIGNyZWF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIiwNCiAgICAgICAgICB1cGRhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIsDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBpZDogIjIiLA0KICAgICAgICAgIG5hbWU6ICJFeHJpY2siLA0KICAgICAgICAgIG1vYmlsZTogIjEyMzQ1Njc4OTAxIiwNCiAgICAgICAgICBjcmVhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIsDQogICAgICAgICAgdXBkYXRlVGltZTogIjIwMTgtMDgtMDggMDA6MDg6MDAiLA0KICAgICAgICB9LA0KICAgICAgXTsNCiAgICAgIHRoaXMudG90YWwgPSB0aGlzLmRhdGEubGVuZ3RoOw0KICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7DQogICAgfSwNCiAgICBoYW5kbGVTZWFyY2goKSB7DQogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZU51bWJlciA9IDE7DQogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZVNpemUgPSAxMDsNCiAgICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsNCiAgICB9LA0KICAgIGhhbmRsZVJlc2V0KCkgew0KICAgICAgdGhpcy4kcmVmcy5zZWFyY2hGb3JtLnJlc2V0RmllbGRzKCk7DQogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZU51bWJlciA9IDE7DQogICAgICB0aGlzLnNlYXJjaEZvcm0ucGFnZVNpemUgPSAxMDsNCiAgICAgIC8vIOmHjeaWsOWKoOi9veaVsOaNrg0KICAgICAgdGhpcy5nZXREYXRhTGlzdCgpOw0KICAgIH0sDQogICAgY2hhbmdlU29ydChlKSB7DQogICAgICB0aGlzLnNlYXJjaEZvcm0uc29ydCA9IGUua2V5Ow0KICAgICAgdGhpcy5zZWFyY2hGb3JtLm9yZGVyID0gZS5vcmRlcjsNCiAgICAgIGlmIChlLm9yZGVyID09ICJub3JtYWwiKSB7DQogICAgICAgIHRoaXMuc2VhcmNoRm9ybS5vcmRlciA9ICIiOw0KICAgICAgfQ0KICAgICAgdGhpcy5nZXREYXRhTGlzdCgpOw0KICAgIH0sDQogICAgZXhwb3J0U2VsZWN0RGF0YSgpIHsNCiAgICAgIGlmICh0aGlzLnNlbGVjdExpc3QubGVuZ3RoIDw9IDApIHsNCiAgICAgICAgdGhpcy4kTWVzc2FnZS53YXJuaW5nKCLmgqjov5jmnKrpgInmi6nopoHlr7zlh7rnmoTmlbDmja4iKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgdGhpcy5leHBvcnRUeXBlID0gInBhcnQiOw0KICAgICAgdGhpcy5leHBvcnRNb2RhbFZpc2libGUgPSB0cnVlOw0KICAgICAgdGhpcy5leHBvcnRUaXRsZSA9ICLnoa7orqTlr7zlh7ogIiArIHRoaXMuc2VsZWN0TGlzdC5sZW5ndGggKyAiIOadoeaVsOaNriI7DQogICAgfSwNCiAgICBleHBvcnRBbGwoKSB7DQogICAgICB0aGlzLmV4cG9ydFR5cGUgPSAiYWxsIjsNCiAgICAgIHRoaXMuZXhwb3J0TW9kYWxWaXNpYmxlID0gdHJ1ZTsNCiAgICAgIHRoaXMuZXhwb3J0VGl0bGUgPSAi56Gu6K6k5a+85Ye65YWo6YOoICIgKyB0aGlzLnRvdGFsICsgIiDmnaHmlbDmja4iOw0KICAgICAgLy8g6K+35rGC5ZCO56uv6I635Y+W5YWo6YOo5pWw5o2uIOivt+iHquihjOS/ruaUueaOpeWPow0KICAgICAgLy8gdGhpcy5nZXRSZXF1ZXN0KCLor7fmsYLot6/lvoQiLCBwYXJhbXMpLnRoZW4ocmVzID0+IHsNCiAgICAgIC8vICAgaWYgKHJlcy5zdWNjZXNzKSB7DQogICAgICAvLyAgICAgdGhpcy5leHBvcnREYXRhID0gcmVzLnJlc3VsdDsNCiAgICAgIC8vICAgfQ0KICAgICAgLy8gfSk7DQogICAgICAvLyDku6XkuIvkuLrmqKHmi5/mlbDmja4NCiAgICAgIHRoaXMuZXhwb3J0RGF0YSA9IFsNCiAgICAgICAgew0KICAgICAgICAgIGlkOiAiMSIsDQogICAgICAgICAgbmFtZTogIlhCb290IiwNCiAgICAgICAgICBtb2JpbGU6ICIxMjM0NTY3ODkwMSIsDQogICAgICAgICAgY3JlYXRlVGltZTogIjIwMTgtMDgtMDggMDA6MDg6MDAiLA0KICAgICAgICAgIHVwZGF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIiwNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGlkOiAiMiIsDQogICAgICAgICAgbmFtZTogIkV4cmljayIsDQogICAgICAgICAgbW9iaWxlOiAiMTIzNDU2Nzg5MDEiLA0KICAgICAgICAgIGNyZWF0ZVRpbWU6ICIyMDE4LTA4LTA4IDAwOjA4OjAwIiwNCiAgICAgICAgICB1cGRhdGVUaW1lOiAiMjAxOC0wOC0wOCAwMDowODowMCIsDQogICAgICAgIH0sDQogICAgICBdOw0KICAgIH0sDQogICAgZXhwb3J0Q3VzdG9tRGF0YSgpIHsNCiAgICAgIGlmICh0aGlzLmZpbGVuYW1lID09ICIiKSB7DQogICAgICAgIHRoaXMuZmlsZW5hbWUgPSAi55So5oi35pWw5o2uIjsNCiAgICAgIH0NCiAgICAgIC8vIOWIpOaWreWLvumAieWvvOWHuuWIlw0KICAgICAgbGV0IGV4cG9ydENvbHVtbnMgPSBbXTsNCiAgICAgIHRoaXMuZXhwb3J0Q29sdW1ucy5mb3JFYWNoKChlKSA9PiB7DQogICAgICAgIHRoaXMuY2hvb3NlQ29sdW1ucy5mb3JFYWNoKChjKSA9PiB7DQogICAgICAgICAgaWYgKGUudGl0bGUgPT0gYyAmJiAhZS5kaXNhYmxlZCkgew0KICAgICAgICAgICAgZXhwb3J0Q29sdW1ucy5wdXNoKGUpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICAgIHRoaXMuZXhwb3J0TW9kYWxWaXNpYmxlID0gZmFsc2U7DQogICAgICBsZXQgdGl0bGUgPSBbXTsNCiAgICAgIGxldCBrZXkgPSBbXTsNCiAgICAgIGV4cG9ydENvbHVtbnMuZm9yRWFjaCgoZSkgPT4gew0KICAgICAgICB0aXRsZS5wdXNoKGUudGl0bGUpOw0KICAgICAgICBrZXkucHVzaChlLmtleSk7DQogICAgICB9KTsNCiAgICAgIGNvbnN0IHBhcmFtcyA9IHsNCiAgICAgICAgdGl0bGU6IHRpdGxlLA0KICAgICAgICBrZXk6IGtleSwNCiAgICAgICAgZGF0YTogdGhpcy5leHBvcnREYXRhLA0KICAgICAgICBhdXRvV2lkdGg6IHRydWUsDQogICAgICAgIGZpbGVuYW1lOiB0aGlzLmZpbGVuYW1lLA0KICAgICAgfTsNCiAgICAgIGV4Y2VsLmV4cG9ydF9hcnJheV90b19leGNlbChwYXJhbXMpOw0KICAgIH0sDQogICAgYmVmb3JlVXBsb2FkSW1wb3J0KGZpbGUpIHsNCiAgICAgIHRoaXMudXBsb2FkZmlsZSA9IGZpbGU7DQogICAgICBjb25zdCBmaWxlRXh0ID0gZmlsZS5uYW1lLnNwbGl0KCIuIikucG9wKCkudG9Mb2NhbGVMb3dlckNhc2UoKTsNCiAgICAgIGlmIChmaWxlRXh0ID09ICJ4bHN4IiB8fCBmaWxlRXh0ID09ICJ4bHMiKSB7DQogICAgICAgIHRoaXMucmVhZEZpbGUoZmlsZSk7DQogICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLiROb3RpY2Uud2FybmluZyh7DQogICAgICAgICAgdGl0bGU6ICLmlofku7bnsbvlnovplJnor68iLA0KICAgICAgICAgIGRlc2M6DQogICAgICAgICAgICAi5omA6YCJ5paH5Lu24oCYICIgKw0KICAgICAgICAgICAgZmlsZS5uYW1lICsNCiAgICAgICAgICAgICIg4oCZ5LiN5pivRVhDRUzmlofku7bvvIzor7fpgInmi6nlkI7nvIDkuLoueGxzeOaIluiAhS54bHPnmoRFWENFTOaWh+S7tuOAgiIsDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0sDQogICAgLy8g6K+75Y+W5paH5Lu2DQogICAgcmVhZEZpbGUoZmlsZSkgew0KICAgICAgdGhpcy5yZWFkaW5nID0gdHJ1ZTsNCiAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7DQogICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7DQogICAgICByZWFkZXIub25lcnJvciA9IChlKSA9PiB7DQogICAgICAgIHRoaXMucmVhZGluZyA9IGZhbHNlOw0KICAgICAgICB0aGlzLiRNZXNzYWdlLmVycm9yKCLmlofku7bor7vlj5blh7rplJkiKTsNCiAgICAgIH07DQogICAgICByZWFkZXIub25sb2FkID0gKGUpID0+IHsNCiAgICAgICAgY29uc3QgZGF0YSA9IGUudGFyZ2V0LnJlc3VsdDsNCiAgICAgICAgY29uc3QgeyBoZWFkZXIsIHJlc3VsdHMgfSA9IGV4Y2VsLnJlYWQoZGF0YSwgImFycmF5Iik7DQogICAgICAgIGNvbnN0IHRhYmxlVGl0bGUgPSBoZWFkZXIubWFwKChpdGVtKSA9PiB7DQogICAgICAgICAgcmV0dXJuIHsgdGl0bGU6IGl0ZW0sIGtleTogaXRlbSwgbWluV2lkdGg6IDEzMCwgYWxpZ246ICJjZW50ZXIiIH07DQogICAgICAgIH0pOw0KICAgICAgICB0aGlzLmltcG9ydFRhYmxlRGF0YSA9IHJlc3VsdHM7DQogICAgICAgIHRoaXMuaW1wb3J0Q29sdW1ucyA9IHRhYmxlVGl0bGU7DQogICAgICAgIHRoaXMucmVhZGluZyA9IGZhbHNlOw0KICAgICAgICB0aGlzLiRNZXNzYWdlLnN1Y2Nlc3MoIuivu+WPluaVsOaNruaIkOWKnyIpOw0KICAgICAgfTsNCiAgICB9LA0KICAgIGRvd25sb2FkVGVtcGxlKCkgew0KICAgICAgbGV0IHRpdGxlID0gW107DQogICAgICBsZXQga2V5ID0gW107DQogICAgICB1c2VyQ29sdW1ucy5mb3JFYWNoKChlKSA9PiB7DQogICAgICAgIHRpdGxlLnB1c2goZS50aXRsZSk7DQogICAgICAgIGtleS5wdXNoKGUua2V5KTsNCiAgICAgIH0pOw0KICAgICAgY29uc3QgcGFyYW1zID0gew0KICAgICAgICB0aXRsZTogdGl0bGUsDQogICAgICAgIGtleToga2V5LA0KICAgICAgICBkYXRhOiB1c2VyRGF0YSwNCiAgICAgICAgYXV0b1dpZHRoOiB0cnVlLA0KICAgICAgICBmaWxlbmFtZTogIuWvvOWFpeaVsOaNruaooeeJiCIsDQogICAgICB9Ow0KICAgICAgZXhjZWwuZXhwb3J0X2FycmF5X3RvX2V4Y2VsKHBhcmFtcyk7DQogICAgfSwNCiAgICBpbXBvcnREYXRhKCkgew0KICAgICAgdGhpcy5pbXBvcnRMb2FkaW5nID0gdHJ1ZTsNCiAgICAgIC8vIOS8oOWFpeWvvOWFpeaVsOaNriDlkI7nq6/mjqXmlLZib2R55pWw57uE5YiX6KGo5om56YeP5a+85YWlDQogICAgICAvLyB0aGlzLmltcG9ydFJlcXVlc3QoIuivt+axgui3r+W+hCIsIHRoaXMuaW1wb3J0VGFibGVEYXRhKS50aGVuKHJlcyA9PiB7DQogICAgICAvLyAgIHRoaXMuaW1wb3J0TG9hZGluZyA9IGZhbHNlOw0KICAgICAgLy8gICBpZiAocmVzLnN1Y2Nlc3MpIHsNCiAgICAgIC8vICAgICB0aGlzLmltcG9ydE1vZGFsVmlzaWJsZSA9IGZhbHNlOw0KICAgICAgLy8gICAgIHRoaXMuZ2V0RGF0YUxpc3QoKTsNCiAgICAgIC8vICAgICB0aGlzLiRNb2RhbC5pbmZvKHsNCiAgICAgIC8vICAgICAgIHRpdGxlOiAi5a+85YWl57uT5p6cIiwNCiAgICAgIC8vICAgICAgIGNvbnRlbnQ6IHJlcy5tZXNzYWdlDQogICAgICAvLyAgICAgfSk7DQogICAgICAvLyAgIH0NCiAgICAgIC8vIH0pOw0KICAgICAgLy8g5qih5ouf6K+35rGC5oiQ5YqfDQogICAgICB0aGlzLmltcG9ydExvYWRpbmcgPSBmYWxzZTsNCiAgICAgIHRoaXMuaW1wb3J0TW9kYWxWaXNpYmxlID0gZmFsc2U7DQogICAgICB0aGlzLiRNb2RhbC5pbmZvKHsNCiAgICAgICAgdGl0bGU6ICLlr7zlhaXnu5PmnpwiLA0KICAgICAgICBjb250ZW50OiAi5a+85YWl5oiQ5Yqf77yM6L+Z5piv5YGH6YCa55+lIiwNCiAgICAgIH0pOw0KICAgICAgdGhpcy5nZXREYXRhTGlzdCgpOw0KICAgIH0sDQogICAgc2hvd1NlbGVjdChlKSB7DQogICAgICB0aGlzLmV4cG9ydERhdGEgPSBlOw0KICAgICAgdGhpcy5zZWxlY3RMaXN0ID0gZTsNCiAgICB9LA0KICAgIGNsZWFyU2VsZWN0QWxsKCkgew0KICAgICAgdGhpcy4kcmVmcy50YWJsZS5zZWxlY3RBbGwoZmFsc2UpOw0KICAgIH0sDQogICAgY2xlYXJJbXBvcnREYXRhKCkgew0KICAgICAgdGhpcy5pbXBvcnRUYWJsZURhdGEgPSBbXTsNCiAgICAgIHRoaXMuaW1wb3J0Q29sdW1ucyA9IFtdOw0KICAgICAgdGhpcy51cGxvYWRmaWxlID0ge307DQogICAgfSwNCiAgfSwNCiAgbW91bnRlZCgpIHsNCiAgICAvLyDorqHnrpfpq5jluqYNCiAgICB0aGlzLmhlaWdodCA9IE51bWJlcihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gMjMwKTsNCiAgICB0aGlzLmluaXQoKTsNCiAgfSwNCn07DQo="},{"version":3,"sources":["excel.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"excel.vue","sourceRoot":"src/views/xboot-vue-template/excel","sourcesContent":["<style lang=\"less\">\r\n@import \"@/styles/table-common.less\";\r\n</style>\r\n<template>\r\n  <div class=\"search\">\r\n    <Card>\r\n      <Row class=\"operation\">\r\n        <Button @click=\"exportSelectData\" icon=\"md-cloud-upload\"\r\n          >导出所选数据</Button\r\n        >\r\n        <Button @click=\"exportAll\" icon=\"ios-cloud-upload\">导出全部数据</Button>\r\n        <Button @click=\"importModalVisible = true\" icon=\"ios-download\"\r\n          >导入数据</Button\r\n        >\r\n        <Button type=\"dashed\" @click=\"openTip = !openTip\">{{\r\n          openTip ? \"关闭提示\" : \"开启提示\"\r\n        }}</Button>\r\n      </Row>\r\n      <Alert show-icon v-show=\"openTip\">\r\n        已选择\r\n        <span class=\"select-count\">{{ selectList.length }}</span> 项\r\n        <a class=\"select-clear\" @click=\"clearSelectAll\">清空</a>\r\n      </Alert>\r\n      <Table\r\n        :loading=\"loading\"\r\n        border\r\n        :columns=\"columns\"\r\n        :data=\"data\"\r\n        sortable=\"custom\"\r\n        @on-sort-change=\"changeSort\"\r\n        @on-selection-change=\"showSelect\"\r\n        ref=\"table\"\r\n      ></Table>\r\n      <Row type=\"flex\" justify=\"end\" class=\"page\">\r\n        <Page\r\n          :current=\"searchForm.pageNumber\"\r\n          :total=\"total\"\r\n          :page-size=\"searchForm.pageSize\"\r\n          @on-change=\"changePage\"\r\n          @on-page-size-change=\"changePageSize\"\r\n          :page-size-opts=\"[10, 20, 50]\"\r\n          size=\"small\"\r\n          show-total\r\n          show-elevator\r\n          show-sizer\r\n        ></Page>\r\n      </Row>\r\n    </Card>\r\n\r\n    <!-- 自定义导出数据 -->\r\n    <Modal\r\n      v-model=\"exportModalVisible\"\r\n      :title=\"exportTitle\"\r\n      :loading=\"loadingExport\"\r\n      @on-ok=\"exportCustomData\"\r\n    >\r\n      <Form ref=\"exportForm\" :label-width=\"100\">\r\n        <FormItem label=\"导出文件名\">\r\n          <Input v-model=\"filename\" />\r\n        </FormItem>\r\n        <FormItem label=\"自定义导出列\">\r\n          <CheckboxGroup v-model=\"chooseColumns\">\r\n            <Checkbox\r\n              v-for=\"(item, i) in exportColumns\"\r\n              :label=\"item.title\"\r\n              :key=\"i\"\r\n              :value=\"item.checked\"\r\n              :disabled=\"item.disabled\"\r\n            ></Checkbox>\r\n          </CheckboxGroup>\r\n        </FormItem>\r\n      </Form>\r\n    </Modal>\r\n    <Drawer\r\n      title=\"导入数据\"\r\n      closable\r\n      v-model=\"importModalVisible\"\r\n      width=\"800\"\r\n      draggable\r\n    >\r\n      <div\r\n        style=\"\r\n          display: flex;\r\n          justify-content: space-between;\r\n          align-items: center;\r\n        \"\r\n      >\r\n        <Upload action :before-upload=\"beforeUploadImport\" accept=\".xls, .xlsx\">\r\n          <Button\r\n            :loading=\"reading\"\r\n            icon=\"ios-cloud-upload-outline\"\r\n            style=\"margin-right: 10px\"\r\n            >上传Excel文件</Button\r\n          >\r\n          <span v-if=\"uploadfile.name\"\r\n            >当前选择文件：{{ uploadfile.name }}</span\r\n          >\r\n        </Upload>\r\n        <Button @click=\"clearImportData\" icon=\"md-trash\">清空数据</Button>\r\n      </div>\r\n      <Alert type=\"warning\" show-icon\r\n        >导入前请下载查看导入模版数据文件查看所需字段及说明，确保数据格式正确，不得修改列英文名称</Alert\r\n      >\r\n      <Table\r\n        :columns=\"importColumns\"\r\n        border\r\n        :height=\"height\"\r\n        :data=\"importTableData\"\r\n        ref=\"importTable\"\r\n      ></Table>\r\n      <div class=\"drawer-footer\">\r\n        <Button @click=\"downloadTemple\" type=\"info\">下载导入模板</Button>\r\n        <div style=\"position: absolute; right: 15px; display: inline-block\">\r\n          <Button @click=\"importModalVisible = false\">关闭</Button>\r\n          <Button\r\n            :loading=\"importLoading\"\r\n            :disabled=\"importTableData.length <= 0\"\r\n            @click=\"importData\"\r\n            style=\"margin-left: 5px\"\r\n            type=\"primary\"\r\n          >\r\n            确认导入\r\n            <span v-if=\"importTableData.length > 0\"\r\n              >{{ importTableData.length }} 条数据</span\r\n            >\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    </Drawer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// 模版导入文件表数据\r\nimport { userColumns, userData } from \"@/views/sys/user-manage/importTemplate\";\r\n// excel转换工具类\r\nimport excel from \"@/libs/excel\";\r\nexport default {\r\n  name: \"excel\",\r\n  data() {\r\n    return {\r\n      openTip: true, // 显示提示\r\n      reading: false, // 读取中\r\n      height: 510, // 高度\r\n      loading: true, // 表单加载状态\r\n      importLoading: false, // 导入加载状态\r\n      loadingExport: true, // 导出加载状态\r\n      exportModalVisible: false, // 自定义导出显示\r\n      importModalVisible: false, // 导入显示\r\n      selectList: [], // 多选数据\r\n      searchForm: {\r\n        pageNumber: 1,\r\n        pageSize: 10,\r\n        sort: \"createTime\",\r\n        order: \"desc\",\r\n      },\r\n      columns: [\r\n        // 表头\r\n        {\r\n          type: \"selection\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          type: \"index\",\r\n          width: 60,\r\n          align: \"center\",\r\n        },\r\n        {\r\n          title: \"名称\",\r\n          key: \"name\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"手机\",\r\n          key: \"mobile\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          sortable: true,\r\n          sortType: \"desc\",\r\n        },\r\n        {\r\n          title: \"更新时间\",\r\n          key: \"updateTime\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          key: \"action\",\r\n          align: \"center\",\r\n          width: 200,\r\n          render: (h, params) => {\r\n            return h(\"div\", [\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.$Message.info(\"点击了编辑\");\r\n                    },\r\n                  },\r\n                },\r\n                \"编辑\"\r\n              ),\r\n              h(\"Divider\", {\r\n                props: {\r\n                  type: \"vertical\",\r\n                },\r\n              }),\r\n              h(\r\n                \"a\",\r\n                {\r\n                  on: {\r\n                    click: () => {\r\n                      this.$Message.info(\"点击了删除\");\r\n                    },\r\n                  },\r\n                },\r\n                \"删除\"\r\n              ),\r\n            ]);\r\n          },\r\n        },\r\n      ],\r\n      exportColumns: [\r\n        // 导出列\r\n        {\r\n          title: \"名称\",\r\n          key: \"name\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"手机\",\r\n          key: \"mobile\",\r\n          sortable: true,\r\n        },\r\n        {\r\n          title: \"创建时间\",\r\n          key: \"createTime\",\r\n          sortable: true,\r\n          sortType: \"desc\",\r\n        },\r\n        {\r\n          title: \"更新时间\",\r\n          key: \"updateTime\",\r\n          sortable: true,\r\n        },\r\n      ],\r\n      chooseColumns: [],\r\n      filename: \"数据\",\r\n      exportTitle: \"确认导出\",\r\n      exportType: \"\",\r\n      importTableData: [],\r\n      importColumns: [],\r\n      uploadfile: {\r\n        name: \"\",\r\n      },\r\n      tempColumns: userColumns,\r\n      tempData: userData,\r\n      data: [],\r\n      exportData: [],\r\n      total: 0,\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.getDataList();\r\n      // 初始化导出列数据\r\n      let array = [];\r\n      this.exportColumns.forEach((e) => {\r\n        // 指定列限制权限\r\n        if (\r\n          !this.getStore(\"roles\").includes(\"ROLE_ADMIN\") &&\r\n          e.key == \"mobile\"\r\n        ) {\r\n          e.title = \"[无权导出] \" + e.title;\r\n          e.disabled = true;\r\n        } else {\r\n          e.disabled = false;\r\n        }\r\n        array.push(e.title);\r\n      });\r\n      this.chooseColumns = array;\r\n    },\r\n    changePage(v) {\r\n      this.searchForm.pageNumber = v;\r\n      this.getDataList();\r\n      this.clearSelectAll();\r\n    },\r\n    changePageSize(v) {\r\n      this.searchForm.pageSize = v;\r\n      this.getDataList();\r\n    },\r\n    selectDateRange(v) {\r\n      if (v) {\r\n        this.searchForm.startDate = v[0];\r\n        this.searchForm.endDate = v[1];\r\n      }\r\n    },\r\n    getDataList() {\r\n      this.loading = true;\r\n      let params = {\r\n        pageNumber: this.pageNumber,\r\n        pageSize: this.pageSize,\r\n        sort: this.sortColumn,\r\n        order: this.sortType,\r\n      };\r\n      // 请求后端获取表单数据 请自行修改接口\r\n      // this.getRequest(\"请求路径\", params).then(res => {\r\n      //   this.loading = false;\r\n      //   if (res.success) {\r\n      //     this.data = res.result.content;\r\n      //     this.total = res.result.totalElements;\r\n      //   }\r\n      // });\r\n      // 以下为模拟数据\r\n      this.data = [\r\n        {\r\n          id: \"1\",\r\n          name: \"XBoot\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n        {\r\n          id: \"2\",\r\n          name: \"Exrick\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n      ];\r\n      this.total = this.data.length;\r\n      this.loading = false;\r\n    },\r\n    handleSearch() {\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      this.getDataList();\r\n    },\r\n    handleReset() {\r\n      this.$refs.searchForm.resetFields();\r\n      this.searchForm.pageNumber = 1;\r\n      this.searchForm.pageSize = 10;\r\n      // 重新加载数据\r\n      this.getDataList();\r\n    },\r\n    changeSort(e) {\r\n      this.searchForm.sort = e.key;\r\n      this.searchForm.order = e.order;\r\n      if (e.order == \"normal\") {\r\n        this.searchForm.order = \"\";\r\n      }\r\n      this.getDataList();\r\n    },\r\n    exportSelectData() {\r\n      if (this.selectList.length <= 0) {\r\n        this.$Message.warning(\"您还未选择要导出的数据\");\r\n        return;\r\n      }\r\n      this.exportType = \"part\";\r\n      this.exportModalVisible = true;\r\n      this.exportTitle = \"确认导出 \" + this.selectList.length + \" 条数据\";\r\n    },\r\n    exportAll() {\r\n      this.exportType = \"all\";\r\n      this.exportModalVisible = true;\r\n      this.exportTitle = \"确认导出全部 \" + this.total + \" 条数据\";\r\n      // 请求后端获取全部数据 请自行修改接口\r\n      // this.getRequest(\"请求路径\", params).then(res => {\r\n      //   if (res.success) {\r\n      //     this.exportData = res.result;\r\n      //   }\r\n      // });\r\n      // 以下为模拟数据\r\n      this.exportData = [\r\n        {\r\n          id: \"1\",\r\n          name: \"XBoot\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n        {\r\n          id: \"2\",\r\n          name: \"Exrick\",\r\n          mobile: \"12345678901\",\r\n          createTime: \"2018-08-08 00:08:00\",\r\n          updateTime: \"2018-08-08 00:08:00\",\r\n        },\r\n      ];\r\n    },\r\n    exportCustomData() {\r\n      if (this.filename == \"\") {\r\n        this.filename = \"用户数据\";\r\n      }\r\n      // 判断勾选导出列\r\n      let exportColumns = [];\r\n      this.exportColumns.forEach((e) => {\r\n        this.chooseColumns.forEach((c) => {\r\n          if (e.title == c && !e.disabled) {\r\n            exportColumns.push(e);\r\n          }\r\n        });\r\n      });\r\n      this.exportModalVisible = false;\r\n      let title = [];\r\n      let key = [];\r\n      exportColumns.forEach((e) => {\r\n        title.push(e.title);\r\n        key.push(e.key);\r\n      });\r\n      const params = {\r\n        title: title,\r\n        key: key,\r\n        data: this.exportData,\r\n        autoWidth: true,\r\n        filename: this.filename,\r\n      };\r\n      excel.export_array_to_excel(params);\r\n    },\r\n    beforeUploadImport(file) {\r\n      this.uploadfile = file;\r\n      const fileExt = file.name.split(\".\").pop().toLocaleLowerCase();\r\n      if (fileExt == \"xlsx\" || fileExt == \"xls\") {\r\n        this.readFile(file);\r\n        this.file = file;\r\n      } else {\r\n        this.$Notice.warning({\r\n          title: \"文件类型错误\",\r\n          desc:\r\n            \"所选文件‘ \" +\r\n            file.name +\r\n            \" ’不是EXCEL文件，请选择后缀为.xlsx或者.xls的EXCEL文件。\",\r\n        });\r\n      }\r\n      return false;\r\n    },\r\n    // 读取文件\r\n    readFile(file) {\r\n      this.reading = true;\r\n      const reader = new FileReader();\r\n      reader.readAsArrayBuffer(file);\r\n      reader.onerror = (e) => {\r\n        this.reading = false;\r\n        this.$Message.error(\"文件读取出错\");\r\n      };\r\n      reader.onload = (e) => {\r\n        const data = e.target.result;\r\n        const { header, results } = excel.read(data, \"array\");\r\n        const tableTitle = header.map((item) => {\r\n          return { title: item, key: item, minWidth: 130, align: \"center\" };\r\n        });\r\n        this.importTableData = results;\r\n        this.importColumns = tableTitle;\r\n        this.reading = false;\r\n        this.$Message.success(\"读取数据成功\");\r\n      };\r\n    },\r\n    downloadTemple() {\r\n      let title = [];\r\n      let key = [];\r\n      userColumns.forEach((e) => {\r\n        title.push(e.title);\r\n        key.push(e.key);\r\n      });\r\n      const params = {\r\n        title: title,\r\n        key: key,\r\n        data: userData,\r\n        autoWidth: true,\r\n        filename: \"导入数据模版\",\r\n      };\r\n      excel.export_array_to_excel(params);\r\n    },\r\n    importData() {\r\n      this.importLoading = true;\r\n      // 传入导入数据 后端接收body数组列表批量导入\r\n      // this.importRequest(\"请求路径\", this.importTableData).then(res => {\r\n      //   this.importLoading = false;\r\n      //   if (res.success) {\r\n      //     this.importModalVisible = false;\r\n      //     this.getDataList();\r\n      //     this.$Modal.info({\r\n      //       title: \"导入结果\",\r\n      //       content: res.message\r\n      //     });\r\n      //   }\r\n      // });\r\n      // 模拟请求成功\r\n      this.importLoading = false;\r\n      this.importModalVisible = false;\r\n      this.$Modal.info({\r\n        title: \"导入结果\",\r\n        content: \"导入成功，这是假通知\",\r\n      });\r\n      this.getDataList();\r\n    },\r\n    showSelect(e) {\r\n      this.exportData = e;\r\n      this.selectList = e;\r\n    },\r\n    clearSelectAll() {\r\n      this.$refs.table.selectAll(false);\r\n    },\r\n    clearImportData() {\r\n      this.importTableData = [];\r\n      this.importColumns = [];\r\n      this.uploadfile = {};\r\n    },\r\n  },\r\n  mounted() {\r\n    // 计算高度\r\n    this.height = Number(document.documentElement.clientHeight - 230);\r\n    this.init();\r\n  },\r\n};\r\n</script>"]}]}