{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\setting-manage\\oss.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\setting-manage\\oss.vue","mtime":1651629755230},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\babel-loader\\lib\\index.js","mtime":1651770037115},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBzZWVTZWNyZXRTZXQsIGNoZWNrT3NzU2V0LCBnZXRPc3NTZXQsIGVkaXRPc3NTZXQgfSBmcm9tICJAL2FwaS9pbmRleCI7DQppbXBvcnQgZGljdCBmcm9tICJAL3ZpZXdzL215LWNvbXBvbmVudHMveGJvb3QvZGljdCI7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJvc3MiLA0KICBjb21wb25lbnRzOiB7DQogICAgZGljdCwNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgbG9hZGluZzogZmFsc2UsIC8vIOihqOWNleWKoOi9veeKtuaAgQ0KICAgICAgY2hhbmdlTG9hZGluZzogZmFsc2UsDQogICAgICBzYXZlTG9hZGluZzogZmFsc2UsDQogICAgICBlcnJvck1zZzogIiIsDQogICAgICBlcnJvck1zZzI6ICIiLA0KICAgICAgb3NzOiB7DQogICAgICAgIHNlcnZpY2VOYW1lOiAiIiwNCiAgICAgICAgYWNjZXNzS2V5OiAiIiwNCiAgICAgICAgc2VjcmV0S2V5OiAiIiwNCiAgICAgICAgZW5kcG9pbnQ6ICIiLA0KICAgICAgICBidWNrZXQ6ICIiLA0KICAgICAgICBidWNrZXRSZWdpb246ICIiLA0KICAgICAgICB6b25lOiBudWxsLA0KICAgICAgfSwNCiAgICAgIGNoYW5nZWRPc3NTSzogZmFsc2UsIC8vIOaYr+WQpuS/ruaUuW9zc+eahHNlY3JlY3RLZXkNCiAgICAgIG9zc1ZhbGlkYXRlOiB7DQogICAgICAgIC8vIOihqOWNlemqjOivgeinhOWImQ0KICAgICAgICBzZXJ2aWNlTmFtZTogW3sgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICLor7fpgInmi6kiLCB0cmlnZ2VyOiAiY2hhbmdlIiB9XSwNCiAgICAgICAgYWNjZXNzS2V5OiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9XSwNCiAgICAgICAgc2VjcmV0S2V5OiBbeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJibHVyIiB9XSwNCiAgICAgICAgZW5kcG9pbnQ6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi5LiN6IO95Li656m6IiwgdHJpZ2dlcjogImJsdXIiIH1dLA0KICAgICAgICBidWNrZXQ6IFt7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAi5LiN6IO95Li656m6IiwgdHJpZ2dlcjogImJsdXIiIH1dLA0KICAgICAgICB6b25lOiBbDQogICAgICAgICAgew0KICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsDQogICAgICAgICAgICB0eXBlOiAibnVtYmVyIiwNCiAgICAgICAgICAgIG1lc3NhZ2U6ICLkuI3og73kuLrnqboiLA0KICAgICAgICAgICAgdHJpZ2dlcjogImNoYW5nZSIsDQogICAgICAgICAgfSwNCiAgICAgICAgXSwNCiAgICAgICAgYnVja2V0UmVnaW9uOiBbDQogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogIuS4jeiDveS4uuepuiIsIHRyaWdnZXI6ICJjaGFuZ2UiIH0sDQogICAgICAgIF0sDQogICAgICB9LA0KICAgICAgZW5kcG9pbnRQSDogIuivt+i+k+WFpeepuumXtOiuv+mXruWfn+WQjSIsDQogICAgfTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIGluaXQoKSB7DQogICAgICB0aGlzLmluaXRPc3NTZXQoKTsNCiAgICB9LA0KICAgIGluaXRPc3NTZXQoKSB7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgY2hlY2tPc3NTZXQoKS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgaWYgKHJlcy5zdWNjZXNzICYmIHJlcy5yZXN1bHQpIHsNCiAgICAgICAgICBsZXQgb3NzID0gcmVzLnJlc3VsdDsNCiAgICAgICAgICBnZXRPc3NTZXQob3NzKS50aGVuKChyZXMpID0+IHsNCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgICAgaWYgKHJlcy5yZXN1bHQpIHsNCiAgICAgICAgICAgICAgLy8g6L2s5o2ibnVsbOS4uiIiDQogICAgICAgICAgICAgIGZvciAobGV0IGF0dHIgaW4gcmVzLnJlc3VsdCkgew0KICAgICAgICAgICAgICAgIGlmIChyZXMucmVzdWx0W2F0dHJdID09IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgIHJlcy5yZXN1bHRbYXR0cl0gPSAiIjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgdGhpcy5vc3MgPSByZXMucmVzdWx0Ow0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgdGhpcy5jaGFuZ2VkT3NzU0sgPSB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgIHRoaXMuY2hhbmdlZE9zc1NLID0gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBjaGFuZ2VPc3Modikgew0KICAgICAgdGhpcy4kcmVmcy5vc3NGb3JtLnJlc2V0RmllbGRzKCk7DQogICAgICBpZiAodiA9PSAiQUxJX09TUyIpIHsNCiAgICAgICAgdGhpcy5lbmRwb2ludFBIID0gIuivt+i+k+WFpUVuZFBvaW50KOWcsOWfn+iKgueCuSkg6Z2eQnVja2V05Z+f5ZCNIjsNCiAgICAgIH0gZWxzZSBpZiAodiA9PSAiVEVOQ0VOVF9PU1MiKSB7DQogICAgICAgIHRoaXMuZW5kcG9pbnRQSCA9ICLor7fovpPlhaXlrozmlbTor7fmsYLln5/lkI0iOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5lbmRwb2ludFBIID0gIuivt+i+k+WFpeepuumXtOiuv+mXruWfn+WQjSI7DQogICAgICB9DQogICAgICB0aGlzLmNoYW5nZUxvYWRpbmcgPSB0cnVlOw0KICAgICAgZ2V0T3NzU2V0KHYpLnRoZW4oKHJlcykgPT4gew0KICAgICAgICB0aGlzLmNoYW5nZUxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgaWYgKHJlcy5yZXN1bHQpIHsNCiAgICAgICAgICAvLyDovazmjaJudWxs5Li6IiINCiAgICAgICAgICBmb3IgKGxldCBhdHRyIGluIHJlcy5yZXN1bHQpIHsNCiAgICAgICAgICAgIGlmIChyZXMucmVzdWx0W2F0dHJdID09IG51bGwpIHsNCiAgICAgICAgICAgICAgcmVzLnJlc3VsdFthdHRyXSA9ICIiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLm9zcyA9IHJlcy5yZXN1bHQ7DQogICAgICAgICAgdGhpcy5jaGFuZ2VkT3NzU0sgPSBmYWxzZTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLm9zcyA9IHsgc2VydmljZU5hbWU6IHYgfTsNCiAgICAgICAgICBpZiAodGhpcy5vc3Muc2VydmljZU5hbWUgPT0gIkxPQ0FMX09TUyIpIHsNCiAgICAgICAgICAgIHRoaXMub3NzLmh0dHAgPSAiaHR0cDovLyI7DQogICAgICAgICAgICB0aGlzLm9zcy5lbmRwb2ludCA9ICIxMjcuMC4wLjE6OTk5OS94Ym9vdC9maWxlL3ZpZXciOw0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLmNoYW5nZWRPc3NTSyA9IHRydWU7DQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0sDQogICAgc2VlU2VjcmV0KG5hbWUpIHsNCiAgICAgIGlmICghbmFtZSkgew0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICBzZWVTZWNyZXRTZXQobmFtZSkudGhlbigocmVzKSA9PiB7DQogICAgICAgIGlmIChyZXMuc3VjY2Vzcykgew0KICAgICAgICAgIHRoaXMub3NzLnNlY3JldEtleSA9IHJlcy5yZXN1bHQ7DQogICAgICAgICAgdGhpcy5jaGFuZ2VkT3NzU0sgPSB0cnVlOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIHNhdmVFZGl0T3NzKCkgew0KICAgICAgaWYgKHRoaXMub3NzLnNlcnZpY2VOYW1lID09ICJMT0NBTF9PU1MiKSB7DQogICAgICAgIGlmICghdGhpcy5vc3MuaHR0cCkgew0KICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSAi6K+36YCJ5oupaHR0cOWNj+iuriI7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSAiIjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIXRoaXMub3NzLmVuZHBvaW50KSB7DQogICAgICAgICAgdGhpcy5lcnJvck1zZyA9ICLor7fovpPlhaXmlofku7bpooTop4jmjqXlj6MiOw0KICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICB0aGlzLmVycm9yTXNnID0gIiI7DQogICAgICAgIH0NCiAgICAgICAgaWYgKCF0aGlzLm9zcy5maWxlUGF0aCkgew0KICAgICAgICAgIHRoaXMuZXJyb3JNc2cyID0gIuivt+i+k+WFpeWtmOWCqOejgeebmOi3r+W+hCI7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuZXJyb3JNc2cyID0gIiI7DQogICAgICAgIH0NCiAgICAgICAgZWRpdE9zc1NldCh0aGlzLm9zcykudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgdGhpcy5zYXZlTG9hZGluZyA9IGZhbHNlOw0KICAgICAgICAgIGlmIChyZXMuc3VjY2Vzcykgew0KICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCLkv53lrZjmiJDlip8iKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kcmVmcy5vc3NGb3JtLnZhbGlkYXRlKCh2YWxpZCkgPT4gew0KICAgICAgICAgIGlmICh2YWxpZCkgew0KICAgICAgICAgICAgaWYgKCF0aGlzLm9zcy5odHRwKSB7DQogICAgICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSAi6K+36YCJ5oupaHR0cOWNj+iuriI7DQogICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHRoaXMuZXJyb3JNc2cgPSAiIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMuc2F2ZUxvYWRpbmcgPSB0cnVlOw0KICAgICAgICAgICAgdGhpcy5vc3MuY2hhbmdlZCA9IHRoaXMuY2hhbmdlZE9zc1NLOw0KICAgICAgICAgICAgZWRpdE9zc1NldCh0aGlzLm9zcykudGhlbigocmVzKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuc2F2ZUxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICAgICAgaWYgKHJlcy5zdWNjZXNzKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kTWVzc2FnZS5zdWNjZXNzKCLkv53lrZjmiJDlip8iKTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMuaW5pdCgpOw0KICB9LA0KfTsNCg=="},{"version":3,"sources":["oss.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"oss.vue","sourceRoot":"src/views/sys/setting-manage","sourcesContent":["<style lang=\"less\">\r\n</style>\r\n<template>\r\n  <div style=\"display: flex; position: relative\">\r\n    <Form\r\n      ref=\"ossForm\"\r\n      :model=\"oss\"\r\n      :label-width=\"110\"\r\n      label-position=\"left\"\r\n      :rules=\"ossValidate\"\r\n    >\r\n      <FormItem label=\"服务提供商\" prop=\"serviceName\">\r\n        <Select\r\n          v-model=\"oss.serviceName\"\r\n          @on-change=\"changeOss\"\r\n          placeholder=\"请选择\"\r\n          style=\"width: 230px\"\r\n        >\r\n          <Option value=\"LOCAL_OSS\">本地服务器</Option>\r\n          <Option value=\"MINIO_OSS\">MinIO</Option>\r\n          <Option value=\"QINIU_OSS\">七牛云</Option>\r\n          <Option value=\"ALI_OSS\">阿里云</Option>\r\n          <Option value=\"TENCENT_OSS\">腾讯云</Option>\r\n        </Select>\r\n      </FormItem>\r\n      <div v-if=\"oss.serviceName != 'LOCAL_OSS'\">\r\n        <FormItem label=\"accessKey\" prop=\"accessKey\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.accessKey\"\r\n            placeholder=\"请输入accessKey/secretId\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"secretKey\" prop=\"secretKey\">\r\n          <Tooltip placement=\"right\" content=\"无法编辑时请先点击查看图标\">\r\n            <Input\r\n              class=\"input-see\"\r\n              type=\"text\"\r\n              v-model=\"oss.secretKey\"\r\n              :disabled=\"changeLoading\"\r\n              :readonly=\"!changedOssSK\"\r\n              @on-click=\"seeSecret(oss.serviceName)\"\r\n              icon=\"ios-eye\"\r\n              placeholder=\"请输入secretKey\"\r\n              style=\"width: 380px\"\r\n            />\r\n          </Tooltip>\r\n        </FormItem>\r\n        <FormItem\r\n          v-if=\"oss.serviceName == 'QINIU_OSS'\"\r\n          label=\"zone存储区域\"\r\n          prop=\"zone\"\r\n        >\r\n          <Select\r\n            v-model=\"oss.zone\"\r\n            placeholder=\"请选择存储区域\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          >\r\n            <Option :value=\"-1\">自动判断</Option>\r\n            <Option :value=\"0\">华东</Option>\r\n            <Option :value=\"1\">华北</Option>\r\n            <Option :value=\"2\">华南</Option>\r\n            <Option :value=\"3\">北美</Option>\r\n            <Option :value=\"4\">东南亚</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"bucket空间\" prop=\"bucket\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.bucket\"\r\n            placeholder=\"请输入bucket空间名\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          v-if=\"oss.serviceName == 'TENCENT_OSS'\"\r\n          label=\"所属地域\"\r\n          prop=\"bucketRegion\"\r\n        >\r\n          <dict\r\n            dict=\"tencent_bucket_region\"\r\n            v-model=\"oss.bucketRegion\"\r\n            placeholder=\"请选择或输入搜索\"\r\n            filterable\r\n            :disabled=\"changeLoading\"\r\n            transfer\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"endpoint域名\" prop=\"endpoint\" :error=\"errorMsg\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.endpoint\"\r\n            :placeholder=\"endpointPH\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          >\r\n            <Select\r\n              v-model=\"oss.http\"\r\n              slot=\"prepend\"\r\n              style=\"width: 80px\"\r\n              prop=\"http\"\r\n            >\r\n              <Option value=\"http://\">http://</Option>\r\n              <Option value=\"https://\">https://</Option>\r\n            </Select>\r\n          </Input>\r\n        </FormItem>\r\n      </div>\r\n      <div v-else>\r\n        <FormItem label=\"存储磁盘路径\" prop=\"filePath\" :error=\"errorMsg2\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.filePath\"\r\n            placeholder=\"例如D:/upload\"\r\n            style=\"width: 380px\"\r\n            :disabled=\"changeLoading\"\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"文件预览接口\" prop=\"endpoint\" :error=\"errorMsg\">\r\n          <Input\r\n            type=\"text\"\r\n            v-model=\"oss.endpoint\"\r\n            placeholder=\"请输入文件预览接口\"\r\n            style=\"width: 380px\"\r\n          >\r\n            <Select\r\n              v-model=\"oss.http\"\r\n              slot=\"prepend\"\r\n              style=\"width: 80px\"\r\n              prop=\"http\"\r\n              :disabled=\"changeLoading\"\r\n            >\r\n              <Option value=\"http://\">http://</Option>\r\n              <Option value=\"https://\">https://</Option>\r\n            </Select>\r\n          </Input>\r\n        </FormItem>\r\n      </div>\r\n      <FormItem>\r\n        <Button\r\n          type=\"primary\"\r\n          style=\"width: 100px\"\r\n          :disabled=\"changeLoading\"\r\n          :loading=\"saveLoading\"\r\n          @click=\"saveEditOss\"\r\n          >保存并启用</Button\r\n        >\r\n      </FormItem>\r\n    </Form>\r\n    <Spin fix v-if=\"loading\"></Spin>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { seeSecretSet, checkOssSet, getOssSet, editOssSet } from \"@/api/index\";\r\nimport dict from \"@/views/my-components/xboot/dict\";\r\nexport default {\r\n  name: \"oss\",\r\n  components: {\r\n    dict,\r\n  },\r\n  data() {\r\n    return {\r\n      loading: false, // 表单加载状态\r\n      changeLoading: false,\r\n      saveLoading: false,\r\n      errorMsg: \"\",\r\n      errorMsg2: \"\",\r\n      oss: {\r\n        serviceName: \"\",\r\n        accessKey: \"\",\r\n        secretKey: \"\",\r\n        endpoint: \"\",\r\n        bucket: \"\",\r\n        bucketRegion: \"\",\r\n        zone: null,\r\n      },\r\n      changedOssSK: false, // 是否修改oss的secrectKey\r\n      ossValidate: {\r\n        // 表单验证规则\r\n        serviceName: [{ required: true, message: \"请选择\", trigger: \"change\" }],\r\n        accessKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        secretKey: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        endpoint: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        bucket: [{ required: true, message: \"不能为空\", trigger: \"blur\" }],\r\n        zone: [\r\n          {\r\n            required: true,\r\n            type: \"number\",\r\n            message: \"不能为空\",\r\n            trigger: \"change\",\r\n          },\r\n        ],\r\n        bucketRegion: [\r\n          { required: true, message: \"不能为空\", trigger: \"change\" },\r\n        ],\r\n      },\r\n      endpointPH: \"请输入空间访问域名\",\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.initOssSet();\r\n    },\r\n    initOssSet() {\r\n      this.loading = true;\r\n      checkOssSet().then((res) => {\r\n        if (res.success && res.result) {\r\n          let oss = res.result;\r\n          getOssSet(oss).then((res) => {\r\n            this.loading = false;\r\n            if (res.result) {\r\n              // 转换null为\"\"\r\n              for (let attr in res.result) {\r\n                if (res.result[attr] == null) {\r\n                  res.result[attr] = \"\";\r\n                }\r\n              }\r\n              this.oss = res.result;\r\n            } else {\r\n              this.changedOssSK = true;\r\n            }\r\n          });\r\n        } else {\r\n          this.loading = false;\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    changeOss(v) {\r\n      this.$refs.ossForm.resetFields();\r\n      if (v == \"ALI_OSS\") {\r\n        this.endpointPH = \"请输入EndPoint(地域节点) 非Bucket域名\";\r\n      } else if (v == \"TENCENT_OSS\") {\r\n        this.endpointPH = \"请输入完整请求域名\";\r\n      } else {\r\n        this.endpointPH = \"请输入空间访问域名\";\r\n      }\r\n      this.changeLoading = true;\r\n      getOssSet(v).then((res) => {\r\n        this.changeLoading = false;\r\n        if (res.result) {\r\n          // 转换null为\"\"\r\n          for (let attr in res.result) {\r\n            if (res.result[attr] == null) {\r\n              res.result[attr] = \"\";\r\n            }\r\n          }\r\n          this.oss = res.result;\r\n          this.changedOssSK = false;\r\n        } else {\r\n          this.oss = { serviceName: v };\r\n          if (this.oss.serviceName == \"LOCAL_OSS\") {\r\n            this.oss.http = \"http://\";\r\n            this.oss.endpoint = \"127.0.0.1:9999/xboot/file/view\";\r\n          }\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    seeSecret(name) {\r\n      if (!name) {\r\n        return;\r\n      }\r\n      seeSecretSet(name).then((res) => {\r\n        if (res.success) {\r\n          this.oss.secretKey = res.result;\r\n          this.changedOssSK = true;\r\n        }\r\n      });\r\n    },\r\n    saveEditOss() {\r\n      if (this.oss.serviceName == \"LOCAL_OSS\") {\r\n        if (!this.oss.http) {\r\n          this.errorMsg = \"请选择http协议\";\r\n          return;\r\n        } else {\r\n          this.errorMsg = \"\";\r\n        }\r\n        if (!this.oss.endpoint) {\r\n          this.errorMsg = \"请输入文件预览接口\";\r\n          return;\r\n        } else {\r\n          this.errorMsg = \"\";\r\n        }\r\n        if (!this.oss.filePath) {\r\n          this.errorMsg2 = \"请输入存储磁盘路径\";\r\n          return;\r\n        } else {\r\n          this.errorMsg2 = \"\";\r\n        }\r\n        editOssSet(this.oss).then((res) => {\r\n          this.saveLoading = false;\r\n          if (res.success) {\r\n            this.$Message.success(\"保存成功\");\r\n          }\r\n        });\r\n      } else {\r\n        this.$refs.ossForm.validate((valid) => {\r\n          if (valid) {\r\n            if (!this.oss.http) {\r\n              this.errorMsg = \"请选择http协议\";\r\n              return;\r\n            } else {\r\n              this.errorMsg = \"\";\r\n            }\r\n            this.saveLoading = true;\r\n            this.oss.changed = this.changedOssSK;\r\n            editOssSet(this.oss).then((res) => {\r\n              this.saveLoading = false;\r\n              if (res.success) {\r\n                this.$Message.success(\"保存成功\");\r\n              }\r\n            });\r\n          }\r\n        });\r\n      }\r\n    },\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n};\r\n</script>"]}]}