{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\xboot-vue-generator\\treeGenerator.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\xboot-vue-generator\\treeGenerator.vue","mtime":1651629755321},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1651770028580},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1651770027142},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\postcss-loader\\src\\index.js","mtime":1651770027415},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":1651770042155},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpAaW1wb3J0ICJAL3N0eWxlcy90cmVlJnRhYmxlLWNvbW1vbi5sZXNzIjsNCi5zZWFyY2ggew0KICAucHJldmlldyB7DQogICAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgICBjb2xvcjogIzQwYTlmZjsNCiAgICBjdXJzb3I6IHBvaW50ZXI7DQogIH0NCn0NCg=="},{"version":3,"sources":["treeGenerator.vue"],"names":[],"mappings":";AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"treeGenerator.vue","sourceRoot":"src/views/xboot-vue-generator","sourcesContent":["<style lang=\"less\">\r\n@import \"@/styles/tree&table-common.less\";\r\n.search {\r\n  .preview {\r\n    font-weight: 600;\r\n    color: #40a9ff;\r\n    cursor: pointer;\r\n  }\r\n}\r\n</style>\r\n<template>\r\n  <div class=\"search\">\r\n    <Card>\r\n      <Row class=\"operation\" align=\"middle\">\r\n        <span>组件英文名：</span>\r\n        <Tooltip\r\n          content=\"生成的请求api文件中将使用该组件名拼接，建议驼峰法命名\"\r\n          placement=\"right\"\r\n          transfer\r\n          max-width=\"250\"\r\n        >\r\n          <Input\r\n            v-model=\"vueName\"\r\n            clearable\r\n            style=\"width: 150px; margin-right: 10px\"\r\n          />\r\n        </Tooltip>\r\n        <span>表单显示：</span>\r\n        <Select\r\n          v-model=\"rowNum\"\r\n          transfer\r\n          style=\"width: 150px; margin-right: 10px\"\r\n        >\r\n          <Option value=\"1\">一行一列</Option>\r\n          <Option value=\"2\">一行两列</Option>\r\n          <Option value=\"3\">一行三列</Option>\r\n          <Option value=\"4\">一行四列</Option>\r\n        </Select>\r\n        <span>可切换树表格：</span>\r\n        <i-switch v-model=\"enableTable\" style=\"margin-right: 10px\">\r\n          <span slot=\"open\">开</span>\r\n          <span slot=\"close\">关</span>\r\n        </i-switch>\r\n        <Button @click=\"add\" type=\"primary\" icon=\"md-add\">添加字段</Button>\r\n        <Button @click=\"entityModal = true\" type=\"warning\" icon=\"ios-construct\"\r\n          >读取字段</Button\r\n        >\r\n        <Button\r\n          @click=\"generate\"\r\n          :loading=\"loading\"\r\n          type=\"success\"\r\n          icon=\"md-send\"\r\n          >生成代码</Button\r\n        >\r\n        <Button @click=\"clear\" icon=\"md-trash\">清空全部</Button>\r\n      </Row>\r\n      <Alert show-icon>\r\n        将生成的代码复制粘贴至XBoot前端新建的空白组件中，再做少许修改并自行调通接口即可\r\n        <span @click=\"preview\" class=\"preview\">树形结构预览</span>\r\n        【字段 title、parentId、sortOrder、parentTitle 将自动生成，无需填入】\r\n      </Alert>\r\n      <Table border :columns=\"columns\" :data=\"data\" ref=\"table\">\r\n        <template slot-scope=\"{ row }\" slot=\"field\">\r\n          <Input v-model=\"row.field\" @on-blur=\"changeField(row, $event)\" />\r\n        </template>\r\n        <template slot-scope=\"{ row }\" slot=\"name\">\r\n          <Input v-model=\"row.name\" @on-blur=\"changeName(row, $event)\" />\r\n        </template>\r\n        <template slot-scope=\"{ row }\" slot=\"editable\">\r\n          <i-switch\r\n            v-model=\"row.editable\"\r\n            @on-change=\"changeEditable(row, $event)\"\r\n          >\r\n            <span slot=\"open\">开</span>\r\n            <span slot=\"close\">关</span>\r\n          </i-switch>\r\n        </template>\r\n        <template slot-scope=\"{ row }\" slot=\"type\">\r\n          <Select\r\n            v-model=\"row.type\"\r\n            :disabled=\"!row.editable\"\r\n            @on-change=\"changeType(row, $event)\"\r\n            transfer\r\n          >\r\n            <Option value=\"text\">文本输入框</Option>\r\n            <Option value=\"textarea\">多行文本输入框</Option>\r\n            <Option value=\"select\">选择下拉框</Option>\r\n            <Option value=\"number\">数字输入框</Option>\r\n            <Option value=\"dict\">数据字典选择组件</Option>\r\n            <Option value=\"customList\">自定义列表选择组件</Option>\r\n            <Option value=\"date\">日期选择器</Option>\r\n            <Option value=\"datetime\">日期时间选择器</Option>\r\n            <Option value=\"daterange\">日期范围选择器</Option>\r\n            <Option value=\"upload\">图片上传输入组件</Option>\r\n            <Option value=\"uploadThumb\">图片上传缩略图组件</Option>\r\n            <Option value=\"fileUpload\">文件上传/下载组件</Option>\r\n            <Option value=\"switch\">Switch开关</Option>\r\n            <Option value=\"radio\">Radio单选框</Option>\r\n            <Option value=\"time\">时间选择器</Option>\r\n            <Option value=\"area\">省市县级联</Option>\r\n            <Option value=\"slider\">Slider滑块</Option>\r\n            <Option value=\"editor\">富文本组件wangEditor</Option>\r\n            <Option value=\"password\">密码强度提示输入框</Option>\r\n          </Select>\r\n        </template>\r\n        <template slot-scope=\"{ row }\" slot=\"validate\">\r\n          <i-switch\r\n            v-model=\"row.validate\"\r\n            @on-change=\"changeValidate(row, $event)\"\r\n            :disabled=\"!row.editable\"\r\n          >\r\n            <span slot=\"open\">是</span>\r\n            <span slot=\"close\">否</span>\r\n          </i-switch>\r\n        </template>\r\n        <template slot-scope=\"{ row }\" slot=\"action\">\r\n          <a @click=\"edit(row)\">编辑</a>\r\n          <Divider type=\"vertical\" />\r\n          <a @click=\"remove(row)\">删除</a>\r\n        </template>\r\n      </Table>\r\n    </Card>\r\n\r\n    <Modal\r\n      :title=\"modalTitle\"\r\n      v-model=\"modalVisible\"\r\n      :mask-closable=\"false\"\r\n      :width=\"500\"\r\n    >\r\n      <Form ref=\"form\" :model=\"form\" :label-width=\"100\" :rules=\"formValidate\">\r\n        <FormItem label=\"字段英文名\" prop=\"field\" class=\"block-tool\">\r\n          <Tooltip placement=\"right\" content=\"与后端实体字段匹配\">\r\n            <Input v-model=\"form.field\" />\r\n          </Tooltip>\r\n        </FormItem>\r\n        <FormItem label=\"字段中文名\" prop=\"name\">\r\n          <Input v-model=\"form.name\" />\r\n        </FormItem>\r\n        <FormItem label=\"可添加编辑\" prop=\"editable\">\r\n          <i-switch v-model=\"form.editable\">\r\n            <span slot=\"open\">开</span>\r\n            <span slot=\"close\">关</span>\r\n          </i-switch>\r\n        </FormItem>\r\n        <FormItem label=\"字段表单类型\" prop=\"type\" v-show=\"form.editable\">\r\n          <Select v-model=\"form.type\" filterable transfer>\r\n            <Option value=\"text\">文本输入框</Option>\r\n            <Option value=\"textarea\">多行文本输入框</Option>\r\n            <Option value=\"select\">选择下拉框</Option>\r\n            <Option value=\"number\">数字输入框</Option>\r\n            <Option value=\"dict\">数据字典选择组件</Option>\r\n            <Option value=\"customList\">自定义列表选择组件</Option>\r\n            <Option value=\"date\">日期选择器</Option>\r\n            <Option value=\"datetime\">日期时间选择器</Option>\r\n            <Option value=\"daterange\">日期范围选择器</Option>\r\n            <Option value=\"upload\">图片上传输入组件</Option>\r\n            <Option value=\"uploadThumb\">图片上传缩略图组件</Option>\r\n            <Option value=\"fileUpload\">文件上传/下载组件</Option>\r\n            <Option value=\"switch\">Switch开关</Option>\r\n            <Option value=\"radio\">Radio单选框</Option>\r\n            <Option value=\"time\">时间选择器</Option>\r\n            <Option value=\"area\">省市县级联</Option>\r\n            <Option value=\"slider\">Slider滑块</Option>\r\n            <Option value=\"editor\">富文本组件wangEditor</Option>\r\n            <Option value=\"password\">密码强度提示输入框</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"字典类型\" prop=\"dictType\" v-show=\"form.type == 'dict'\">\r\n          <customList\r\n            v-model=\"form.dictType\"\r\n            filterable\r\n            url=\"/dict/getAll\"\r\n            valueBind=\"type\"\r\n            description=\"type\"\r\n          />\r\n        </FormItem>\r\n        <FormItem\r\n          label=\"自定义URL\"\r\n          prop=\"customUrl\"\r\n          v-show=\"form.type == 'customList'\"\r\n        >\r\n          <Input\r\n            v-model=\"form.customUrl\"\r\n            placeholder=\"输入自定义选择组件url属性\"\r\n          />\r\n        </FormItem>\r\n        <FormItem label=\"显示级别\" prop=\"level\" v-show=\"form.type == 'area'\">\r\n          <Select transfer v-model=\"form.level\">\r\n            <Option value=\"0\">仅显示省</Option>\r\n            <Option value=\"1\">显示省和县</Option>\r\n            <Option value=\"2\">显示省市县</Option>\r\n          </Select>\r\n        </FormItem>\r\n        <FormItem label=\"是否必填\" prop=\"validate\" v-show=\"form.editable\">\r\n          <i-switch v-model=\"form.validate\">\r\n            <span slot=\"open\">是</span>\r\n            <span slot=\"close\">否</span>\r\n          </i-switch>\r\n        </FormItem>\r\n        <FormItem label=\"排序值\" prop=\"sortOrder\">\r\n          <InputNumber v-model=\"form.sortOrder\"></InputNumber>\r\n        </FormItem>\r\n      </Form>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"modalVisible = false\">取消</Button>\r\n        <Button type=\"primary\" @click=\"handleSubmit\">提交</Button>\r\n      </div>\r\n    </Modal>\r\n    <Modal\r\n      v-model=\"codeModal\"\r\n      :width=\"900\"\r\n      :fullscreen=\"full\"\r\n      :styles=\"full ? {} : modalStyle\"\r\n      footer-hide\r\n    >\r\n      <div slot=\"header\">\r\n        <div class=\"ivu-modal-header-inner\">生成代码</div>\r\n        <a @click=\"changeCodeFull\" class=\"modal-fullscreen\">\r\n          <Icon\r\n            v-show=\"!full\"\r\n            type=\"ios-expand\"\r\n            class=\"model-fullscreen-icon\"\r\n          />\r\n          <Icon\r\n            v-show=\"full\"\r\n            type=\"ios-contract\"\r\n            class=\"model-fullscreen-icon\"\r\n          />\r\n        </a>\r\n        <a @click=\"codeModal = false\" class=\"ivu-modal-close\">\r\n          <Icon type=\"ios-close\" class=\"ivu-icon-ios-close\" />\r\n        </a>\r\n      </div>\r\n      <RadioGroup\r\n        v-model=\"resultType\"\r\n        style=\"margin-bottom: 15px\"\r\n        @on-change=\"changeRadio\"\r\n      >\r\n        <Radio label=\"drawerApi\" border>树结构+抽屉(API)</Radio>\r\n        <Radio label=\"drawer\" border>树结构+抽屉(模拟请求)</Radio>\r\n        <Radio label=\"resultApi\" border>树结构(API)</Radio>\r\n        <Radio label=\"result\" border>树结构(模拟请求)</Radio>\r\n      </RadioGroup>\r\n      <Tabs v-model=\"tabName\" type=\"card\" @on-click=\"changeCode\">\r\n        <TabPane name=\"index.vue\" label=\"index.vue\"></TabPane>\r\n        <TabPane\r\n          v-if=\"resultType == 'drawerApi' || resultType == 'resultApi'\"\r\n          name=\"api.js\"\r\n          label=\"api.js\"\r\n        ></TabPane>\r\n      </Tabs>\r\n      <monaco\r\n        id=\"monaco\"\r\n        :title=\"tabName\"\r\n        v-model=\"code\"\r\n        language=\"html\"\r\n        :showTitle=\"false\"\r\n        :showUndo=\"false\"\r\n        :showRedo=\"false\"\r\n        :height=\"codeHeight\"\r\n        ref=\"monaco\"\r\n        v-if=\"codeModal\"\r\n      />\r\n    </Modal>\r\n    <Modal v-model=\"entityModal\" :width=\"700\" :fullscreen=\"fullEntity\">\r\n      <div slot=\"header\">\r\n        <div class=\"ivu-modal-header-inner\">自动读取字段</div>\r\n        <a @click=\"changeEntityFull\" class=\"modal-fullscreen\">\r\n          <Icon\r\n            v-show=\"!fullEntity\"\r\n            type=\"ios-expand\"\r\n            class=\"model-fullscreen-icon\"\r\n          />\r\n          <Icon\r\n            v-show=\"fullEntity\"\r\n            type=\"ios-contract\"\r\n            class=\"model-fullscreen-icon\"\r\n          />\r\n        </a>\r\n        <a @click=\"entityModal = false\" class=\"ivu-modal-close\">\r\n          <Icon type=\"ios-close\" class=\"ivu-icon-ios-close\" />\r\n        </a>\r\n      </div>\r\n      <Alert show-icon\r\n        >输入实体类的引用路径，将自动读取其字段生成所需JSON配置数据，免去手动配置添加字段</Alert\r\n      >\r\n      <Form\r\n        ref=\"entityForm\"\r\n        :model=\"entityForm\"\r\n        :label-width=\"130\"\r\n        :rules=\"entityFormValidate\"\r\n      >\r\n        <FormItem label=\"实体类引用路径\" prop=\"path\">\r\n          <Row type=\"flex\">\r\n            <Input\r\n              v-model=\"entityForm.path\"\r\n              placeholder=\"例如：cn.exrick.xboot.modules.base.entity.User\"\r\n              clearable\r\n              style=\"width: 410px\"\r\n            />\r\n            <Button\r\n              type=\"warning\"\r\n              icon=\"md-play\"\r\n              @click=\"generateEntityData\"\r\n              style=\"margin-left: 18px\"\r\n              >读取字段</Button\r\n            >\r\n          </Row>\r\n        </FormItem>\r\n      </Form>\r\n      <monaco\r\n        id=\"monacoEntity\"\r\n        v-model=\"entityData\"\r\n        language=\"json\"\r\n        :showTitle=\"false\"\r\n        :showFormat=\"false\"\r\n        :showUndo=\"false\"\r\n        :showRedo=\"false\"\r\n        :height=\"entityHeight\"\r\n        ref=\"monacoEntity\"\r\n        v-if=\"entityModal\"\r\n      />\r\n      <div slot=\"footer\">\r\n        <Button\r\n          type=\"primary\"\r\n          :disabled=\"!entityForm.path\"\r\n          @click=\"submitEntityData\"\r\n          >确认生成</Button\r\n        >\r\n      </div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { generateTree, getEntityData } from \"@/api/index\";\r\nimport customList from \"@/views/my-components/xboot/custom-list\";\r\nimport monaco from \"@/views/my-components/xboot/monaco\";\r\nexport default {\r\n  name: \"tree-generator\",\r\n  components: {\r\n    customList,\r\n    monaco,\r\n  },\r\n  data() {\r\n    return {\r\n      entityHeight: 400,\r\n      fullEntityHeight: 100,\r\n      codeHeight: 500,\r\n      fullHeight: 100,\r\n      resultType: \"drawerApi\",\r\n      tabName: \"index.vue\",\r\n      modalStyle: {\r\n        top: \"30px\",\r\n      },\r\n      result: {},\r\n      entityModal: false,\r\n      fullEntity: false,\r\n      entityData: \"\",\r\n      entityForm: {\r\n        path: \"\",\r\n      },\r\n      loading: false,\r\n      code: \"\",\r\n      vueName: \"\",\r\n      rowNum: \"1\",\r\n      full: false,\r\n      codeModal: false,\r\n      modalVisible: false,\r\n      modalType: 0,\r\n      modalTitle: \"\",\r\n      form: {\r\n        sortOrder: 0,\r\n        field: \"\",\r\n        name: \"\",\r\n        dictType: \"\",\r\n        customList: \"\",\r\n        level: \"2\",\r\n        editable: true,\r\n        type: \"text\",\r\n        validate: true,\r\n      },\r\n      formValidate: {\r\n        field: [{ required: true, message: \"不能为空\", trigger: \"change\" }],\r\n        name: [{ required: true, message: \"不能为空\", trigger: \"change\" }],\r\n      },\r\n      entityFormValidate: {\r\n        path: [{ required: true, message: \"不能为空\", trigger: \"change\" }],\r\n      },\r\n      columns: [\r\n        // 表头\r\n        {\r\n          title: \"排序\",\r\n          key: \"sortOrder\",\r\n          sortType: \"asc\",\r\n          sortable: true,\r\n          align: \"center\",\r\n          minWidth: 80,\r\n        },\r\n        {\r\n          title: \"字段英文名\",\r\n          slot: \"field\",\r\n          minWidth: 150,\r\n        },\r\n        {\r\n          title: \"名称\",\r\n          slot: \"name\",\r\n          minWidth: 150,\r\n        },\r\n        {\r\n          title: \"可添加编辑\",\r\n          slot: \"editable\",\r\n          minWidth: 100,\r\n        },\r\n        {\r\n          title: \"表单类型\",\r\n          slot: \"type\",\r\n          minWidth: 200,\r\n        },\r\n        {\r\n          title: \"是否必填\",\r\n          slot: \"validate\",\r\n          minWidth: 110,\r\n        },\r\n        {\r\n          title: \"操作\",\r\n          slot: \"action\",\r\n          align: \"center\",\r\n          fixed: \"right\",\r\n          minWidth: 120,\r\n        },\r\n      ],\r\n      data: [],\r\n      enableTable: true,\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      // 取缓存数据\r\n      let data = this.getStore(\"treeData\");\r\n      let vueName = this.getStore(\"treeVueName\");\r\n      let rowNum = this.getStore(\"treeRowNum\");\r\n      let enableTable = this.getStore(\"enableTable\");\r\n      if (data && data != \"undefined\") {\r\n        this.data = JSON.parse(data);\r\n      }\r\n      if (rowNum && rowNum != \"undefined\") {\r\n        this.rowNum = rowNum;\r\n      }\r\n      if (vueName && vueName != \"undefined\") {\r\n        this.vueName = vueName;\r\n      }\r\n      if (enableTable && enableTable != \"undefined\") {\r\n        this.enableTable = eval(enableTable);\r\n      }\r\n    },\r\n    changeEntityFull() {\r\n      this.fullEntity = !this.fullEntity;\r\n      if (this.fullEntity) {\r\n        this.entityHeight = this.fullEntityHeight;\r\n      } else {\r\n        this.entityHeight = 400;\r\n      }\r\n      setTimeout(() => {\r\n        this.$refs.monacoEntity.layout();\r\n      }, 10);\r\n    },\r\n    changeCodeFull() {\r\n      this.full = !this.full;\r\n      if (this.full) {\r\n        this.codeHeight = this.fullHeight;\r\n      } else {\r\n        this.codeHeight = 500;\r\n      }\r\n      setTimeout(() => {\r\n        this.$refs.monaco.layout();\r\n      }, 10);\r\n    },\r\n    generateEntityData() {\r\n      this.$refs.entityForm.validate((valid) => {\r\n        if (valid) {\r\n          getEntityData({\r\n            path: this.entityForm.path,\r\n          }).then((res) => {\r\n            if (res.success) {\r\n              this.entityData = res.result;\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    submitEntityData() {\r\n      if (!this.entityData) {\r\n        this.$Message.warning(\"请先输入实体类引用路径生成JSON数据\");\r\n        return;\r\n      }\r\n      try {\r\n        let data = JSON.parse(this.entityData);\r\n        this.data = data.data;\r\n        this.entityModal = false;\r\n      } catch (e) {\r\n        this.$Message.error(\"请确保JSON数据格式正确\");\r\n      }\r\n    },\r\n    preview() {\r\n      this.$router.push({\r\n        name: \"tree\",\r\n      });\r\n    },\r\n    changeField(row, v) {\r\n      for (let attr in row) {\r\n        if (row[attr] == null) {\r\n          row[attr] = \"\";\r\n        }\r\n      }\r\n      let str = JSON.stringify(row);\r\n      let data = JSON.parse(str);\r\n      data.field = v.target.value;\r\n      this.data.splice(row._index, 1, data);\r\n      this.save();\r\n    },\r\n    changeName(row, v) {\r\n      for (let attr in row) {\r\n        if (row[attr] == null) {\r\n          row[attr] = \"\";\r\n        }\r\n      }\r\n      let str = JSON.stringify(row);\r\n      let data = JSON.parse(str);\r\n      data.name = v.target.value;\r\n      this.data.splice(row._index, 1, data);\r\n      this.save();\r\n    },\r\n    changeType(row, v) {\r\n      for (let attr in row) {\r\n        if (row[attr] == null) {\r\n          row[attr] = \"\";\r\n        }\r\n      }\r\n      let str = JSON.stringify(row);\r\n      let data = JSON.parse(str);\r\n      data.type = v;\r\n      this.data.splice(row._index, 1, data);\r\n      this.save();\r\n    },\r\n    changeEditable(row, v) {\r\n      for (let attr in row) {\r\n        if (row[attr] == null) {\r\n          row[attr] = \"\";\r\n        }\r\n      }\r\n      let str = JSON.stringify(row);\r\n      let data = JSON.parse(str);\r\n      data.editable = v;\r\n      this.data.splice(row._index, 1, data);\r\n      this.save();\r\n    },\r\n    changeValidate(row, v) {\r\n      for (let attr in row) {\r\n        if (row[attr] == null) {\r\n          row[attr] = \"\";\r\n        }\r\n      }\r\n      let str = JSON.stringify(row);\r\n      let data = JSON.parse(str);\r\n      data.validate = v;\r\n      this.data.splice(row._index, 1, data);\r\n      this.save();\r\n    },\r\n    handleSubmit() {\r\n      this.$refs.form.validate((valid) => {\r\n        if (valid) {\r\n          // 转换null为\"\"\r\n          let v = this.form;\r\n          for (let attr in v) {\r\n            if (v[attr] == null) {\r\n              v[attr] = \"\";\r\n            }\r\n          }\r\n          let str = JSON.stringify(v);\r\n          let data = JSON.parse(str);\r\n          if (this.modalType == 0) {\r\n            this.data.push(data);\r\n            this.data = this.data;\r\n          } else {\r\n            this.data.splice(v._index, 1, data);\r\n          }\r\n          this.save();\r\n          this.modalVisible = false;\r\n        }\r\n      });\r\n    },\r\n    add() {\r\n      this.modalType = 0;\r\n      this.modalTitle = \"添加字段\";\r\n      this.$refs.form.resetFields();\r\n      this.form.sortOrder = this.data.length + 1;\r\n      this.modalVisible = true;\r\n    },\r\n    edit(v) {\r\n      this.modalType = 1;\r\n      this.modalTitle = \"编辑字段\";\r\n      // 转换null为\"\"\r\n      for (let attr in v) {\r\n        if (v[attr] == null) {\r\n          v[attr] = \"\";\r\n        }\r\n      }\r\n      let str = JSON.stringify(v);\r\n      let data = JSON.parse(str);\r\n      this.form = data;\r\n      this.modalVisible = true;\r\n    },\r\n    remove(v) {\r\n      this.data.splice(v._index, 1);\r\n      this.save();\r\n      this.$Message.success(\"操作成功\");\r\n    },\r\n    clear() {\r\n      this.$Modal.confirm({\r\n        title: \"确认清空\",\r\n        content: \"您确认要清空所有数据 ?\",\r\n        onOk: () => {\r\n          this.data = [];\r\n          this.vueName = \"\";\r\n          this.rowNum = \"1\";\r\n          this.enableTable = true;\r\n          this.save();\r\n          this.$Message.success(\"操作成功\");\r\n        },\r\n      });\r\n    },\r\n    generate() {\r\n      if (!this.vueName) {\r\n        this.$Message.warning(\"请输入组件名\");\r\n        return;\r\n      }\r\n      this.loading = true;\r\n      // 判断是否有重复字段\r\n      let flag = false;\r\n      this.data.forEach((e) => {\r\n        if (\r\n          e.field == \"title\" ||\r\n          e.field == \"parentId\" ||\r\n          e.field == \"sortOrder\" ||\r\n          e.field == \"parentTitle\"\r\n        ) {\r\n          flag = true;\r\n        }\r\n      });\r\n      if (flag) {\r\n        this.loading = false;\r\n        this.$Modal.confirm({\r\n          title: \"无效字段提示\",\r\n          content:\r\n            \"您添加的字段中包含以下无效的重复字段：title、parentId、sortOrder、parentTitle，确认后将自动过滤生成\",\r\n          onOk: () => {\r\n            this.loading = true;\r\n            this.data = this.data.filter((e) => {\r\n              return (\r\n                e.field != \"title\" &&\r\n                e.field != \"parentId\" &&\r\n                e.field != \"sortOrder\" &&\r\n                e.field != \"parentTitle\"\r\n              );\r\n            });\r\n            generateTree(\r\n              this.vueName,\r\n              this.rowNum,\r\n              this.enableTable,\r\n              this.data\r\n            ).then((res) => {\r\n              this.loading = false;\r\n              if (res.success) {\r\n                this.result = res.result;\r\n                this.changeCode();\r\n                this.codeModal = true;\r\n                this.save();\r\n              }\r\n            });\r\n          },\r\n        });\r\n      } else {\r\n        generateTree(\r\n          this.vueName,\r\n          this.rowNum,\r\n          this.enableTable,\r\n          this.data\r\n        ).then((res) => {\r\n          this.loading = false;\r\n          if (res.success) {\r\n            this.result = res.result;\r\n            this.changeCode();\r\n            this.codeModal = true;\r\n            this.save();\r\n          }\r\n        });\r\n      }\r\n    },\r\n    changeRadio() {\r\n      this.tabName = \"index.vue\";\r\n      this.changeCode();\r\n    },\r\n    changeCode() {\r\n      if (this.resultType == \"drawerApi\") {\r\n        if (this.tabName == \"index.vue\") {\r\n          this.code = this.result.drawerApi;\r\n        }\r\n        if (this.tabName == \"api.js\") {\r\n          this.code = this.result.api;\r\n        }\r\n      }\r\n      if (this.resultType == \"drawer\") {\r\n        this.code = this.result.drawer;\r\n      }\r\n      if (this.resultType == \"resultApi\") {\r\n        if (this.tabName == \"index.vue\") {\r\n          this.code = this.result.resultApi;\r\n        }\r\n        if (this.tabName == \"api.js\") {\r\n          this.code = this.result.api;\r\n        }\r\n      }\r\n      if (this.resultType == \"result\") {\r\n        this.code = this.result.result;\r\n      }\r\n    },\r\n    save() {\r\n      this.setStore(\"treeData\", JSON.stringify(this.data));\r\n      this.setStore(\"treeVueName\", this.vueName);\r\n      this.setStore(\"treeRowNum\", this.rowNum);\r\n      this.setStore(\"enableTable\", this.enableTable);\r\n    },\r\n  },\r\n  created() {\r\n    this.init();\r\n    this.fullHeight = Number(document.body.clientHeight - 218);\r\n    this.fullEntityHeight = Number(document.body.clientHeight - 288);\r\n  },\r\n};\r\n</script>"]}]}