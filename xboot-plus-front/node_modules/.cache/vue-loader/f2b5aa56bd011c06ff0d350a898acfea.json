{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\menu-manage\\add.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\sys\\menu-manage\\add.vue","mtime":1651629755220},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1651770028580},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1651770027142},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\postcss-loader\\src\\index.js","mtime":1651770027415},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":1651770042155},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQpAaW1wb3J0ICJAL3N0eWxlcy9kcmF3ZXItY29tbW9uLmxlc3MiOw0KQGltcG9ydCAiLi9tZW51TWFuYWdlLmxlc3MiOw0KLmZvb3Rlci1iZXR3ZWVuIHsNCiAgZGlzcGxheTogZmxleDsNCiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAuZmxleC1jZW50ZXIgew0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgfQ0KfQ0K"},{"version":3,"sources":["add.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAieA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"add.vue","sourceRoot":"src/views/sys/menu-manage","sourcesContent":["<template>\r\n  <div class=\"menu-add\">\r\n    <!-- Drawer抽屉 -->\r\n    <Drawer\r\n      :title=\"isRoot ? '添加顶部菜单' : '添加子节点'\"\r\n      v-model=\"visible\"\r\n      width=\"500\"\r\n      draggable\r\n      :mask=\"showMask\"\r\n      :mask-closable=\"false\"\r\n    >\r\n      <div :style=\"{ maxHeight: maxHeight }\" class=\"drawer-content\">\r\n        <Form label-colon>\r\n          <FormItem label=\"上级节点\" v-show=\"!isRoot\">{{\r\n            parentTitle\r\n          }}</FormItem>\r\n          <FormItem label=\"类型\" prop=\"type\">\r\n            <div v-show=\"formAdd.type == -1\">\r\n              <Icon\r\n                type=\"ios-navigate-outline\"\r\n                size=\"16\"\r\n                style=\"margin-right: 5px\"\r\n              ></Icon>\r\n              <span>顶部菜单</span>\r\n            </div>\r\n            <div v-show=\"formAdd.type == 0\">\r\n              <Icon\r\n                type=\"ios-list-box-outline\"\r\n                size=\"16\"\r\n                style=\"margin-right: 5px\"\r\n              ></Icon>\r\n              <span>页面菜单</span>\r\n            </div>\r\n            <div v-show=\"formAdd.type == 1\">\r\n              <Icon\r\n                type=\"md-radio-button-on\"\r\n                size=\"16\"\r\n                style=\"margin-right: 5px\"\r\n              ></Icon>\r\n              <span>操作按钮</span>\r\n            </div>\r\n          </FormItem>\r\n        </Form>\r\n        <Form\r\n          ref=\"formAdd\"\r\n          :model=\"formAdd\"\r\n          label-position=\"top\"\r\n        >\r\n          <FormItem\r\n            label=\"名称\"\r\n            prop=\"title\"\r\n            v-if=\"formAdd.type == -1 || formAdd.type == 0\"\r\n          >\r\n            <div style=\"display: flex\">\r\n              <div style=\"width: 100%\">\r\n                <Input v-model=\"formAdd.title\">\r\n                  <Poptip\r\n                    transfer\r\n                    trigger=\"hover\"\r\n                    title=\"多语言\"\r\n                    placement=\"right\"\r\n                    width=\"350\"\r\n                    style=\"width: 17px; cursor: pointer\"\r\n                    slot=\"append\"\r\n                  >\r\n                    <Button icon=\"ios-globe-outline\"></Button>\r\n                    <div slot=\"content\">\r\n                      <Form :label-width=\"80\">\r\n                        <FormItem label=\"启用多语言\">\r\n                          <i-switch v-model=\"formAdd.localize\" size=\"large\">\r\n                            <span slot=\"open\">开</span>\r\n                            <span slot=\"close\">关</span>\r\n                          </i-switch>\r\n                        </FormItem>\r\n                        <FormItem label=\"多语言Key\">\r\n                          <Input\r\n                            v-model=\"formAdd.i18n\"\r\n                            placeholder=\"输入用于渲染I18n的$t('KEY')\"\r\n                          ></Input>\r\n                        </FormItem>\r\n                      </Form>\r\n                    </div>\r\n                  </Poptip>\r\n                </Input>\r\n              </div>\r\n            </div>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"名称\"\r\n            prop=\"title\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '名称不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n            v-if=\"formAdd.type == 1\"\r\n            class=\"block-tool\"\r\n          >\r\n            <Tooltip placement=\"right\" content=\"操作按钮名称不得重复\">\r\n              <Input v-model=\"formAdd.title\" />\r\n            </Tooltip>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"路径\"\r\n            prop=\"path\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '路径不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n            v-if=\"formAdd.type == 0\"\r\n          >\r\n            <Input v-model=\"formAdd.path\" />\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"请求路径\"\r\n            prop=\"path\"\r\n            :required=\"false\"\r\n            v-if=\"formAdd.type == 1\"\r\n            class=\"block-tool\"\r\n          >\r\n            <Tooltip\r\n              placement=\"right\"\r\n              :max-width=\"230\"\r\n              transfer\r\n              content=\"填写后端请求URL，后端将作权限拦截，若无可填写'无'或其他\"\r\n            >\r\n              <Input v-model=\"formAdd.path\" />\r\n            </Tooltip>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"按钮权限类型\"\r\n            prop=\"buttonType\"\r\n            v-if=\"formAdd.type == 1\"\r\n          >\r\n            <dict\r\n              dict=\"permission_type\"\r\n              v-model=\"formAdd.buttonType\"\r\n              placeholder=\"请选择或输入搜索\"\r\n              filterable\r\n              clearable\r\n              transfer\r\n            />\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"英文名\"\r\n            prop=\"name\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '英文名不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n            v-if=\"formAdd.type == -1\"\r\n            class=\"block-tool\"\r\n          >\r\n            <Tooltip placement=\"right\" content=\"需唯一\">\r\n              <Input v-model=\"formAdd.name\" />\r\n            </Tooltip>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"路由英文名\"\r\n            prop=\"name\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '路由英文名不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n            v-if=\"formAdd.type == 0\"\r\n            class=\"block-tool\"\r\n          >\r\n            <Tooltip placement=\"right\" content=\"需唯一\">\r\n              <Input v-model=\"formAdd.name\" />\r\n            </Tooltip>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"图标\"\r\n            prop=\"icon\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '图标不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n            v-if=\"formAdd.type == -1 || formAdd.type == 0\"\r\n          >\r\n            <icon-choose\r\n              showCustom\r\n              showInput\r\n              v-model=\"formAdd.icon\"\r\n            ></icon-choose>\r\n          </FormItem>\r\n          <FormItem label=\"显示红点\" prop=\"component\" v-if=\"formAdd.type == -1\">\r\n            <i-switch\r\n              size=\"large\"\r\n              v-model=\"formAdd.component\"\r\n              :true-value=\"'hot'\"\r\n              :false-value=\"'normal'\"\r\n            >\r\n              <span slot=\"open\">开</span>\r\n              <span slot=\"close\">关</span>\r\n            </i-switch>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"系统站内菜单\"\r\n            prop=\"isMenu\"\r\n            v-if=\"formAdd.type == -1\"\r\n          >\r\n            <i-switch size=\"large\" v-model=\"formAdd.isMenu\">\r\n              <span slot=\"open\">是</span>\r\n              <span slot=\"close\">否</span>\r\n            </i-switch>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"其他链接\"\r\n            prop=\"url\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '其他链接不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n            v-if=\"formAdd.type == -1 && !formAdd.isMenu\"\r\n          >\r\n            <Input v-model=\"formAdd.url\" placeholder=\"Http链接或路由名\" />\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"打开方式\"\r\n            prop=\"description\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '请选择打开方式',\r\n              trigger: 'change',\r\n            }\"\r\n            v-if=\"formAdd.type == -1 && !formAdd.isMenu\"\r\n          >\r\n            <Select v-model=\"formAdd.description\" transfer placeholder=\"请选择\">\r\n              <Option value=\"direct\" label=\"直接跳转\">\r\n                <span style=\"margin-right: 10px\">直接跳转</span>\r\n                <span style=\"color: #ccc\">其他链接填写完整链接</span>\r\n              </Option>\r\n              <Option value=\"window\" label=\"新窗口打开\">\r\n                <span style=\"margin-right: 10px\">新窗口打开</span>\r\n                <span style=\"color: #ccc\">其他链接填写完整链接</span>\r\n              </Option>\r\n              <Option value=\"route\" label=\"站内路由\">\r\n                <span style=\"margin-right: 10px\">站内路由</span>\r\n                <span style=\"color: #ccc\">其他链接填写Vue路由名</span>\r\n              </Option>\r\n            </Select>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"前端组件\"\r\n            prop=\"component\"\r\n            v-if=\"formAdd.type == 0\"\r\n            :rules=\"{\r\n              required: true,\r\n              message: '前端组件不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n          >\r\n            <Input v-model=\"formAdd.component\" />\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"第三方链接\"\r\n            prop=\"url\"\r\n            v-if=\"formAdd.type == 0 && formAdd.level == 2\"\r\n            :required=\"false\"\r\n          >\r\n            <Input\r\n              v-model=\"formAdd.url\"\r\n              placeholder=\"http://\"\r\n              @on-change=\"changeAddUrl\"\r\n            />\r\n            <span class=\"url-remark\"\r\n              >前端组件需为 sys/monitor/monitor 时生效</span\r\n            >\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"排序值\"\r\n            prop=\"sortOrder\"\r\n            :rules=\"{\r\n              required: true,\r\n              type: 'number',\r\n              message: '前端组件不能为空',\r\n              trigger: 'blur',\r\n            }\"\r\n          >\r\n            <Tooltip\r\n              trigger=\"hover\"\r\n              placement=\"right\"\r\n              content=\"值越小越靠前，支持小数\"\r\n            >\r\n              <InputNumber\r\n                :max=\"1000\"\r\n                :min=\"0\"\r\n                v-model=\"formAdd.sortOrder\"\r\n              ></InputNumber>\r\n            </Tooltip>\r\n          </FormItem>\r\n          <FormItem\r\n            label=\"始终显示\"\r\n            prop=\"showAlways\"\r\n            v-if=\"formAdd.level == 1\"\r\n            class=\"block-tool\"\r\n          >\r\n            <i-switch size=\"large\" v-model=\"formAdd.showAlways\">\r\n              <span slot=\"open\">是</span>\r\n              <span slot=\"close\">否</span>\r\n            </i-switch>\r\n            <Tooltip\r\n              content=\"当设为不始终显示时，一级菜单下仅有一个子级菜单只会显示该子级菜单，避免用户多次点击\"\r\n              placement=\"right\"\r\n              transfer\r\n              max-width=\"280\"\r\n              style=\"display: inline-block !important\"\r\n            >\r\n              <Icon\r\n                type=\"md-help-circle\"\r\n                size=\"20\"\r\n                color=\"#c5c5c5\"\r\n                style=\"margin-left: 10px; cursor: pointer\"\r\n              />\r\n            </Tooltip>\r\n          </FormItem>\r\n          <FormItem label=\"是否启用\" prop=\"status\">\r\n            <i-switch\r\n              size=\"large\"\r\n              v-model=\"formAdd.status\"\r\n              :true-value=\"0\"\r\n              :false-value=\"-1\"\r\n            >\r\n              <span slot=\"open\">启用</span>\r\n              <span slot=\"close\">禁用</span>\r\n            </i-switch>\r\n          </FormItem>\r\n        </Form>\r\n      </div>\r\n      <div class=\"drawer-footer br\">\r\n        <div class=\"footer-between\">\r\n          <div>\r\n            <Button type=\"primary\" :loading=\"submitLoading\" @click=\"submit\"\r\n              >提交</Button\r\n            >\r\n            <Button @click=\"visible = false\">取消</Button>\r\n          </div>\r\n          <div class=\"flex-center\">\r\n            <!-- 遮罩： -->\r\n            <i-switch size=\"large\" v-model=\"showMask\">\r\n              <span slot=\"open\">遮罩</span>\r\n              <span slot=\"close\">关闭</span>\r\n            </i-switch>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </Drawer>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { addPermission } from \"@/api/index\";\r\nimport dict from \"@/views/my-components/xboot/dict\";\r\nimport IconChoose from \"@/views/my-components/xboot/icon-choose\";\r\nexport default {\r\n  name: \"add\",\r\n  components: {\r\n    dict,\r\n    IconChoose,\r\n  },\r\n  props: {\r\n    value: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    isRoot: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    form: {\r\n      type: Object,\r\n    },\r\n    dataLength: {\r\n      type: Number,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      showMask: true,\r\n      visible: this.value,\r\n      parentTitle: \"\",\r\n      submitLoading: false,\r\n      maxHeight: 510,\r\n      formAdd: {},\r\n    };\r\n  },\r\n  methods: {\r\n    init() {},\r\n    changeAddUrl(e) {\r\n      let v = e.target.value;\r\n      if (v.indexOf(\"http\") > -1) {\r\n        this.formAdd.component = \"sys/monitor/monitor\";\r\n      }\r\n    },\r\n    submit() {\r\n      this.$refs.formAdd.validate((valid) => {\r\n        if (valid) {\r\n          // 添加\r\n          this.submitLoading = true;\r\n          if (this.formAdd.type == 1) {\r\n            this.formAdd.name = \"\";\r\n            this.formAdd.icon = \"\";\r\n            this.formAdd.component = \"\";\r\n          }\r\n          addPermission(this.formAdd).then((res) => {\r\n            this.submitLoading = false;\r\n            if (res.success) {\r\n              this.$Message.success(\"操作成功\");\r\n              this.$emit(\"on-submit\", true);\r\n              this.visible = false;\r\n            }\r\n          });\r\n        }\r\n      });\r\n    },\r\n    setCurrentValue(value) {\r\n      if (value === this.visible) {\r\n        return;\r\n      }\r\n      this.$refs.formAdd.resetFields();\r\n      if (this.isRoot) {\r\n        // 添加顶部菜单\r\n        this.formAdd = {\r\n          type: -1,\r\n          level: 0,\r\n          parentId: 0,\r\n          isMenu: true,\r\n          sortOrder: this.dataLength + 1,\r\n          status: 0,\r\n          component: \"normal\",\r\n        };\r\n      } else {\r\n        this.parentTitle = this.form.title;\r\n        let type = 0;\r\n        if (this.form.level == 2) {\r\n          type = 1;\r\n        }\r\n        if (!this.form.children) {\r\n          this.form.children = [];\r\n        }\r\n        this.formAdd = {\r\n          icon: \"\",\r\n          type: type,\r\n          parentId: this.form.id,\r\n          level: Number(this.form.level) + 1,\r\n          sortOrder: this.form.children.length + 1,\r\n          buttonType: \"\",\r\n          status: 0,\r\n          showAlways: true,\r\n        };\r\n        if (this.form.level == 0) {\r\n          this.formAdd.path = \"/\";\r\n          this.formAdd.component = \"Main\";\r\n        }\r\n      }\r\n      // 显示\r\n      this.visible = value;\r\n    },\r\n  },\r\n  watch: {\r\n    value(val) {\r\n      this.setCurrentValue(val);\r\n    },\r\n    visible(value) {\r\n      this.$emit(\"input\", value);\r\n    },\r\n  },\r\n  mounted() {\r\n    this.init();\r\n    this.maxHeight = Number(document.documentElement.clientHeight - 121) + \"px\";\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n@import \"@/styles/drawer-common.less\";\r\n@import \"./menuManage.less\";\r\n.footer-between {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  .flex-center {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n}\r\n</style>\r\n\r\n"]}]}