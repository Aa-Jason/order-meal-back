{"remainingRequest":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\my-components\\xboot\\material-center.vue?vue&type=style&index=0&id=64686bb4&lang=less&scoped=true&","dependencies":[{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\src\\views\\my-components\\xboot\\material-center.vue","mtime":1651629755195},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\css-loader\\dist\\cjs.js","mtime":1651770028580},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1651770027142},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\postcss-loader\\src\\index.js","mtime":1651770027415},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\less-loader\\dist\\cjs.js","mtime":1651770042155},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651770036753},{"path":"D:\\work\\workspace\\order\\xboot-plus-front\\node_modules\\vue-loader\\lib\\index.js","mtime":1651770027133}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi51cGxvYWQtbmF2IHsNCiAgZGlzcGxheTogZmxleDsNCiAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOw0KICBtYXJnaW4tYm90dG9tOiAyMHB4Ow0KfQ0KLmNvbnRlbnQtd3JhcCB7DQogIGRpc3BsYXk6IGZsZXg7DQoNCiAgLmNhdGVnb3J5IHsNCiAgICB3aWR0aDogMjE2cHg7DQogICAgcGFkZGluZy1yaWdodDogMTZweDsNCiAgICBib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjZGNkZWUwOw0KICB9DQoNCiAgLmNvbnRlbnQgew0KICAgIGhlaWdodDogNDAwcHg7DQogICAgd2lkdGg6IDY0MHB4Ow0KICAgIG1hcmdpbi1sZWZ0OiAxNnB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IHNwYWNlLWJldHdlZW47DQogICAgLmVtcHR5IHsNCiAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOw0KICAgICAgaGVpZ2h0OiA5MCU7DQogICAgICBjb2xvcjogIzk5OTsNCiAgICB9DQogICAgLndyYXAgew0KICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgZGlzcGxheTogZmxleDsNCiAgICAgIGZsZXgtd3JhcDogd3JhcDsNCiAgICAgIC5pdGVtIHsNCiAgICAgICAgd2lkdGg6IDEyMHB4Ow0KICAgICAgICAucHJldmlldyB7DQogICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICAgIGhlaWdodDogMTIwcHg7DQogICAgICAgICAgd2lkdGg6IDEyMHB4Ow0KICAgICAgICAgIC5jb2xsZWN0LWljb24gew0KICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgICAgICAgICAgcmlnaHQ6IDVweDsNCiAgICAgICAgICAgIHRvcDogNXB4Ow0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2ZmZjsNCiAgICAgICAgICAgIHotaW5kZXg6IDE7DQogICAgICAgICAgICBib3JkZXItcmFkaXVzOiA1MCU7DQogICAgICAgICAgICB3aWR0aDogMThweDsNCiAgICAgICAgICAgIGhlaWdodDogMThweDsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogICAgICAgICAgfQ0KICAgICAgICAgIC5pbWcgew0KICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBvYmplY3QtZml0OiBjb3ZlcjsNCiAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcjsNCiAgICAgICAgICAgIGJhY2tncm91bmQ6ICNmM2YzZjM7DQogICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4yczsNCiAgICAgICAgICB9DQogICAgICAgICAgLnZpZGVvIHsNCiAgICAgICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgICAgIHdpZHRoOiAxMDAlOw0KICAgICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOw0KICAgICAgICAgICAgYmFja2dyb3VuZDogI2YzZjNmMzsNCiAgICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzOw0KICAgICAgICAgICAgLmNvdmVyIHsNCiAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgICB3aWR0aDogMTAwJTsNCiAgICAgICAgICAgICAgb2JqZWN0LWZpdDogZmlsbDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIC5wbGF5IHsNCiAgICAgICAgICAgICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgICAgICAgICAgICB0b3A6IDQxcHg7DQogICAgICAgICAgICAgIGxlZnQ6IDQxcHg7DQogICAgICAgICAgICAgIGhlaWdodDogNDBweDsNCiAgICAgICAgICAgICAgd2lkdGg6IDQwcHg7DQogICAgICAgICAgICAgIG9wYWNpdHk6IDAuODsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgLnNlbGVjdCB7DQogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgICAgICByaWdodDogMXB4Ow0KICAgICAgICAgICAgYm90dG9tOiAycHg7DQogICAgICAgICAgICB3aWR0aDogMzBweDsNCiAgICAgICAgICAgIGhlaWdodDogMzBweDsNCiAgICAgICAgICB9DQogICAgICAgICAgLmJvcmRlciB7DQogICAgICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7DQogICAgICAgICAgICB0b3A6IDA7DQogICAgICAgICAgICBsZWZ0OiAwOw0KICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCAjMmQ4Y2YwOw0KICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KICAgICAgICAgIH0NCiAgICAgICAgICAuYm9yZGVyLWhvdmVyIHsNCiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7DQogICAgICAgICAgICB0b3A6IDA7DQogICAgICAgICAgICBsZWZ0OiAwOw0KICAgICAgICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgICAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgICAgICBib3JkZXI6IDJweCBzb2xpZCAjMmQ4Y2YwOw0KICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICAgICAgICAgIHBvaW50ZXItZXZlbnRzOiBub25lOw0KICAgICAgICAgIH0NCiAgICAgICAgICAmOmhvdmVyIHsNCiAgICAgICAgICAgIC5ib3JkZXItaG92ZXIgew0KICAgICAgICAgICAgICBkaXNwbGF5OiBibG9jayAhaW1wb3J0YW50Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIC50aXRsZSB7DQogICAgICAgICAgbWFyZ2luLXRvcDogNXB4Ow0KICAgICAgICAgIHdpZHRoOiAxMjBweDsNCiAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgICAgICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQogICAgICAgICAgY3Vyc29yOiBwb2ludGVyOw0KICAgICAgICB9DQogICAgICAgIC5vcHMgew0KICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgICAgICAgICAuZWRpdCB7DQogICAgICAgICAgICBwYWRkaW5nOiA1cHggMDsNCiAgICAgICAgICAgIGRpc3BsYXk6IGZsZXg7DQogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgLmFjdGl2ZSB7DQogICAgICAgIC5pbWcgew0KICAgICAgICAgIHRyYW5zaXRpb246IGFsbCAwLjJzOw0KICAgICAgICAgIGJvcmRlci1jb2xvcjogIzJkOGNmMDsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0KLmJvdHRvbSB7DQogIGRpc3BsYXk6IGZsZXg7DQogIGFsaWduLWl0ZW1zOiBjZW50ZXI7DQogIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsNCiAgLnNlbGVjdC1jb3VudCB7DQogICAgY29sb3I6ICM5OTk7DQogIH0NCn0NCg=="},{"version":3,"sources":["material-center.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAskBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"material-center.vue","sourceRoot":"src/views/my-components/xboot","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 820 -->\r\n    <Modal :title=\"`我的${mode}`\" v-model=\"modalVisible\" :width=\"904\">\r\n      <div v-show=\"!urlMode\">\r\n        <div class=\"upload-nav\">\r\n          <div style=\"display: flex\">\r\n            <Upload\r\n              :action=\"uploadFileUrl\"\r\n              :headers=\"accessToken\"\r\n              :data=\"uploadData\"\r\n              :on-success=\"handleSuccess\"\r\n              :on-error=\"handleError\"\r\n              :format=\"format\"\r\n              :accept=\"accept\"\r\n              :max-size=\"maxSize * 1024\"\r\n              :on-format-error=\"handleFormatError\"\r\n              :on-exceeded-size=\"handleMaxSize\"\r\n              :before-upload=\"beforeUpload\"\r\n              :show-upload-list=\"false\"\r\n              v-if=\"showUpload\"\r\n            >\r\n              <Button\r\n                :loading=\"loading\"\r\n                :icon=\"icon\"\r\n                :disabled=\"!searchForm.categoryId\"\r\n                >上传{{ mode }}</Button\r\n              >\r\n            </Upload>\r\n            <Button\r\n              @click=\"urlMode = true\"\r\n              icon=\"ios-image-outline\"\r\n              style=\"margin-left: 5px\"\r\n              :disabled=\"!searchForm.categoryId\"\r\n              v-if=\"showInput\"\r\n              >网络{{ mode }}</Button\r\n            >\r\n            <Input\r\n              v-model=\"searchForm.title\"\r\n              suffix=\"ios-search\"\r\n              @on-change=\"getDataList\"\r\n              placeholder=\"输入文件名搜索\"\r\n              clearable\r\n              style=\"width: 230px; margin-left: 5px\"\r\n            />\r\n          </div>\r\n          <Button @click=\"getDataList\" icon=\"md-refresh\">刷新</Button>\r\n        </div>\r\n        <div class=\"content-wrap\">\r\n          <!-- 分类 -->\r\n          <div class=\"category\">\r\n            <fileCategory @on-select=\"selectCategory\" showOnly />\r\n          </div>\r\n          <!-- 内容 -->\r\n          <div class=\"content\">\r\n            <div v-show=\"total == 0\" class=\"empty\">\r\n              暂无数据，点击左上角上传按钮添加\r\n            </div>\r\n            <div v-show=\"total > 0\" class=\"wrap\">\r\n              <div\r\n                :class=\"{ item: !item.selected, 'item active': item.selected }\"\r\n                v-for=\"(item, index) in data\"\r\n                :key=\"index\"\r\n                :style=\"{\r\n                  marginRight: (index + 1) % 5 == 0 ? '0px' : '10px',\r\n                  marginBottom: index < 5 ? '20px' : '0px',\r\n                }\"\r\n              >\r\n                <div class=\"preview\" @click=\"changeSelect(item)\">\r\n                  <div class=\"collect-icon\" v-if=\"item.isCollect\">\r\n                    <Icon type=\"md-star\" color=\"#ffc60a\" size=\"16\" />\r\n                  </div>\r\n                  <img :src=\"item.url\" class=\"img\" v-if=\"mode == '图片'\" />\r\n                  <div v-else class=\"video\">\r\n                    <video class=\"cover\">\r\n                      <source :src=\"item.url + '#t=1'\" preload=\"metadata\" />\r\n                    </video>\r\n                    <img class=\"play\" src=\"@/assets/icon/play.png\" />\r\n                  </div>\r\n                  <div class=\"border\" v-show=\"item.selected\"></div>\r\n                  <div class=\"border-hover\"></div>\r\n                  <img\r\n                    src=\"@/assets/icon/select.png\"\r\n                    class=\"select\"\r\n                    v-show=\"item.selected\"\r\n                  />\r\n                </div>\r\n                <Tooltip\r\n                  :content=\"`${item.title} ${util.getFileSize(item.size)}`\"\r\n                  placement=\"top\"\r\n                  :max-width=\"500\"\r\n                >\r\n                  <div class=\"title\">{{ item.title }}</div>\r\n                </Tooltip>\r\n                <div class=\"ops\" v-if=\"showMenus\">\r\n                  <a @click=\"preview(item)\">预览</a>\r\n                  <Divider type=\"vertical\" />\r\n                  <a\r\n                    v-clipboard:copy=\"item.url\"\r\n                    v-clipboard:success=\"onCopy\"\r\n                    v-clipboard:error=\"onError\"\r\n                    v-if=\"readonly\"\r\n                  >\r\n                    复制链接\r\n                  </a>\r\n                  <Poptip width=\"350\" v-if=\"!readonly\"\r\n                    ><a>编辑</a>\r\n                    <div class=\"edit\" slot=\"content\">\r\n                      文件名：\r\n                      <Input\r\n                        v-model=\"item.newName\"\r\n                        style=\"width: 280px\"\r\n                        search\r\n                        enter-button=\"提交\"\r\n                        @on-search=\"editName(item)\"\r\n                      ></Input></div\r\n                  ></Poptip>\r\n                  <Divider type=\"vertical\" v-if=\"!readonly\" />\r\n                  <Dropdown v-if=\"!readonly\">\r\n                    <a>更多</a>\r\n                    <DropdownMenu slot=\"list\" class=\"block-pop\">\r\n                      <div\r\n                        class=\"ivu-dropdown-item\"\r\n                        v-clipboard:copy=\"item.url\"\r\n                        v-clipboard:success=\"onCopy\"\r\n                        v-clipboard:error=\"onError\"\r\n                      >\r\n                        复制链接\r\n                      </div>\r\n                      <div class=\"ivu-dropdown-item\" @click=\"collect(item)\">\r\n                        {{ item.isCollect ? \"取消收藏\" : \"收藏\" }}\r\n                      </div>\r\n                      <Poptip\r\n                        confirm\r\n                        title=\"确认将此素材移动至回收站？\"\r\n                        @on-ok=\"del(item)\"\r\n                        ><div class=\"ivu-dropdown-item\">删除</div></Poptip\r\n                      >\r\n                    </DropdownMenu>\r\n                  </Dropdown>\r\n                </div>\r\n              </div>\r\n              <Spin v-show=\"dataLoading\" fix></Spin>\r\n            </div>\r\n            <div class=\"bottom\">\r\n              <div class=\"select-count\">\r\n                {{\r\n                  selectList.length > 0 ? `已选 ${selectList.length} 项` : \"\"\r\n                }}\r\n              </div>\r\n              <Page\r\n                :current=\"searchForm.pageNumber\"\r\n                :total=\"total\"\r\n                :page-size=\"searchForm.pageSize\"\r\n                @on-change=\"changePage\"\r\n                size=\"small\"\r\n                show-total\r\n                show-elevator\r\n              ></Page>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div v-show=\"urlMode\">\r\n        <div class=\"upload-nav\">\r\n          <Button @click=\"urlMode = false\" icon=\"ios-arrow-back\">返回</Button>\r\n        </div>\r\n        <div style=\"width: 100%; display: flex\">\r\n          <Form\r\n            ref=\"form\"\r\n            :model=\"form\"\r\n            label-position=\"left\"\r\n            :label-width=\"100\"\r\n            :rules=\"ruleValidate\"\r\n            style=\"margin-right: 10px\"\r\n          >\r\n            <FormItem :label=\"`${mode}链接`\" prop=\"url\">\r\n              <Input\r\n                v-model=\"form.url\"\r\n                type=\"textarea\"\r\n                :rows=\"5\"\r\n                :maxlength=\"maxlength\"\r\n                show-word-limit\r\n                :placeholder=\"`请输入${mode}链接...`\"\r\n                :style=\"`width: ${mode == '图片' ? '600px' : '720px'}`\"\r\n              />\r\n            </FormItem>\r\n          </Form>\r\n          <div v-if=\"mode == '图片'\">\r\n            <Avatar\r\n              v-if=\"!form.url\"\r\n              shape=\"square\"\r\n              icon=\"md-images\"\r\n              size=\"110\"\r\n            />\r\n            <Avatar v-else shape=\"square\" :src=\"form.url\" size=\"110\" />\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div slot=\"footer\">\r\n        <Button type=\"text\" @click=\"modalVisible = false\">取消</Button>\r\n        <Button\r\n          :disabled=\"\r\n            (selectList.length == 0 && !urlMode) || (!form.url && urlMode)\r\n          \"\r\n          type=\"primary\"\r\n          @click=\"handelSubmit\"\r\n          >确定</Button\r\n        >\r\n      </div>\r\n    </Modal>\r\n    <Modal\r\n      v-model=\"videoVisible\"\r\n      :title=\"videoTitle\"\r\n      :width=\"800\"\r\n      @on-cancel=\"closeVideo\"\r\n      draggable\r\n      footer-hide\r\n      v-if=\"mode == '视频'\"\r\n    >\r\n      <div :id=\"videoId\" style=\"height: 500px\"></div>\r\n    </Modal>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport \"viewerjs/dist/viewer.css\";\r\nimport Viewer from \"viewerjs\";\r\nimport DPlayer from \"dplayer\";\r\nimport util from \"@/libs/util\";\r\nimport {\r\n  uploadFile,\r\n  getUserFileListData,\r\n  renameUserFile,\r\n  trashFile,\r\n  collectFile,\r\n} from \"@/api/index\";\r\nimport fileCategory from \"@/views/app-toB/file/fileCategory\";\r\nexport default {\r\n  name: \"materialCenter\",\r\n  components: {\r\n    fileCategory,\r\n  },\r\n  props: {\r\n    value: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    mode: {\r\n      validator(value) {\r\n        return util.oneOf(value, [\"图片\", \"视频\"]);\r\n      },\r\n      type: String,\r\n      default: \"图片\",\r\n    },\r\n    multiple: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    readonly: {\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    showMenus: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    showUpload: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    showInput: {\r\n      type: Boolean,\r\n      default: true,\r\n    },\r\n    maxlength: { type: Number, default: 250 },\r\n    icon: {\r\n      type: String,\r\n      default: \"ios-cloud-upload-outline\",\r\n    },\r\n    maxSize: {\r\n      type: Number,\r\n      default: 5,\r\n    },\r\n    acceptImg: {\r\n      type: String,\r\n      default: \".jpg, .jpeg, .png, .gif\",\r\n    },\r\n    acceptVideo: {\r\n      type: String,\r\n      default: \".mp4, .wmv, .avi, .mov, .flv, .mkv\",\r\n    },\r\n  },\r\n  computed: {\r\n    format() {\r\n      if (this.accept) {\r\n        let format = [];\r\n        this.accept.split(\",\").forEach((e) => {\r\n          format.push(e.replace(\".\", \"\").replace(\" \", \"\"));\r\n        });\r\n        return format;\r\n      } else {\r\n        return [];\r\n      }\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      uploadData: {},\r\n      accessToken: {},\r\n      accept: \"\",\r\n      urlMode: false,\r\n      modalVisible: this.value,\r\n      loading: false,\r\n      dataLoading: false,\r\n      uploadFileUrl: uploadFile,\r\n      searchForm: {\r\n        title: \"\",\r\n        type: \"image\",\r\n        pageNumber: 1,\r\n        pageSize: 10,\r\n        categoryId: \"0\",\r\n        isCollect: null,\r\n      },\r\n      total: 0,\r\n      data: [],\r\n      selectList: [],\r\n      form: {\r\n        url: \"\",\r\n      },\r\n      ruleValidate: {\r\n        url: [\r\n          {\r\n            required: true,\r\n            message: \"请输入合法的URL链接\",\r\n            type: \"url\",\r\n          },\r\n        ],\r\n      },\r\n      dp: null,\r\n      videoVisible: false,\r\n      videoTitle: \"\",\r\n      videoId: \"dplayer\",\r\n    };\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.accessToken = {\r\n        accessToken: this.getStore(\"accessToken\"),\r\n      };\r\n      this.changeAccept();\r\n      this.getDataList();\r\n    },\r\n    selectCategory(v) {\r\n      if (v.id == \"-1\") {\r\n        // 收藏夹\r\n        this.searchForm.categoryId = \"\";\r\n        this.searchForm.isCollect = true;\r\n        this.getDataList();\r\n      } else {\r\n        this.searchForm.isCollect = null;\r\n        this.searchForm.categoryId = v.id;\r\n        this.uploadData = {\r\n          categoryId: v.id,\r\n        };\r\n        this.currCate = v.title;\r\n        this.getDataList();\r\n      }\r\n    },\r\n    changeAccept() {\r\n      if (this.mode == \"图片\") {\r\n        this.accept = this.acceptImg;\r\n      } else if (this.mode == \"视频\") {\r\n        this.accept = this.acceptVideo;\r\n      }\r\n    },\r\n    changePage(v) {\r\n      this.searchForm.pageNumber = v;\r\n      this.getDataList();\r\n    },\r\n    getDataList() {\r\n      this.dataLoading = true;\r\n      if (this.mode == \"视频\") {\r\n        this.searchForm.type = \"video\";\r\n      }\r\n      getUserFileListData(this.searchForm).then((res) => {\r\n        this.dataLoading = false;\r\n        if (res.success) {\r\n          this.data = res.result.content;\r\n          this.data.forEach((e) => {\r\n            e.newName = e.title;\r\n            e.selected = false;\r\n            e.border = false;\r\n          });\r\n          this.total = res.result.totalElements;\r\n          if (this.data.length == 0 && this.searchForm.pageNumber > 1) {\r\n            this.searchForm.pageNumber -= 1;\r\n            this.getDataList();\r\n          }\r\n        }\r\n      });\r\n    },\r\n    clearSelectAll() {\r\n      this.selectList = [];\r\n    },\r\n    changeSelect(v) {\r\n      v.selected = !v.selected;\r\n      if (this.multiple) {\r\n        if (v.selected) {\r\n          this.selectList.push(v);\r\n        } else {\r\n          this.selectList = this.selectList.filter((e) => {\r\n            return e.id != v.id;\r\n          });\r\n        }\r\n      } else {\r\n        if (v.selected) {\r\n          if (this.selectList.length > 0) {\r\n            this.selectList[0].selected = false;\r\n            this.selectList = [];\r\n          }\r\n          this.selectList.push(v);\r\n        } else {\r\n          this.selectList = [];\r\n        }\r\n      }\r\n    },\r\n    handelSubmit() {\r\n      let url = [];\r\n      if (!this.urlMode) {\r\n        this.selectList.forEach((e) => {\r\n          url.push(e.url);\r\n        });\r\n        if (this.multiple) {\r\n          this.$emit(\"on-change\", url);\r\n        } else {\r\n          this.$emit(\"on-change\", url[0]);\r\n        }\r\n        this.modalVisible = false;\r\n      } else {\r\n        this.$refs.form.validate((valid) => {\r\n          if (valid) {\r\n            url.push(this.form.url);\r\n            if (this.multiple) {\r\n              this.$emit(\"on-change\", url);\r\n            } else {\r\n              this.$emit(\"on-change\", url[0]);\r\n            }\r\n            this.modalVisible = false;\r\n          }\r\n        });\r\n      }\r\n    },\r\n    preview(v) {\r\n      if (this.mode == \"图片\") {\r\n        this.viewImage(v);\r\n      } else {\r\n        this.showVideo(v);\r\n      }\r\n    },\r\n    viewImage(v) {\r\n      let image = new Image();\r\n      image.src = v.url;\r\n      let viewer = new Viewer(image, {\r\n        hidden: function () {\r\n          viewer.destroy();\r\n        },\r\n      });\r\n      viewer.show();\r\n    },\r\n    showVideo(v) {\r\n      this.dp = new DPlayer({\r\n        container: document.getElementById(this.videoId),\r\n        screenshot: true,\r\n        video: {\r\n          url: v.url,\r\n        },\r\n      });\r\n      this.videoTitle = v.title;\r\n      this.videoVisible = true;\r\n    },\r\n    closeVideo() {\r\n      if (this.dp) {\r\n        this.dp.destroy();\r\n      }\r\n    },\r\n    collect(v) {\r\n      collectFile({ id: v.id }).then((res) => {\r\n        this.$Modal.remove();\r\n        if (res.success) {\r\n          this.$Message.success(v.isCollect ? \"取消收藏成功\" : \"收藏成功\");\r\n          this.getDataList();\r\n        }\r\n      });\r\n    },\r\n    onCopy() {\r\n      this.$Message.success(\"复制链接成功\");\r\n    },\r\n    onError() {\r\n      this.$Message.warning(\"复制链接失败，请手动复制\");\r\n    },\r\n    editName(v) {\r\n      renameUserFile(v).then((res) => {\r\n        if (res.success) {\r\n          this.$Message.success(\"操作成功\");\r\n          this.getDataList();\r\n        }\r\n      });\r\n    },\r\n    del(v) {\r\n      trashFile({ ids: v.id }).then((res) => {\r\n        if (res.success) {\r\n          this.$Message.success(\"删除成功\");\r\n          this.getDataList();\r\n        }\r\n      });\r\n    },\r\n    handleFormatError(file) {\r\n      this.loading = false;\r\n      this.$Notice.warning({\r\n        title: \"不支持的文件格式\",\r\n        desc:\r\n          \"所选文件‘ \" +\r\n          file.name +\r\n          \" ’格式不正确, 请选择 \" +\r\n          this.accept +\r\n          \" 格式文件\",\r\n      });\r\n    },\r\n    handleMaxSize(file) {\r\n      this.loading = false;\r\n      this.$Notice.warning({\r\n        title: \"文件大小过大\",\r\n        desc:\r\n          \"所选文件‘ \" +\r\n          file.name +\r\n          \" ’大小过大, 不得超过 \" +\r\n          this.maxSize +\r\n          \"M.\",\r\n      });\r\n    },\r\n    beforeUpload() {\r\n      this.loading = true;\r\n      return true;\r\n    },\r\n    handleSuccess(res, file) {\r\n      this.loading = false;\r\n      if (res.success) {\r\n        this.$Message.success(\"上传成功\");\r\n        this.getDataList();\r\n      } else {\r\n        this.$Message.error(res.message);\r\n      }\r\n    },\r\n    handleError(error, file, fileList) {\r\n      this.loading = false;\r\n      this.$Message.error(error.toString());\r\n    },\r\n    setCurrentValue(value) {\r\n      if (value === this.modalVisible) {\r\n        return;\r\n      }\r\n      this.modalVisible = value;\r\n    },\r\n  },\r\n  watch: {\r\n    mode(val) {\r\n      this.changeAccept();\r\n    },\r\n    value(val) {\r\n      this.setCurrentValue(val);\r\n    },\r\n    modalVisible(value) {\r\n      this.$emit(\"input\", value);\r\n    },\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.upload-nav {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 20px;\r\n}\r\n.content-wrap {\r\n  display: flex;\r\n\r\n  .category {\r\n    width: 216px;\r\n    padding-right: 16px;\r\n    border-right: 1px solid #dcdee0;\r\n  }\r\n\r\n  .content {\r\n    height: 400px;\r\n    width: 640px;\r\n    margin-left: 16px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-between;\r\n    .empty {\r\n      display: flex;\r\n      flex-direction: column;\r\n      align-items: center;\r\n      justify-content: center;\r\n      height: 90%;\r\n      color: #999;\r\n    }\r\n    .wrap {\r\n      position: relative;\r\n      display: flex;\r\n      flex-wrap: wrap;\r\n      .item {\r\n        width: 120px;\r\n        .preview {\r\n          position: relative;\r\n          height: 120px;\r\n          width: 120px;\r\n          .collect-icon {\r\n            position: absolute;\r\n            right: 5px;\r\n            top: 5px;\r\n            background: #fff;\r\n            z-index: 1;\r\n            border-radius: 50%;\r\n            width: 18px;\r\n            height: 18px;\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n          }\r\n          .img {\r\n            height: 100%;\r\n            width: 100%;\r\n            object-fit: cover;\r\n            cursor: pointer;\r\n            background: #f3f3f3;\r\n            transition: all 0.2s;\r\n          }\r\n          .video {\r\n            height: 100%;\r\n            width: 100%;\r\n            cursor: pointer;\r\n            position: relative;\r\n            background: #f3f3f3;\r\n            transition: all 0.2s;\r\n            .cover {\r\n              height: 100%;\r\n              width: 100%;\r\n              object-fit: fill;\r\n            }\r\n            .play {\r\n              position: absolute;\r\n              top: 41px;\r\n              left: 41px;\r\n              height: 40px;\r\n              width: 40px;\r\n              opacity: 0.8;\r\n            }\r\n          }\r\n          .select {\r\n            position: absolute;\r\n            right: 1px;\r\n            bottom: 2px;\r\n            width: 30px;\r\n            height: 30px;\r\n          }\r\n          .border {\r\n            position: absolute;\r\n            top: 0;\r\n            left: 0;\r\n            height: 100%;\r\n            width: 100%;\r\n            border: 2px solid #2d8cf0;\r\n            overflow: hidden;\r\n            pointer-events: none;\r\n          }\r\n          .border-hover {\r\n            position: absolute;\r\n            display: none;\r\n            top: 0;\r\n            left: 0;\r\n            height: 100%;\r\n            width: 100%;\r\n            border: 2px solid #2d8cf0;\r\n            overflow: hidden;\r\n            pointer-events: none;\r\n          }\r\n          &:hover {\r\n            .border-hover {\r\n              display: block !important;\r\n            }\r\n          }\r\n        }\r\n\r\n        .title {\r\n          margin-top: 5px;\r\n          width: 120px;\r\n          overflow: hidden;\r\n          text-overflow: ellipsis;\r\n          white-space: nowrap;\r\n          cursor: pointer;\r\n        }\r\n        .ops {\r\n          display: flex;\r\n          align-items: center;\r\n          .edit {\r\n            padding: 5px 0;\r\n            display: flex;\r\n            align-items: center;\r\n          }\r\n        }\r\n      }\r\n      .active {\r\n        .img {\r\n          transition: all 0.2s;\r\n          border-color: #2d8cf0;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n.bottom {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  .select-count {\r\n    color: #999;\r\n  }\r\n}\r\n</style>\r\n\r\n"]}]}